2025-02-18 20:47:35,842 p=1291225 u=digitd n=ansible WARNING| [WARNING]:  * Failed to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini with ini plugin: /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini:2: Expected key=value host variable assignment, got: db.test.lan

2025-02-18 20:47:35,843 p=1291225 u=digitd n=ansible WARNING| [WARNING]: Unable to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini as an inventory source

2025-02-18 20:47:35,869 p=1291225 u=digitd n=ansible WARNING| [WARNING]: No inventory was parsed, only implicit localhost is available

2025-02-18 20:47:35,896 p=1291225 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {}
    },
    "all": {
        "children": [
            "ungrouped"
        ]
    }
}
2025-02-18 20:49:09,247 p=1294121 u=digitd n=ansible WARNING| [WARNING]:  * Failed to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini with ini plugin: /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini:2: Expected key=value host variable assignment, got: db.test.lan

2025-02-18 20:49:09,247 p=1294121 u=digitd n=ansible WARNING| [WARNING]: Unable to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini as an inventory source

2025-02-18 20:49:09,295 p=1294121 u=digitd n=ansible WARNING| [WARNING]: No inventory was parsed, only implicit localhost is available

2025-02-18 20:49:09,322 p=1294121 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {}
    },
    "all": {
        "children": [
            "ungrouped"
        ]
    }
}
2025-02-18 20:49:43,982 p=1295186 u=digitd n=ansible WARNING| [WARNING]:  * Failed to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini with ini plugin: /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini:11: Section [cluser:children] includes undefined group: node_hapr

2025-02-18 20:49:43,982 p=1295186 u=digitd n=ansible WARNING| [WARNING]: Unable to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini as an inventory source

2025-02-18 20:49:44,000 p=1295186 u=digitd n=ansible WARNING| [WARNING]: No inventory was parsed, only implicit localhost is available

2025-02-18 20:49:44,036 p=1295186 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {}
    },
    "all": {
        "children": [
            "ungrouped"
        ]
    }
}
2025-02-18 20:49:56,899 p=1295500 u=digitd n=ansible WARNING| [WARNING]:  * Failed to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini with ini plugin: /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini:15: Section [cluster:vars] not valid for undefined group: cluster

2025-02-18 20:49:56,899 p=1295500 u=digitd n=ansible WARNING| [WARNING]: Unable to parse /run/media/digitd/NFS/git/travelata_test/ansible/cluster.ini as an inventory source

2025-02-18 20:49:56,932 p=1295500 u=digitd n=ansible WARNING| [WARNING]: No inventory was parsed, only implicit localhost is available

2025-02-18 20:49:56,968 p=1295500 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {}
    },
    "all": {
        "children": [
            "ungrouped"
        ]
    }
}
2025-02-18 20:50:10,044 p=1295952 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "master"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "slave"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_use": "node_hapr",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    }
}
2025-02-18 20:50:18,220 p=1296183 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "master"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "slave"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_use": "node_hapr",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    }
}
2025-02-18 20:51:10,992 p=1297723 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "root"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "root"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    }
}
2025-02-18 20:51:12,475 p=1297828 u=digitd n=ansible INFO| {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "root"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "root"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_ssh_private_key": "../ssh-keys/.keys/.my_key",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    }
}
2025-02-18 20:53:18,220 p=1301286 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 20:53:25,431 p=1301549 u=digitd n=ansible INFO| db.master.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.",
    "unreachable": true
}
2025-02-18 20:53:26,424 p=1301549 u=digitd n=ansible INFO| db.slave.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.",
    "unreachable": true
}
2025-02-18 20:53:26,601 p=1301549 u=digitd n=ansible INFO| db.test.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: Host key verification failed.",
    "unreachable": true
}
2025-02-18 20:53:35,468 p=1301760 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 21:04:39,613 p=1321749 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 21:05:30,735 p=1323396 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 21:07:40,323 p=1327320 u=digitd n=ansible INFO| db.slave.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@db.slave.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-18 21:07:40,325 p=1327320 u=digitd n=ansible INFO| db.master.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@db.master.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-18 21:07:48,939 p=1327320 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 21:07:59,609 p=1327934 u=digitd n=ansible INFO| db.master.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@db.master.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-18 21:07:59,630 p=1327934 u=digitd n=ansible INFO| db.slave.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@db.slave.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-18 21:08:01,221 p=1327934 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 21:09:02,340 p=1330123 u=digitd n=ansible INFO| db.slave.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@db.slave.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-18 21:09:02,347 p=1330123 u=digitd n=ansible INFO| db.master.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: root@db.master.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-18 21:09:04,010 p=1330123 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-18 21:09:30,679 p=1330323 u=digitd n=ansible WARNING| [WARNING]: Platform linux on host db.master.lan is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.

2025-02-18 21:09:30,680 p=1330323 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:09:32,164 p=1330323 u=digitd n=ansible WARNING| [WARNING]: Platform linux on host db.slave.lan is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.

2025-02-18 21:09:32,165 p=1330323 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:09:38,892 p=1330323 u=digitd n=ansible WARNING| [WARNING]: Platform linux on host db.test.lan is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.

2025-02-18 21:09:38,892 p=1330323 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:09:42,208 p=1331569 u=digitd n=ansible WARNING| [WARNING]: Platform linux on host db.master.lan is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.

2025-02-18 21:09:42,208 p=1331569 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:09:42,350 p=1331569 u=digitd n=ansible WARNING| [WARNING]: Platform linux on host db.test.lan is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.

2025-02-18 21:09:42,890 p=1331569 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:09:43,192 p=1331569 u=digitd n=ansible WARNING| [WARNING]: Platform linux on host db.slave.lan is using the discovered Python interpreter at /usr/bin/python3.11, but future installation of another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.18/reference_appendices/interpreter_discovery.html for more information.

2025-02-18 21:09:43,345 p=1331569 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:11:07,992 p=1334089 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:11:08,000 p=1334089 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:11:08,467 p=1334089 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:11:13,200 p=1334305 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:11:13,205 p=1334305 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:11:14,493 p=1334305 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-18 21:30:08,574 p=1367489 u=digitd n=ansible ERROR| ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context. mapping values are not allowed in this context
  in "<unicode string>", line 2, column 8

The error appears to be in '/run/media/digitd/NFS/git/travelata_test/ansible/start_services.yml': line 2, column 8, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

name: Install haproxy and run service
  hosts: haproxy
       ^ here

2025-02-18 21:30:52,800 p=1368741 u=digitd n=ansible ERROR| ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context. mapping values are not allowed in this context
  in "<unicode string>", line 2, column 8

The error appears to be in '/run/media/digitd/NFS/git/travelata_test/ansible/start_services.yml': line 2, column 8, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

name: Install haproxy and run service
  hosts: haproxy
       ^ here

2025-02-18 21:31:02,022 p=1369054 u=digitd n=ansible ERROR| ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context. mapping values are not allowed in this context
  in "<unicode string>", line 2, column 8

The error appears to be in '/run/media/digitd/NFS/git/travelata_test/ansible/start_services.yml': line 2, column 8, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

name: Install haproxy and run service
  hosts: haproxy
       ^ here

2025-02-18 21:31:29,467 p=1370010 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] **************************************************************************************************************************************************************************************************************************************
2025-02-18 21:31:29,472 p=1370010 u=digitd n=ansible INFO| TASK [Install HAProxy] ******************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:33:27,809 p=1370010 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-18 21:33:27,810 p=1370010 u=digitd n=ansible INFO| PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:33:27,857 p=1370010 u=digitd n=ansible INFO| db.test.lan                : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 21:40:50,443 p=1387541 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] **************************************************************************************************************************************************************************************************************************************
2025-02-18 21:40:50,447 p=1387541 u=digitd n=ansible INFO| TASK [Install HAProxy] ******************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:40:52,474 p=1387541 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 21:40:52,475 p=1387541 u=digitd n=ansible INFO| TASK [Check service status] *************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:40:54,378 p=1387541 u=digitd n=ansible INFO| fatal: [db.test.lan]: FAILED! => {"changed": false, "msg": "value of state must be one of: reloaded, restarted, started, stopped, got: present"}
2025-02-18 21:40:54,378 p=1387541 u=digitd n=ansible INFO| PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:40:54,412 p=1387541 u=digitd n=ansible INFO| db.test.lan                : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-18 21:43:08,556 p=1392130 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] **************************************************************************************************************************************************************************************************************************************
2025-02-18 21:43:08,560 p=1392130 u=digitd n=ansible INFO| TASK [Install HAProxy] ******************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:43:10,415 p=1392130 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 21:43:10,416 p=1392130 u=digitd n=ansible INFO| TASK [Check service status] *************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:43:11,553 p=1392130 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 21:43:11,554 p=1392130 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] **********************************************************************************************************************************************************************************************************************************
2025-02-18 21:43:11,577 p=1392130 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ***************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:44:52,996 p=1392130 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-18 21:45:04,471 p=1392130 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-18 21:45:04,472 p=1392130 u=digitd n=ansible INFO| TASK [Check service] ********************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:45:05,923 p=1392130 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 21:45:05,972 p=1392130 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 21:45:05,972 p=1392130 u=digitd n=ansible INFO| PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************
2025-02-18 21:45:06,137 p=1392130 u=digitd n=ansible INFO| db.master.lan              : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 21:45:06,424 p=1392130 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 21:45:06,491 p=1392130 u=digitd n=ansible INFO| db.test.lan                : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:06:38,066 p=1539428 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************************************************************************************
2025-02-18 23:06:38,070 p=1539428 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************************************************************************************
2025-02-18 23:06:40,177 p=1539428 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:06:40,178 p=1539428 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************************************************************************************
2025-02-18 23:06:41,391 p=1539428 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:06:41,393 p=1539428 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:06:41,420 p=1539428 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************************************************************************************
2025-02-18 23:06:43,159 p=1539428 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:06:44,464 p=1539428 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:06:44,465 p=1539428 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************************************************************************************
2025-02-18 23:06:45,419 p=1539428 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:06:45,551 p=1539428 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:06:45,553 p=1539428 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on master node] *******************************************************************************************************************************************************************************************************
2025-02-18 23:06:45,586 p=1539428 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:06:46,013 p=1539428 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-18 23:06:46,014 p=1539428 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************************************************************************************
2025-02-18 23:06:46,416 p=1539428 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-18 23:06:46,416 p=1539428 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************************************************************************************
2025-02-18 23:06:46,451 p=1539428 u=digitd n=ansible INFO| db.master.lan              : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:06:46,485 p=1539428 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:06:46,518 p=1539428 u=digitd n=ansible INFO| db.test.lan                : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:07:57,414 p=1541901 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************************************************************************************
2025-02-18 23:07:57,418 p=1541901 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************************************************************************************
2025-02-18 23:07:59,245 p=1541901 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:07:59,246 p=1541901 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:00,441 p=1541901 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:08:00,442 p=1541901 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:08:00,480 p=1541901 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:02,260 p=1541901 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:08:02,323 p=1541901 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:08:02,324 p=1541901 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:03,276 p=1541901 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:08:03,360 p=1541901 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:08:03,362 p=1541901 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on master node] *******************************************************************************************************************************************************************************************************
2025-02-18 23:08:03,421 p=1541901 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:08:03,893 p=1541901 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-18 23:08:03,894 p=1541901 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************************************************************************************
2025-02-18 23:08:04,236 p=1541901 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:08:04,236 p=1541901 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:04,270 p=1541901 u=digitd n=ansible INFO| db.master.lan              : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:08:04,362 p=1541901 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:08:04,420 p=1541901 u=digitd n=ansible INFO| db.test.lan                : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:08:37,983 p=1543266 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************************************************************************************
2025-02-18 23:08:37,987 p=1543266 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:39,518 p=1543266 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:08:39,519 p=1543266 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:40,746 p=1543266 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:08:40,748 p=1543266 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:08:40,793 p=1543266 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:42,144 p=1543266 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:08:42,340 p=1543266 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:08:42,341 p=1543266 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:43,226 p=1543266 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:08:43,378 p=1543266 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:08:43,379 p=1543266 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on master node] *******************************************************************************************************************************************************************************************************
2025-02-18 23:08:43,418 p=1543266 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:08:43,812 p=1543266 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-18 23:08:43,813 p=1543266 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************************************************************************************
2025-02-18 23:08:44,260 p=1543266 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:08:44,260 p=1543266 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************************************************************************************
2025-02-18 23:08:44,383 p=1543266 u=digitd n=ansible INFO| db.master.lan              : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:08:44,517 p=1543266 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:08:44,575 p=1543266 u=digitd n=ansible INFO| db.test.lan                : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:09:09,863 p=1544253 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************************************************************************************
2025-02-18 23:09:09,867 p=1544253 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************************************************************************************
2025-02-18 23:09:11,462 p=1544253 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:09:11,464 p=1544253 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************************************************************************************
2025-02-18 23:09:12,735 p=1544253 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:09:12,736 p=1544253 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:09:12,774 p=1544253 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************************************************************************************
2025-02-18 23:09:14,175 p=1544253 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:09:14,306 p=1544253 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:09:14,307 p=1544253 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************************************************************************************
2025-02-18 23:09:15,333 p=1544253 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:09:15,368 p=1544253 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:09:15,369 p=1544253 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on master node] *******************************************************************************************************************************************************************************************************
2025-02-18 23:09:15,399 p=1544253 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:09:15,829 p=1544253 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:09:15,830 p=1544253 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************************************************************************************
2025-02-18 23:09:16,151 p=1544253 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:09:16,152 p=1544253 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************************************************************************************
2025-02-18 23:09:16,197 p=1544253 u=digitd n=ansible INFO| db.master.lan              : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:09:16,239 p=1544253 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:09:16,272 p=1544253 u=digitd n=ansible INFO| db.test.lan                : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:10:49,787 p=1547492 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************************************************************************************
2025-02-18 23:10:49,791 p=1547492 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************************************************************************************
2025-02-18 23:10:51,740 p=1547492 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:10:51,741 p=1547492 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************************************************************************************
2025-02-18 23:10:52,961 p=1547492 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-18 23:10:52,963 p=1547492 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:10:52,999 p=1547492 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************************************************************************************
2025-02-18 23:10:54,744 p=1547492 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:10:54,850 p=1547492 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:10:54,851 p=1547492 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************************************************************************************
2025-02-18 23:10:55,774 p=1547492 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-18 23:10:55,869 p=1547492 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:10:55,871 p=1547492 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on master node] *******************************************************************************************************************************************************************************************************
2025-02-18 23:10:55,924 p=1547492 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************************************************************************************
2025-02-18 23:10:56,328 p=1547492 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:10:56,329 p=1547492 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************************************************************************************
2025-02-18 23:10:56,707 p=1547492 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-18 23:10:56,708 p=1547492 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ************************************************************************************************************************************************************************************************************
2025-02-18 23:10:58,373 p=1547492 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-18 23:10:58,374 p=1547492 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************************************************************************************
2025-02-18 23:10:58,414 p=1547492 u=digitd n=ansible INFO| db.master.lan              : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:10:58,447 p=1547492 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-18 23:10:58,489 p=1547492 u=digitd n=ansible INFO| db.test.lan                : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 13:50:46,707 p=22905 u=digitd n=ansible | db.test.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\nPermissions 0644 for '../ssh-keys/.keys/my_key' are too open.\r\nIt is required that your private key files are NOT accessible by others.\r\nThis private key will be ignored.\r\nLoad key \"../ssh-keys/.keys/my_key\": bad permissions\r\nroot@db.test.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-19 13:50:46,745 p=22905 u=digitd n=ansible | db.slave.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\nPermissions 0644 for '../ssh-keys/.keys/my_key' are too open.\r\nIt is required that your private key files are NOT accessible by others.\r\nThis private key will be ignored.\r\nLoad key \"../ssh-keys/.keys/my_key\": bad permissions\r\nroot@db.slave.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-19 13:50:46,748 p=22905 u=digitd n=ansible | db.master.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @\r\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\nPermissions 0644 for '../ssh-keys/.keys/my_key' are too open.\r\nIt is required that your private key files are NOT accessible by others.\r\nThis private key will be ignored.\r\nLoad key \"../ssh-keys/.keys/my_key\": bad permissions\r\nroot@db.master.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-19 14:00:58,502 p=24985 u=digitd n=ansible | db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:00:58,516 p=24985 u=digitd n=ansible | db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:00:58,569 p=24985 u=digitd n=ansible | db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:14:47,303 p=28124 u=digitd n=ansible | [WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details

2025-02-19 14:14:47,317 p=28124 u=digitd n=ansible | {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster",
            "database",
            "vip-hap"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "database": {
        "children": [
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "haproxy-vip": {
        "hosts": [
            "db.test1.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    },
    "vip-hap": {
        "children": [
            "haproxy",
            "haproxy-vip"
        ]
    }
}
2025-02-19 14:14:58,431 p=28204 u=digitd n=ansible | ansible-inventory [core 2.14.18]
  config file = /home/digitd/travelata/ansible/ansible.cfg
  configured module search path = ['/home/digitd/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/digitd/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible-inventory
  python version = 3.11.2 (main, Sep 14 2024, 03:00:30) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.2
  libyaml = True
2025-02-19 14:14:58,431 p=28204 u=digitd n=ansible | Using /home/digitd/travelata/ansible/ansible.cfg as config file
2025-02-19 14:14:58,438 p=28204 u=digitd n=ansible | [WARNING]: Invalid characters were found in group names but not replaced, use -vvvv to see details

2025-02-19 14:14:58,454 p=28204 u=digitd n=ansible | {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster",
            "database",
            "vip-hap"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "database": {
        "children": [
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "haproxy-vip": {
        "hosts": [
            "db.test1.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    },
    "vip-hap": {
        "children": [
            "haproxy",
            "haproxy-vip"
        ]
    }
}
2025-02-19 14:15:34,596 p=28350 u=digitd n=ansible | ansible-inventory [core 2.14.18]
  config file = /home/digitd/travelata/ansible/ansible.cfg
  configured module search path = ['/home/digitd/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/digitd/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible-inventory
  python version = 3.11.2 (main, Sep 14 2024, 03:00:30) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.2
  libyaml = True
2025-02-19 14:15:34,596 p=28350 u=digitd n=ansible | Using /home/digitd/travelata/ansible/ansible.cfg as config file
2025-02-19 14:15:34,618 p=28350 u=digitd n=ansible | {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster",
            "database",
            "vip_hap"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "database": {
        "children": [
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "haproxy_vip": {
        "hosts": [
            "db.test1.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    },
    "vip_hap": {
        "children": [
            "haproxy",
            "haproxy_vip"
        ]
    }
}
2025-02-19 14:15:39,852 p=28388 u=digitd n=ansible | {
    "_meta": {
        "hostvars": {
            "db.master.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.slave.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            },
            "db.test.lan": {
                "ansible_port": 22,
                "ansible_python_interpreter": "auto_silent",
                "ansible_ssh_private_key_file": "../ssh-keys/.keys/my_key",
                "ansible_user": "root"
            }
        }
    },
    "all": {
        "children": [
            "ungrouped",
            "cluster",
            "database",
            "vip_hap"
        ]
    },
    "cluster": {
        "children": [
            "haproxy",
            "master",
            "slave"
        ]
    },
    "database": {
        "children": [
            "master",
            "slave"
        ]
    },
    "haproxy": {
        "hosts": [
            "db.test.lan"
        ]
    },
    "haproxy_vip": {
        "hosts": [
            "db.test1.lan"
        ]
    },
    "master": {
        "hosts": [
            "db.master.lan"
        ]
    },
    "slave": {
        "hosts": [
            "db.slave.lan"
        ]
    },
    "vip_hap": {
        "children": [
            "haproxy",
            "haproxy_vip"
        ]
    }
}
2025-02-19 14:16:26,618 p=28685 u=digitd n=ansible | db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:16:31,468 p=28685 u=digitd n=ansible |  [ERROR]: User interrupted execution

2025-02-19 14:16:49,961 p=28859 u=digitd n=ansible | db.test1.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: digitd@db.test1.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-19 14:16:50,281 p=28859 u=digitd n=ansible | db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:22:57,606 p=30530 u=digitd n=ansible | db.test1.lan | UNREACHABLE! => {
    "changed": false,
    "msg": "Failed to connect to the host via ssh: digitd@db.test1.lan: Permission denied (publickey,password).",
    "unreachable": true
}
2025-02-19 14:22:59,299 p=30530 u=digitd n=ansible | db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:26:15,691 p=31488 u=digitd n=ansible | db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:26:16,028 p=31488 u=digitd n=ansible | db.test1.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-19 14:47:17,317 p=3681 u=digitd n=ansible | PLAY [Install haproxy and run service] **************************************************************************************************************************************************************
2025-02-19 14:47:17,343 p=3681 u=digitd n=ansible | TASK [Install HAProxy] ******************************************************************************************************************************************************************************
2025-02-19 14:47:24,468 p=3681 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 14:47:24,472 p=3681 u=digitd n=ansible | TASK [Check service status] *************************************************************************************************************************************************************************
2025-02-19 14:47:26,653 p=3681 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 14:47:26,674 p=3681 u=digitd n=ansible | PLAY [Install PostgreSQL and check status] **********************************************************************************************************************************************************
2025-02-19 14:47:26,683 p=3681 u=digitd n=ansible | TASK [Install PostgreSQL] ***************************************************************************************************************************************************************************
2025-02-19 14:47:38,943 p=3681 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 14:47:39,267 p=3681 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:47:39,269 p=3681 u=digitd n=ansible | TASK [Check service] ********************************************************************************************************************************************************************************
2025-02-19 14:47:41,041 p=3681 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:47:41,193 p=3681 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 14:47:41,212 p=3681 u=digitd n=ansible | PLAY [Correct configs for PostgreSQL on the master node] ********************************************************************************************************************************************
2025-02-19 14:47:41,217 p=3681 u=digitd n=ansible | TASK [Edit or ensure port for the service] **********************************************************************************************************************************************************
2025-02-19 14:47:41,707 p=3681 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:47:41,711 p=3681 u=digitd n=ansible | TASK [Let's listen all incoming connections] ********************************************************************************************************************************************************
2025-02-19 14:47:42,122 p=3681 u=digitd n=ansible | changed: [db.master.lan]
2025-02-19 14:47:42,126 p=3681 u=digitd n=ansible | TASK [Restart service after editing of configs] *****************************************************************************************************************************************************
2025-02-19 14:47:44,054 p=3681 u=digitd n=ansible | changed: [db.master.lan]
2025-02-19 14:47:44,067 p=3681 u=digitd n=ansible | PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ************************************************************************************************
2025-02-19 14:47:44,082 p=3681 u=digitd n=ansible | TASK [Edit or ensure config file for haproxy] *******************************************************************************************************************************************************
2025-02-19 14:47:45,428 p=3681 u=digitd n=ansible | changed: [db.test.lan]
2025-02-19 14:47:45,653 p=3681 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 14:47:45,659 p=3681 u=digitd n=ansible | TASK [Restart haproxy service] **********************************************************************************************************************************************************************
2025-02-19 14:47:46,877 p=3681 u=digitd n=ansible | [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxydeb (Wed 2025-02-19 14:47:46 MSK):    haproxy[2097]: backend master_back has no server
available!      Broadcast message from systemd-journald@haproxydeb (Wed 2025-02-19 14:47:46 MSK):    haproxy[2097]: backend master_back has no server available!

2025-02-19 14:47:46,905 p=3681 u=digitd n=ansible | changed: [db.test.lan]
2025-02-19 14:47:47,645 p=3681 u=digitd n=ansible | [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxyvip (Wed 2025-02-19 14:47:47 MSK):    haproxy[30455]: backend master_back has no server
available!      Broadcast message from systemd-journald@haproxyvip (Wed 2025-02-19 14:47:47 MSK):    haproxy[30455]: backend master_back has no server available!

2025-02-19 14:47:47,669 p=3681 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 14:47:47,684 p=3681 u=digitd n=ansible | PLAY [Run keepalived services for MASTER Haproxy] ***************************************************************************************************************************************************
2025-02-19 14:47:47,694 p=3681 u=digitd n=ansible | TASK [Run keepalived on MASTER HAProxy node] ********************************************************************************************************************************************************
2025-02-19 14:47:47,787 p=3681 u=digitd n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-02-19 14:47:47,788 p=3681 u=digitd n=ansible | fatal: [db.test1.lan]: FAILED! => {"changed": false, "msg": "Could not find or access '../config_files/keepalived_master_haproxy.cfg'\nSearched in:\n\t/home/digitd/travelata/ansible/files/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/files/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/../config_files/keepalived_master_haproxy.cfg on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-02-19 14:47:47,788 p=3681 u=digitd n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************
2025-02-19 14:47:47,789 p=3681 u=digitd n=ansible | db.master.lan              : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 14:47:47,789 p=3681 u=digitd n=ansible | db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 14:47:47,789 p=3681 u=digitd n=ansible | db.test.lan                : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 14:47:47,789 p=3681 u=digitd n=ansible | db.test1.lan               : ok=2    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-19 14:51:07,885 p=5067 u=digitd n=ansible | PLAY [Install haproxy and run service] **************************************************************************************************************************************************************
2025-02-19 14:51:07,894 p=5067 u=digitd n=ansible | TASK [Install HAProxy] ******************************************************************************************************************************************************************************
2025-02-19 14:52:21,998 p=5067 u=digitd n=ansible |  [ERROR]: User interrupted execution

2025-02-19 14:52:23,350 p=5379 u=digitd n=ansible | PLAY [Install haproxy and run service] **************************************************************************************************************************************************************
2025-02-19 14:52:23,365 p=5379 u=digitd n=ansible | TASK [Install HAProxy] ******************************************************************************************************************************************************************************
2025-02-19 14:53:17,592 p=5379 u=digitd n=ansible |  [ERROR]: User interrupted execution

2025-02-19 14:58:58,828 p=7382 u=digitd n=ansible | PLAY [Install haproxy and run service] **************************************************************************************************************************************************************
2025-02-19 14:58:58,839 p=7382 u=digitd n=ansible | TASK [Install HAProxy] ******************************************************************************************************************************************************************************
2025-02-19 14:59:00,939 p=7382 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 14:59:00,942 p=7382 u=digitd n=ansible | TASK [Check service status] *************************************************************************************************************************************************************************
2025-02-19 14:59:02,443 p=7382 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 14:59:02,450 p=7382 u=digitd n=ansible | PLAY [Install PostgreSQL and check status] **********************************************************************************************************************************************************
2025-02-19 14:59:02,462 p=7382 u=digitd n=ansible | TASK [Install PostgreSQL] ***************************************************************************************************************************************************************************
2025-02-19 14:59:04,500 p=7382 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 14:59:04,523 p=7382 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:59:04,526 p=7382 u=digitd n=ansible | TASK [Check service] ********************************************************************************************************************************************************************************
2025-02-19 14:59:05,621 p=7382 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 14:59:05,644 p=7382 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:59:05,656 p=7382 u=digitd n=ansible | PLAY [Correct configs for PostgreSQL on the master node] ********************************************************************************************************************************************
2025-02-19 14:59:05,665 p=7382 u=digitd n=ansible | TASK [Edit or ensure port for the service] **********************************************************************************************************************************************************
2025-02-19 14:59:06,192 p=7382 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:59:06,194 p=7382 u=digitd n=ansible | TASK [Let's listen all incoming connections] ********************************************************************************************************************************************************
2025-02-19 14:59:06,614 p=7382 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 14:59:06,616 p=7382 u=digitd n=ansible | TASK [Restart service after editing of configs] *****************************************************************************************************************************************************
2025-02-19 14:59:11,904 p=7382 u=digitd n=ansible | changed: [db.master.lan]
2025-02-19 14:59:11,912 p=7382 u=digitd n=ansible | PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ************************************************************************************************
2025-02-19 14:59:11,925 p=7382 u=digitd n=ansible | TASK [Edit or ensure config file for haproxy] *******************************************************************************************************************************************************
2025-02-19 14:59:13,002 p=7382 u=digitd n=ansible | changed: [db.test.lan]
2025-02-19 14:59:13,192 p=7382 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 14:59:13,194 p=7382 u=digitd n=ansible | TASK [Restart haproxy service] **********************************************************************************************************************************************************************
2025-02-19 14:59:14,459 p=7382 u=digitd n=ansible | changed: [db.test.lan]
2025-02-19 14:59:14,495 p=7382 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 14:59:14,512 p=7382 u=digitd n=ansible | PLAY [Run keepalived services for MASTER Haproxy] ***************************************************************************************************************************************************
2025-02-19 14:59:14,519 p=7382 u=digitd n=ansible | TASK [Run keepalived on MASTER HAProxy node] ********************************************************************************************************************************************************
2025-02-19 14:59:14,612 p=7382 u=digitd n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-02-19 14:59:14,613 p=7382 u=digitd n=ansible | fatal: [db.test1.lan]: FAILED! => {"changed": false, "msg": "Could not find or access '../config_files/keepalived_master_haproxy.cfg'\nSearched in:\n\t/home/digitd/travelata/ansible/files/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/files/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/../config_files/keepalived_master_haproxy.cfg on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-02-19 14:59:14,613 p=7382 u=digitd n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************
2025-02-19 14:59:14,614 p=7382 u=digitd n=ansible | db.master.lan              : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 14:59:14,614 p=7382 u=digitd n=ansible | db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 14:59:14,614 p=7382 u=digitd n=ansible | db.test.lan                : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 14:59:14,614 p=7382 u=digitd n=ansible | db.test1.lan               : ok=2    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-19 15:00:53,777 p=8185 u=digitd n=ansible | PLAY [Install haproxy and run service] **************************************************************************************************************************************************************
2025-02-19 15:00:53,785 p=8185 u=digitd n=ansible | TASK [Install HAProxy] ******************************************************************************************************************************************************************************
2025-02-19 15:00:56,659 p=8185 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 15:00:56,662 p=8185 u=digitd n=ansible | TASK [Check service status] *************************************************************************************************************************************************************************
2025-02-19 15:00:58,218 p=8185 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 15:00:58,227 p=8185 u=digitd n=ansible | PLAY [Install PostgreSQL and check status] **********************************************************************************************************************************************************
2025-02-19 15:00:58,242 p=8185 u=digitd n=ansible | TASK [Install PostgreSQL] ***************************************************************************************************************************************************************************
2025-02-19 15:01:00,243 p=8185 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 15:01:00,366 p=8185 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:01:00,369 p=8185 u=digitd n=ansible | TASK [Check service] ********************************************************************************************************************************************************************************
2025-02-19 15:01:01,462 p=8185 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:01:01,478 p=8185 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 15:01:01,495 p=8185 u=digitd n=ansible | PLAY [Correct configs for PostgreSQL on the master node] ********************************************************************************************************************************************
2025-02-19 15:01:01,500 p=8185 u=digitd n=ansible | TASK [Edit or ensure port for the service] **********************************************************************************************************************************************************
2025-02-19 15:01:01,992 p=8185 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:01:01,995 p=8185 u=digitd n=ansible | TASK [Let's listen all incoming connections] ********************************************************************************************************************************************************
2025-02-19 15:01:02,400 p=8185 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:01:02,402 p=8185 u=digitd n=ansible | TASK [Restart service after editing of configs] *****************************************************************************************************************************************************
2025-02-19 15:01:07,511 p=8185 u=digitd n=ansible | changed: [db.master.lan]
2025-02-19 15:01:07,522 p=8185 u=digitd n=ansible | PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ************************************************************************************************
2025-02-19 15:01:07,535 p=8185 u=digitd n=ansible | TASK [Edit or ensure config file for haproxy] *******************************************************************************************************************************************************
2025-02-19 15:01:08,509 p=8185 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 15:01:08,690 p=8185 u=digitd n=ansible | ok: [db.test1.lan]
2025-02-19 15:01:08,692 p=8185 u=digitd n=ansible | TASK [Restart haproxy service] **********************************************************************************************************************************************************************
2025-02-19 15:01:09,934 p=8185 u=digitd n=ansible | changed: [db.test.lan]
2025-02-19 15:01:09,958 p=8185 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 15:01:09,974 p=8185 u=digitd n=ansible | PLAY [Run keepalived services for MASTER Haproxy] ***************************************************************************************************************************************************
2025-02-19 15:01:09,979 p=8185 u=digitd n=ansible | TASK [Run keepalived on MASTER HAProxy node] ********************************************************************************************************************************************************
2025-02-19 15:01:10,070 p=8185 u=digitd n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-02-19 15:01:10,070 p=8185 u=digitd n=ansible | fatal: [db.test1.lan]: FAILED! => {"changed": false, "msg": "Could not find or access '../config_files/keepalived_master_haproxy.cfg'\nSearched in:\n\t/home/digitd/travelata/ansible/files/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/files/../config_files/keepalived_master_haproxy.cfg\n\t/home/digitd/travelata/ansible/../config_files/keepalived_master_haproxy.cfg on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-02-19 15:01:10,071 p=8185 u=digitd n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************
2025-02-19 15:01:10,071 p=8185 u=digitd n=ansible | db.master.lan              : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 15:01:10,071 p=8185 u=digitd n=ansible | db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 15:01:10,071 p=8185 u=digitd n=ansible | db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 15:01:10,071 p=8185 u=digitd n=ansible | db.test1.lan               : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-19 15:02:19,168 p=8930 u=digitd n=ansible | PLAY [Install haproxy and run service] **************************************************************************************************************************************************************
2025-02-19 15:02:19,179 p=8930 u=digitd n=ansible | TASK [Install HAProxy] ******************************************************************************************************************************************************************************
2025-02-19 15:02:21,175 p=8930 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 15:02:21,178 p=8930 u=digitd n=ansible | TASK [Check service status] *************************************************************************************************************************************************************************
2025-02-19 15:02:22,751 p=8930 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 15:02:22,767 p=8930 u=digitd n=ansible | PLAY [Install PostgreSQL and check status] **********************************************************************************************************************************************************
2025-02-19 15:02:22,781 p=8930 u=digitd n=ansible | TASK [Install PostgreSQL] ***************************************************************************************************************************************************************************
2025-02-19 15:02:24,871 p=8930 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 15:02:24,904 p=8930 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:02:24,906 p=8930 u=digitd n=ansible | TASK [Check service] ********************************************************************************************************************************************************************************
2025-02-19 15:02:26,025 p=8930 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-19 15:02:26,117 p=8930 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:02:26,137 p=8930 u=digitd n=ansible | PLAY [Correct configs for PostgreSQL on the master node] ********************************************************************************************************************************************
2025-02-19 15:02:26,142 p=8930 u=digitd n=ansible | TASK [Edit or ensure port for the service] **********************************************************************************************************************************************************
2025-02-19 15:02:26,666 p=8930 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:02:26,668 p=8930 u=digitd n=ansible | TASK [Let's listen all incoming connections] ********************************************************************************************************************************************************
2025-02-19 15:02:27,069 p=8930 u=digitd n=ansible | ok: [db.master.lan]
2025-02-19 15:02:27,071 p=8930 u=digitd n=ansible | TASK [Restart service after editing of configs] *****************************************************************************************************************************************************
2025-02-19 15:02:32,162 p=8930 u=digitd n=ansible | changed: [db.master.lan]
2025-02-19 15:02:32,173 p=8930 u=digitd n=ansible | PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ************************************************************************************************
2025-02-19 15:02:32,187 p=8930 u=digitd n=ansible | TASK [Edit or ensure config file for haproxy] *******************************************************************************************************************************************************
2025-02-19 15:02:33,206 p=8930 u=digitd n=ansible | ok: [db.test.lan]
2025-02-19 15:02:33,452 p=8930 u=digitd n=ansible | ok: [db.test1.lan]
2025-02-19 15:02:33,454 p=8930 u=digitd n=ansible | TASK [Restart haproxy service] **********************************************************************************************************************************************************************
2025-02-19 15:02:34,746 p=8930 u=digitd n=ansible | changed: [db.test.lan]
2025-02-19 15:02:34,792 p=8930 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 15:02:34,806 p=8930 u=digitd n=ansible | PLAY [Run keepalived services for MASTER Haproxy] ***************************************************************************************************************************************************
2025-02-19 15:02:34,814 p=8930 u=digitd n=ansible | TASK [Run keepalived on MASTER HAProxy node] ********************************************************************************************************************************************************
2025-02-19 15:02:35,588 p=8930 u=digitd n=ansible | ok: [db.test1.lan]
2025-02-19 15:02:35,590 p=8930 u=digitd n=ansible | TASK [Ensure or run keepalived service for Master] **************************************************************************************************************************************************
2025-02-19 15:02:37,860 p=8930 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 15:02:37,870 p=8930 u=digitd n=ansible | PLAY [Run keepalived services for BACKUP Haproxy] ***************************************************************************************************************************************************
2025-02-19 15:02:37,882 p=8930 u=digitd n=ansible | TASK [Run keepalived on BACKUP HAProxy node] ********************************************************************************************************************************************************
2025-02-19 15:02:38,868 p=8930 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 15:02:38,871 p=8930 u=digitd n=ansible | TASK [Ensure or run keepalived service for BACKUP] **************************************************************************************************************************************************
2025-02-19 15:02:41,079 p=8930 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-19 15:02:41,086 p=8930 u=digitd n=ansible | PLAY RECAP ******************************************************************************************************************************************************************************************
2025-02-19 15:02:41,087 p=8930 u=digitd n=ansible | db.master.lan              : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 15:02:41,087 p=8930 u=digitd n=ansible | db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 15:02:41,087 p=8930 u=digitd n=ansible | db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-19 15:02:41,087 p=8930 u=digitd n=ansible | db.test1.lan               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 09:47:21,744 p=3363 u=digitd n=ansible | db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 09:47:22,346 p=3363 u=digitd n=ansible | db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 09:47:23,288 p=3363 u=digitd n=ansible | db.test1.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 09:47:23,963 p=3363 u=digitd n=ansible | db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 12:19:31,772 p=1179 u=digitd n=ansible | PLAY [Install haproxy and run service] ***********************************************************************************************************************************************
2025-02-20 12:19:31,785 p=1179 u=digitd n=ansible | TASK [Install HAProxy] ***************************************************************************************************************************************************************
2025-02-20 12:19:41,811 p=1179 u=digitd n=ansible | fatal: [db.test.lan]: UNREACHABLE! => {"changed": false, "msg": "Failed to connect to the host via ssh: ssh: connect to host db.test.lan port 22: Connection timed out", "unreachable": true}
2025-02-20 12:19:41,814 p=1179 u=digitd n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************
2025-02-20 12:19:41,815 p=1179 u=digitd n=ansible | db.test.lan                : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 12:59:10,922 p=9228 u=digitd n=ansible | PLAY [Install haproxy and run service] ***********************************************************************************************************************************************
2025-02-20 12:59:10,947 p=9228 u=digitd n=ansible | TASK [Install HAProxy] ***************************************************************************************************************************************************************
2025-02-20 12:59:22,749 p=9228 u=digitd n=ansible | ok: [db.test.lan]
2025-02-20 12:59:22,753 p=9228 u=digitd n=ansible | TASK [Check service status] **********************************************************************************************************************************************************
2025-02-20 12:59:24,914 p=9228 u=digitd n=ansible | ok: [db.test.lan]
2025-02-20 12:59:24,921 p=9228 u=digitd n=ansible | PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************
2025-02-20 12:59:24,942 p=9228 u=digitd n=ansible | TASK [Install PostgreSQL] ************************************************************************************************************************************************************
2025-02-20 12:59:36,048 p=9228 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-20 12:59:36,212 p=9228 u=digitd n=ansible | ok: [db.master.lan]
2025-02-20 12:59:36,216 p=9228 u=digitd n=ansible | TASK [Check service] *****************************************************************************************************************************************************************
2025-02-20 12:59:37,949 p=9228 u=digitd n=ansible | ok: [db.slave.lan]
2025-02-20 12:59:38,358 p=9228 u=digitd n=ansible | ok: [db.master.lan]
2025-02-20 12:59:38,375 p=9228 u=digitd n=ansible | PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************
2025-02-20 12:59:38,383 p=9228 u=digitd n=ansible | TASK [Edit or ensure port for the service] *******************************************************************************************************************************************
2025-02-20 12:59:38,903 p=9228 u=digitd n=ansible | ok: [db.master.lan]
2025-02-20 12:59:38,907 p=9228 u=digitd n=ansible | TASK [Let's listen all incoming connections] *****************************************************************************************************************************************
2025-02-20 12:59:39,341 p=9228 u=digitd n=ansible | ok: [db.master.lan]
2025-02-20 12:59:39,344 p=9228 u=digitd n=ansible | TASK [Restart service after editing of configs] **************************************************************************************************************************************
2025-02-20 12:59:45,015 p=9228 u=digitd n=ansible | changed: [db.master.lan]
2025-02-20 12:59:45,025 p=9228 u=digitd n=ansible | PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************
2025-02-20 12:59:45,039 p=9228 u=digitd n=ansible | TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************
2025-02-20 12:59:46,315 p=9228 u=digitd n=ansible | ok: [db.test.lan]
2025-02-20 12:59:46,641 p=9228 u=digitd n=ansible | ok: [db.test1.lan]
2025-02-20 12:59:46,643 p=9228 u=digitd n=ansible | TASK [Restart haproxy service] *******************************************************************************************************************************************************
2025-02-20 12:59:47,929 p=9228 u=digitd n=ansible | changed: [db.test.lan]
2025-02-20 12:59:48,538 p=9228 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-20 12:59:48,558 p=9228 u=digitd n=ansible | PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************
2025-02-20 12:59:48,575 p=9228 u=digitd n=ansible | TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************
2025-02-20 12:59:49,507 p=9228 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-20 12:59:49,509 p=9228 u=digitd n=ansible | TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************
2025-02-20 12:59:51,770 p=9228 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-20 12:59:51,777 p=9228 u=digitd n=ansible | PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************
2025-02-20 12:59:51,784 p=9228 u=digitd n=ansible | TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************
2025-02-20 12:59:52,618 p=9228 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-20 12:59:52,621 p=9228 u=digitd n=ansible | TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************
2025-02-20 12:59:54,828 p=9228 u=digitd n=ansible | changed: [db.test1.lan]
2025-02-20 12:59:54,836 p=9228 u=digitd n=ansible | PLAY [Configure etcd on the MASTER database] *****************************************************************************************************************************************
2025-02-20 12:59:54,842 p=9228 u=digitd n=ansible | TASK [Copy etcd file] ****************************************************************************************************************************************************************
2025-02-20 12:59:56,164 p=9228 u=digitd n=ansible | changed: [db.master.lan]
2025-02-20 12:59:56,167 p=9228 u=digitd n=ansible | TASK [Restart etcd service] **********************************************************************************************************************************************************
2025-02-20 12:59:59,318 p=9228 u=digitd n=ansible | changed: [db.master.lan]
2025-02-20 12:59:59,324 p=9228 u=digitd n=ansible | PLAY RECAP ***************************************************************************************************************************************************************************
2025-02-20 12:59:59,324 p=9228 u=digitd n=ansible | db.master.lan              : ok=7    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 12:59:59,324 p=9228 u=digitd n=ansible | db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 12:59:59,324 p=9228 u=digitd n=ansible | db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 12:59:59,324 p=9228 u=digitd n=ansible | db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 20:50:41,823 p=1310292 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 20:50:41,923 p=1310292 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 20:50:41,991 p=1310292 u=digitd n=ansible INFO| db.test1.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 20:50:43,981 p=1310292 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-20 22:32:42,903 p=1490923 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************
2025-02-20 22:32:42,907 p=1490923 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************
2025-02-20 22:32:52,716 p=1490923 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-20 22:32:52,718 p=1490923 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************
2025-02-20 22:32:54,781 p=1490923 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-20 22:32:54,782 p=1490923 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************
2025-02-20 22:32:54,819 p=1490923 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************
2025-02-20 22:32:58,399 p=1490923 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-20 22:33:04,355 p=1490923 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:33:04,356 p=1490923 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************
2025-02-20 22:33:05,427 p=1490923 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-20 22:33:06,168 p=1490923 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:33:06,169 p=1490923 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ***************************************************************************************************************************
2025-02-20 22:33:06,227 p=1490923 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************
2025-02-20 22:33:06,754 p=1490923 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:33:06,755 p=1490923 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************
2025-02-20 22:33:07,226 p=1490923 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:33:07,227 p=1490923 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ************************************************************************************************************************************
2025-02-20 22:33:13,380 p=1490923 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-20 22:33:13,382 p=1490923 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *******************************************************************************
2025-02-20 22:33:13,427 p=1490923 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] **************************************************************************************************************************************
2025-02-20 22:33:14,419 p=1490923 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-20 22:33:14,468 p=1490923 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-20 22:33:14,469 p=1490923 u=digitd n=ansible INFO| TASK [Restart haproxy service] *****************************************************************************************************************************************************
2025-02-20 22:33:15,481 p=1490923 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-20 22:33:15,549 p=1490923 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:33:15,550 p=1490923 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] **********************************************************************************************************************************
2025-02-20 22:33:15,584 p=1490923 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ***************************************************************************************************************************************
2025-02-20 22:33:16,242 p=1490923 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:33:16,243 p=1490923 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] *********************************************************************************************************************************
2025-02-20 22:33:18,197 p=1490923 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:33:18,198 p=1490923 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] **********************************************************************************************************************************
2025-02-20 22:33:18,233 p=1490923 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ***************************************************************************************************************************************
2025-02-20 22:33:18,873 p=1490923 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:33:18,874 p=1490923 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] *********************************************************************************************************************************
2025-02-20 22:33:20,940 p=1490923 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:33:20,941 p=1490923 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database] ***************************************************************************************************************************************
2025-02-20 22:33:20,975 p=1490923 u=digitd n=ansible INFO| TASK [Copy etcd file] **************************************************************************************************************************************************************
2025-02-20 22:33:21,085 p=1490923 u=digitd n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-02-20 22:33:21,086 p=1490923 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Could not find or access '../config_files/etcd'\nSearched in:\n\t/run/media/digitd/NFS/git/travelata/travelata_test/ansible/files/../config_files/etcd\n\t/run/media/digitd/NFS/git/travelata/travelata_test/ansible/../config_files/etcd\n\t/run/media/digitd/NFS/git/travelata/travelata_test/ansible/files/../config_files/etcd\n\t/run/media/digitd/NFS/git/travelata/travelata_test/ansible/../config_files/etcd on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-02-20 22:33:21,140 p=1490923 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************
2025-02-20 22:33:21,190 p=1490923 u=digitd n=ansible INFO| db.master.lan              : ok=5    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-20 22:33:21,240 p=1490923 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 22:33:21,265 p=1490923 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 22:33:21,290 p=1490923 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 22:33:49,775 p=1493388 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************
2025-02-20 22:33:49,779 p=1493388 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************
2025-02-20 22:33:52,721 p=1493388 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-20 22:33:52,722 p=1493388 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************
2025-02-20 22:33:53,919 p=1493388 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-20 22:33:53,920 p=1493388 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************
2025-02-20 22:33:53,956 p=1493388 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************
2025-02-20 22:33:56,274 p=1493388 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-20 22:34:00,059 p=1493388 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:34:00,060 p=1493388 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************
2025-02-20 22:34:01,038 p=1493388 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-20 22:34:01,467 p=1493388 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:34:01,468 p=1493388 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ***************************************************************************************************************************
2025-02-20 22:34:01,505 p=1493388 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************
2025-02-20 22:34:01,937 p=1493388 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:34:01,938 p=1493388 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************
2025-02-20 22:34:02,325 p=1493388 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:34:02,326 p=1493388 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ************************************************************************************************************************************
2025-02-20 22:34:08,513 p=1493388 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-20 22:34:08,515 p=1493388 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *******************************************************************************
2025-02-20 22:34:08,555 p=1493388 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] **************************************************************************************************************************************
2025-02-20 22:34:09,334 p=1493388 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-20 22:34:09,336 p=1493388 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-20 22:34:09,379 p=1493388 u=digitd n=ansible INFO| TASK [Restart haproxy service] *****************************************************************************************************************************************************
2025-02-20 22:34:10,373 p=1493388 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-20 22:34:10,424 p=1493388 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:34:10,426 p=1493388 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] **********************************************************************************************************************************
2025-02-20 22:34:10,454 p=1493388 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ***************************************************************************************************************************************
2025-02-20 22:34:11,166 p=1493388 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:34:11,167 p=1493388 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] *********************************************************************************************************************************
2025-02-20 22:34:13,169 p=1493388 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:34:13,170 p=1493388 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] **********************************************************************************************************************************
2025-02-20 22:34:13,204 p=1493388 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ***************************************************************************************************************************************
2025-02-20 22:34:13,829 p=1493388 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:34:13,830 p=1493388 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] *********************************************************************************************************************************
2025-02-20 22:34:15,866 p=1493388 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-20 22:34:15,867 p=1493388 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database] ***************************************************************************************************************************************
2025-02-20 22:34:15,997 p=1493388 u=digitd n=ansible INFO| TASK [Copy etcd file] **************************************************************************************************************************************************************
2025-02-20 22:34:17,255 p=1493388 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-20 22:34:17,256 p=1493388 u=digitd n=ansible INFO| TASK [Restart etcd service] ********************************************************************************************************************************************************
2025-02-20 22:34:20,433 p=1493388 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-20 22:34:20,434 p=1493388 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************
2025-02-20 22:34:20,477 p=1493388 u=digitd n=ansible INFO| db.master.lan              : ok=7    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 22:34:20,527 p=1493388 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 22:34:20,585 p=1493388 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-20 22:34:20,618 p=1493388 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:15:00,790 p=1305347 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-21 20:15:03,587 p=1305347 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-21 20:15:04,305 p=1305347 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-21 20:15:04,519 p=1305347 u=digitd n=ansible INFO| db.test1.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-02-21 20:15:16,497 p=1305930 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *********************************************************************************************************************************************
2025-02-21 20:15:16,501 p=1305930 u=digitd n=ansible INFO| TASK [Install HAProxy] *************************************************************************************************************************************************************
2025-02-21 20:15:30,075 p=1305930 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 20:15:30,076 p=1305930 u=digitd n=ansible INFO| TASK [Check service status] ********************************************************************************************************************************************************
2025-02-21 20:15:32,544 p=1305930 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 20:15:32,546 p=1305930 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *****************************************************************************************************************************************
2025-02-21 20:15:32,588 p=1305930 u=digitd n=ansible INFO| TASK [Install PostgreSQL] **********************************************************************************************************************************************************
2025-02-21 20:15:40,780 p=1305930 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 20:15:44,889 p=1305930 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:15:44,890 p=1305930 u=digitd n=ansible INFO| TASK [Check service] ***************************************************************************************************************************************************************
2025-02-21 20:15:46,392 p=1305930 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 20:15:47,249 p=1305930 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:15:47,250 p=1305930 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ***************************************************************************************************************************
2025-02-21 20:15:47,295 p=1305930 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *****************************************************************************************************************************************
2025-02-21 20:15:47,682 p=1305930 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:15:47,683 p=1305930 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***************************************************************************************************************************************
2025-02-21 20:15:48,092 p=1305930 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:15:48,093 p=1305930 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ************************************************************************************************************************************
2025-02-21 20:15:53,679 p=1305930 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:15:53,680 p=1305930 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *******************************************************************************
2025-02-21 20:15:53,720 p=1305930 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] **************************************************************************************************************************************
2025-02-21 20:15:54,942 p=1305930 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-21 20:15:55,068 p=1305930 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:15:55,069 p=1305930 u=digitd n=ansible INFO| TASK [Restart haproxy service] *****************************************************************************************************************************************************
2025-02-21 20:15:56,208 p=1305930 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-21 20:15:56,553 p=1305930 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:15:56,554 p=1305930 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] **********************************************************************************************************************************
2025-02-21 20:15:56,586 p=1305930 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ***************************************************************************************************************************************
2025-02-21 20:15:57,336 p=1305930 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:15:57,337 p=1305930 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] *********************************************************************************************************************************
2025-02-21 20:15:59,384 p=1305930 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:15:59,385 p=1305930 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] **********************************************************************************************************************************
2025-02-21 20:15:59,420 p=1305930 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ***************************************************************************************************************************************
2025-02-21 20:16:00,114 p=1305930 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:16:00,115 p=1305930 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] *********************************************************************************************************************************
2025-02-21 20:16:02,103 p=1305930 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:16:02,104 p=1305930 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database] ***************************************************************************************************************************************
2025-02-21 20:16:02,394 p=1305930 u=digitd n=ansible INFO| TASK [Copy etcd file] **************************************************************************************************************************************************************
2025-02-21 20:16:03,214 p=1305930 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:16:03,215 p=1305930 u=digitd n=ansible INFO| TASK [Restart etcd service] ********************************************************************************************************************************************************
2025-02-21 20:16:07,285 p=1305930 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:16:07,286 p=1305930 u=digitd n=ansible INFO| PLAY [Configure Patroni] ***********************************************************************************************************************************************************
2025-02-21 20:16:07,594 p=1305930 u=digitd n=ansible INFO| TASK [Create unnecessary folders and files] ****************************************************************************************************************************************
2025-02-21 20:16:08,093 p=1305930 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-21 20:16:08,105 p=1305930 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:16:08,162 p=1305930 u=digitd n=ansible INFO| PLAY RECAP *************************************************************************************************************************************************************************
2025-02-21 20:16:08,217 p=1305930 u=digitd n=ansible INFO| db.master.lan              : ok=8    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:16:08,267 p=1305930 u=digitd n=ansible INFO| db.slave.lan               : ok=3    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:16:08,292 p=1305930 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:16:08,317 p=1305930 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:47:53,011 p=1366538 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ******************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:53,015 p=1366538 u=digitd n=ansible INFO| TASK [Install HAProxy] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:54,867 p=1366538 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 20:47:54,868 p=1366538 u=digitd n=ansible INFO| TASK [Check service status] *****************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:56,165 p=1366538 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 20:47:56,167 p=1366538 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] **************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:56,195 p=1366538 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:57,959 p=1366538 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 20:47:58,849 p=1366538 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:47:58,850 p=1366538 u=digitd n=ansible INFO| TASK [Check service] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:59,789 p=1366538 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 20:47:59,846 p=1366538 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:47:59,848 p=1366538 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ************************************************************************************************************************************************************************************************************************************
2025-02-21 20:47:59,886 p=1366538 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] **************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:00,393 p=1366538 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:48:00,394 p=1366538 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:00,761 p=1366538 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:48:00,762 p=1366538 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] *********************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:05,443 p=1366538 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:48:05,444 p=1366538 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ****************************************************************************************************************************************************************************************
2025-02-21 20:48:05,478 p=1366538 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ***********************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:06,291 p=1366538 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 20:48:06,452 p=1366538 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-21 20:48:06,453 p=1366538 u=digitd n=ansible INFO| TASK [Restart haproxy service] **************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:07,538 p=1366538 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-21 20:48:07,538 p=1366538 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:48:07,569 p=1366538 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *******************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:07,594 p=1366538 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:08,226 p=1366538 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:48:08,227 p=1366538 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ******************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:10,159 p=1366538 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:48:10,161 p=1366538 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *******************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:10,219 p=1366538 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:10,864 p=1366538 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:48:10,865 p=1366538 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ******************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:13,181 p=1366538 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 20:48:13,183 p=1366538 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database] ************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:13,227 p=1366538 u=digitd n=ansible INFO| TASK [Copy etcd file] ***********************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:13,977 p=1366538 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:48:13,978 p=1366538 u=digitd n=ansible INFO| TASK [Restart etcd service] *****************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:17,104 p=1366538 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:48:17,106 p=1366538 u=digitd n=ansible INFO| PLAY [Configure Patroni] ********************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:17,152 p=1366538 u=digitd n=ansible INFO| TASK [Create unnecessary folders and files] *************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:17,554 p=1366538 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 20:48:17,650 p=1366538 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 20:48:17,651 p=1366538 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ****************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:19,828 p=1366538 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-21 20:48:19,898 p=1366538 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 20:48:19,899 p=1366538 u=digitd n=ansible INFO| PLAY RECAP **********************************************************************************************************************************************************************************************************************************************************************************
2025-02-21 20:48:19,967 p=1366538 u=digitd n=ansible INFO| db.master.lan              : ok=9    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:48:20,017 p=1366538 u=digitd n=ansible INFO| db.slave.lan               : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:48:20,041 p=1366538 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 20:48:20,066 p=1366538 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 21:57:58,418 p=1490112 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************
2025-02-21 21:57:58,422 p=1490112 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************
2025-02-21 21:58:00,417 p=1490112 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 21:58:00,418 p=1490112 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************
2025-02-21 21:58:01,654 p=1490112 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 21:58:01,655 p=1490112 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************
2025-02-21 21:58:01,706 p=1490112 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************
2025-02-21 21:58:03,403 p=1490112 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 21:58:03,540 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:03,541 p=1490112 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************
2025-02-21 21:58:04,402 p=1490112 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 21:58:04,528 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:04,530 p=1490112 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************
2025-02-21 21:58:04,555 p=1490112 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************
2025-02-21 21:58:04,903 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:04,904 p=1490112 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************
2025-02-21 21:58:05,214 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:05,215 p=1490112 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************
2025-02-21 21:58:09,981 p=1490112 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 21:58:09,982 p=1490112 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************
2025-02-21 21:58:10,014 p=1490112 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************
2025-02-21 21:58:10,807 p=1490112 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-21 21:58:10,944 p=1490112 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-21 21:58:10,945 p=1490112 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************
2025-02-21 21:58:12,038 p=1490112 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-21 21:58:12,039 p=1490112 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 21:58:12,088 p=1490112 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************
2025-02-21 21:58:12,121 p=1490112 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************
2025-02-21 21:58:12,801 p=1490112 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 21:58:12,803 p=1490112 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************
2025-02-21 21:58:14,896 p=1490112 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 21:58:14,897 p=1490112 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************
2025-02-21 21:58:14,921 p=1490112 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************
2025-02-21 21:58:15,592 p=1490112 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 21:58:15,593 p=1490112 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************
2025-02-21 21:58:17,956 p=1490112 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-21 21:58:17,957 p=1490112 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database] **************************************************************************************************************************************************************************************************
2025-02-21 21:58:17,979 p=1490112 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************
2025-02-21 21:58:18,634 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:18,635 p=1490112 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************
2025-02-21 21:58:21,723 p=1490112 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 21:58:21,724 p=1490112 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************
2025-02-21 21:58:21,771 p=1490112 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************
2025-02-21 21:58:22,180 p=1490112 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 21:58:22,188 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:22,203 p=1490112 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************
2025-02-21 21:58:22,572 p=1490112 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-21 21:58:23,133 p=1490112 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-21 21:58:23,134 p=1490112 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************
2025-02-21 21:58:25,408 p=1490112 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-21 21:58:25,409 p=1490112 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-21 21:58:25,444 p=1490112 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************
2025-02-21 21:58:25,477 p=1490112 u=digitd n=ansible INFO| db.master.lan              : ok=10   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 21:58:25,510 p=1490112 u=digitd n=ansible INFO| db.slave.lan               : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 21:58:25,544 p=1490112 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-21 21:58:25,577 p=1490112 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:21:13,835 p=298924 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 13:21:13,843 p=298924 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 13:21:27,955 p=298924 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:21:27,956 p=298924 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 13:21:29,915 p=298924 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:21:29,917 p=298924 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 13:21:29,953 p=298924 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 13:21:41,310 p=298924 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:21:43,459 p=298924 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:21:43,460 p=298924 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 13:21:44,917 p=298924 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:21:45,143 p=298924 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:21:45,145 p=298924 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 13:21:45,185 p=298924 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 13:21:45,558 p=298924 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:21:45,559 p=298924 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 13:21:45,857 p=298924 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:21:45,857 p=298924 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 13:21:50,757 p=298924 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:21:50,758 p=298924 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 13:21:50,785 p=298924 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 13:21:52,169 p=298924 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:21:53,412 p=298924 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 13:21:53,413 p=298924 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 13:21:54,483 p=298924 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 13:21:54,906 p=298924 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:21:54,908 p=298924 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 13:21:54,976 p=298924 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 13:21:55,616 p=298924 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:21:55,617 p=298924 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 13:21:57,698 p=298924 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:21:57,699 p=298924 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 13:21:57,726 p=298924 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 13:21:58,316 p=298924 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:21:58,317 p=298924 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 13:22:00,400 p=298924 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:22:00,401 p=298924 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 13:22:00,442 p=298924 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:22:01,445 p=298924 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:22:01,446 p=298924 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 13:22:04,103 p=298924 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:22:04,104 p=298924 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************
2025-02-22 13:22:04,150 p=298924 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:22:04,894 p=298924 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 13:22:04,895 p=298924 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 13:22:05,831 p=298924 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Could not find the requested service etcd: host"}
2025-02-22 13:22:05,831 p=298924 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 13:22:05,957 p=298924 u=digitd n=ansible INFO| db.master.lan              : ok=7    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:22:05,982 p=298924 u=digitd n=ansible INFO| db.slave.lan               : ok=3    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 13:22:06,007 p=298924 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:22:06,032 p=298924 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:24:57,859 p=306047 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 13:24:57,863 p=306047 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 13:24:59,640 p=306047 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:24:59,642 p=306047 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 13:25:00,901 p=306047 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:25:00,903 p=306047 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 13:25:00,928 p=306047 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 13:25:02,690 p=306047 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:25:02,698 p=306047 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:25:02,727 p=306047 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 13:25:03,674 p=306047 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:25:03,809 p=306047 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:25:03,810 p=306047 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 13:25:03,911 p=306047 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 13:25:04,364 p=306047 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:25:04,365 p=306047 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 13:25:04,726 p=306047 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:25:04,727 p=306047 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 13:25:10,308 p=306047 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:25:10,309 p=306047 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 13:25:10,345 p=306047 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 13:25:11,132 p=306047 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:25:11,272 p=306047 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 13:25:11,273 p=306047 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 13:25:12,338 p=306047 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 13:25:12,381 p=306047 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:25:12,382 p=306047 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 13:25:12,411 p=306047 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 13:25:13,118 p=306047 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:25:13,119 p=306047 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 13:25:15,129 p=306047 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:25:15,130 p=306047 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 13:25:15,168 p=306047 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 13:25:15,764 p=306047 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:25:15,765 p=306047 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 13:25:17,818 p=306047 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:25:17,819 p=306047 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 13:25:17,935 p=306047 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:25:18,528 p=306047 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:25:18,529 p=306047 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 13:25:19,753 p=306047 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "No package matching 'etcd' is available"}
2025-02-22 13:25:19,754 p=306047 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 13:25:19,858 p=306047 u=digitd n=ansible INFO| db.master.lan              : ok=6    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 13:25:19,883 p=306047 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:25:19,908 p=306047 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:25:19,933 p=306047 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:26:46,847 p=309747 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 13:26:46,851 p=309747 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 13:26:48,557 p=309747 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:26:48,559 p=309747 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 13:26:49,781 p=309747 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:26:49,783 p=309747 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 13:26:49,803 p=309747 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 13:26:51,442 p=309747 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:26:51,607 p=309747 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:26:51,608 p=309747 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 13:26:52,497 p=309747 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:26:52,646 p=309747 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:26:52,647 p=309747 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 13:26:52,678 p=309747 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 13:26:53,099 p=309747 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:26:53,100 p=309747 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 13:26:53,485 p=309747 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:26:53,486 p=309747 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 13:26:58,794 p=309747 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:26:58,796 p=309747 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 13:26:58,828 p=309747 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 13:26:59,598 p=309747 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:26:59,710 p=309747 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 13:26:59,711 p=309747 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 13:27:00,785 p=309747 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:27:00,829 p=309747 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 13:27:00,831 p=309747 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 13:27:00,860 p=309747 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 13:27:01,498 p=309747 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:27:01,499 p=309747 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 13:27:03,565 p=309747 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:27:03,566 p=309747 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 13:27:03,618 p=309747 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 13:27:04,268 p=309747 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:27:04,268 p=309747 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 13:27:06,337 p=309747 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:27:06,338 p=309747 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 13:27:06,368 p=309747 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:27:06,983 p=309747 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:27:06,984 p=309747 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 13:27:08,341 p=309747 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "No package matching 'etcd-client etcd-server etcd-discovery' is available"}
2025-02-22 13:27:08,342 p=309747 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 13:27:08,375 p=309747 u=digitd n=ansible INFO| db.master.lan              : ok=6    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 13:27:08,400 p=309747 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:27:08,425 p=309747 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:27:08,450 p=309747 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:30:02,012 p=316384 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 13:30:02,016 p=316384 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 13:30:03,892 p=316384 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:30:03,893 p=316384 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 13:30:05,150 p=316384 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:30:05,151 p=316384 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 13:30:05,213 p=316384 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 13:30:06,861 p=316384 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:30:06,938 p=316384 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:30:06,939 p=316384 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 13:30:07,863 p=316384 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:30:07,919 p=316384 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:30:07,920 p=316384 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 13:30:07,946 p=316384 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 13:30:08,353 p=316384 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:30:08,354 p=316384 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 13:30:08,657 p=316384 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:30:08,658 p=316384 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 13:30:13,843 p=316384 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:30:13,845 p=316384 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 13:30:13,888 p=316384 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 13:30:14,662 p=316384 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:30:14,775 p=316384 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 13:30:14,776 p=316384 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 13:30:15,751 p=316384 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:30:15,808 p=316384 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 13:30:15,810 p=316384 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 13:30:15,837 p=316384 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 13:30:16,444 p=316384 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:30:16,445 p=316384 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 13:30:18,413 p=316384 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:30:18,414 p=316384 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 13:30:18,445 p=316384 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 13:30:19,024 p=316384 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:30:19,024 p=316384 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 13:30:21,026 p=316384 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:30:21,027 p=316384 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 13:30:21,062 p=316384 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:30:21,647 p=316384 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:30:21,648 p=316384 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 13:30:37,513 p=316384 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:30:37,514 p=316384 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 13:30:40,401 p=316384 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:30:40,402 p=316384 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************
2025-02-22 13:30:40,443 p=316384 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:30:41,238 p=316384 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:30:41,239 p=316384 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 13:30:42,146 p=316384 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Could not find the requested service etcd: host"}
2025-02-22 13:30:42,147 p=316384 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 13:30:42,208 p=316384 u=digitd n=ansible INFO| db.master.lan              : ok=8    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:30:42,280 p=316384 u=digitd n=ansible INFO| db.slave.lan               : ok=3    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 13:30:42,333 p=316384 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:30:42,375 p=316384 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:32:27,494 p=321332 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 13:32:27,498 p=321332 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 13:32:29,225 p=321332 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:32:29,226 p=321332 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 13:32:30,384 p=321332 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:32:30,385 p=321332 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 13:32:30,418 p=321332 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 13:32:32,158 p=321332 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:32:32,222 p=321332 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:32:32,223 p=321332 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 13:32:33,136 p=321332 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:32:33,273 p=321332 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:32:33,275 p=321332 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 13:32:33,301 p=321332 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 13:32:33,714 p=321332 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:32:33,714 p=321332 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 13:32:34,132 p=321332 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:32:34,133 p=321332 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 13:32:39,051 p=321332 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:32:39,053 p=321332 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 13:32:39,076 p=321332 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 13:32:39,840 p=321332 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 13:32:39,964 p=321332 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 13:32:39,964 p=321332 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 13:32:41,034 p=321332 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 13:32:41,078 p=321332 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:32:41,079 p=321332 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 13:32:41,109 p=321332 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 13:32:41,735 p=321332 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:32:41,737 p=321332 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 13:32:43,645 p=321332 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:32:43,646 p=321332 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 13:32:43,692 p=321332 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 13:32:44,315 p=321332 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:32:44,316 p=321332 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 13:32:46,293 p=321332 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 13:32:46,294 p=321332 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 13:32:46,325 p=321332 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:32:46,945 p=321332 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:32:46,946 p=321332 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 13:32:48,434 p=321332 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 13:32:48,435 p=321332 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 13:32:50,840 p=321332 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 13:32:50,841 p=321332 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************
2025-02-22 13:32:50,883 p=321332 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 13:32:51,483 p=321332 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 13:32:51,484 p=321332 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 13:33:21,238 p=321332 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 13:33:21,239 p=321332 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 13:33:22,219 p=321332 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Unable to start service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-22 13:33:22,219 p=321332 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 13:33:22,571 p=321332 u=digitd n=ansible INFO| db.master.lan              : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:33:22,629 p=321332 u=digitd n=ansible INFO| db.slave.lan               : ok=4    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 13:33:22,679 p=321332 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 13:33:22,704 p=321332 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 15:20:47,577 p=513196 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 15:20:47,581 p=513196 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 15:20:54,728 p=513196 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 15:20:54,729 p=513196 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 15:20:56,092 p=513196 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 15:20:56,093 p=513196 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 15:20:56,130 p=513196 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 15:21:03,351 p=513196 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:21:06,100 p=513196 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:21:06,101 p=513196 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 15:21:07,771 p=513196 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:21:08,198 p=513196 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:21:08,200 p=513196 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 15:21:08,237 p=513196 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 15:21:08,673 p=513196 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:21:08,674 p=513196 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 15:21:09,132 p=513196 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:21:09,133 p=513196 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 15:21:14,753 p=513196 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:21:14,754 p=513196 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 15:21:14,786 p=513196 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 15:21:15,558 p=513196 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 15:21:15,775 p=513196 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 15:21:15,776 p=513196 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 15:21:16,810 p=513196 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:21:16,814 p=513196 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 15:21:16,844 p=513196 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 15:21:16,869 p=513196 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 15:21:17,540 p=513196 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:21:17,542 p=513196 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 15:21:19,627 p=513196 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:21:19,628 p=513196 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 15:21:19,727 p=513196 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 15:21:20,349 p=513196 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:21:20,350 p=513196 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 15:21:22,311 p=513196 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:21:22,312 p=513196 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 15:21:22,344 p=513196 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 15:21:23,392 p=513196 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:21:23,393 p=513196 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************
2025-02-22 15:21:23,794 p=513196 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:21:23,795 p=513196 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 15:21:25,722 p=513196 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:21:25,722 p=513196 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 15:21:28,468 p=513196 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:21:28,470 p=513196 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************
2025-02-22 15:21:28,527 p=513196 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 15:21:29,314 p=513196 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 15:21:29,315 p=513196 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 15:21:40,421 p=513196 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 15:21:40,423 p=513196 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 15:21:43,807 p=513196 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 15:21:43,809 p=513196 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************
2025-02-22 15:21:43,884 p=513196 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ******************************************************************************************
2025-02-22 15:21:44,023 p=513196 u=digitd n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-02-22 15:21:44,024 p=513196 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Could not find or access '../config_file/patroni_master.yaml'\nSearched in:\n\t/run/media/digitd/NFS/git/travelata_test/ansible/files/../config_file/patroni_master.yaml\n\t/run/media/digitd/NFS/git/travelata_test/ansible/../config_file/patroni_master.yaml\n\t/run/media/digitd/NFS/git/travelata_test/ansible/files/../config_file/patroni_master.yaml\n\t/run/media/digitd/NFS/git/travelata_test/ansible/../config_file/patroni_master.yaml on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-02-22 15:21:44,065 p=513196 u=digitd n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-02-22 15:21:44,099 p=513196 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Could not find or access '../config_file/patroni_master.yaml'\nSearched in:\n\t/run/media/digitd/NFS/git/travelata_test/ansible/files/../config_file/patroni_master.yaml\n\t/run/media/digitd/NFS/git/travelata_test/ansible/../config_file/patroni_master.yaml\n\t/run/media/digitd/NFS/git/travelata_test/ansible/files/../config_file/patroni_master.yaml\n\t/run/media/digitd/NFS/git/travelata_test/ansible/../config_file/patroni_master.yaml on the Ansible Controller.\nIf you are using a module and expect the file to exist on the remote, see the remote_src option"}
2025-02-22 15:21:44,132 p=513196 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 15:21:44,157 p=513196 u=digitd n=ansible INFO| db.master.lan              : ok=9    changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 15:21:44,182 p=513196 u=digitd n=ansible INFO| db.slave.lan               : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 15:21:44,207 p=513196 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 15:21:44,232 p=513196 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 15:31:10,777 p=531805 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************
2025-02-22 15:31:10,781 p=531805 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************
2025-02-22 15:31:12,685 p=531805 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 15:31:12,686 p=531805 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************
2025-02-22 15:31:13,844 p=531805 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 15:31:13,846 p=531805 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************
2025-02-22 15:31:13,878 p=531805 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************
2025-02-22 15:31:15,840 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:16,141 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:16,142 p=531805 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************
2025-02-22 15:31:17,129 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:17,170 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:17,172 p=531805 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************
2025-02-22 15:31:17,194 p=531805 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************
2025-02-22 15:31:17,573 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:17,575 p=531805 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************
2025-02-22 15:31:17,967 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:17,968 p=531805 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************
2025-02-22 15:31:23,389 p=531805 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:31:23,390 p=531805 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************
2025-02-22 15:31:23,427 p=531805 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************
2025-02-22 15:31:24,216 p=531805 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 15:31:24,353 p=531805 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 15:31:24,354 p=531805 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************
2025-02-22 15:31:25,360 p=531805 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 15:31:25,412 p=531805 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:31:25,413 p=531805 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************
2025-02-22 15:31:25,443 p=531805 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************
2025-02-22 15:31:26,123 p=531805 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:31:26,124 p=531805 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************
2025-02-22 15:31:28,017 p=531805 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:31:28,018 p=531805 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************
2025-02-22 15:31:28,121 p=531805 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************
2025-02-22 15:31:28,905 p=531805 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:31:28,906 p=531805 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************
2025-02-22 15:31:30,990 p=531805 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 15:31:30,991 p=531805 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************
2025-02-22 15:31:31,168 p=531805 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 15:31:31,799 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:31,800 p=531805 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************
2025-02-22 15:31:32,164 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:32,165 p=531805 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 15:31:33,544 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:33,545 p=531805 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 15:31:36,021 p=531805 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:31:36,023 p=531805 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************
2025-02-22 15:31:36,093 p=531805 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************
2025-02-22 15:31:36,893 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:36,894 p=531805 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************
2025-02-22 15:31:38,379 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:38,380 p=531805 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************
2025-02-22 15:31:41,310 p=531805 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 15:31:41,311 p=531805 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************
2025-02-22 15:31:41,409 p=531805 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ******************************************************************************************
2025-02-22 15:31:42,124 p=531805 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 15:31:42,237 p=531805 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 15:31:42,238 p=531805 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************
2025-02-22 15:31:43,654 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:44,358 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:44,359 p=531805 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************
2025-02-22 15:31:44,729 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:44,738 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:44,758 p=531805 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************
2025-02-22 15:31:45,126 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:45,128 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:45,216 p=531805 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************
2025-02-22 15:31:47,266 p=531805 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 15:31:47,320 p=531805 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 15:31:47,321 p=531805 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************
2025-02-22 15:31:47,348 p=531805 u=digitd n=ansible INFO| db.master.lan              : ok=14   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 15:31:47,373 p=531805 u=digitd n=ansible INFO| db.slave.lan               : ok=10   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 15:31:47,398 p=531805 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 15:31:47,423 p=531805 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:29:38,071 p=734303 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************
2025-02-22 17:29:38,075 p=734303 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************
2025-02-22 17:29:39,826 p=734303 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 17:29:39,827 p=734303 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************
2025-02-22 17:29:41,099 p=734303 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 17:29:41,101 p=734303 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************
2025-02-22 17:29:41,130 p=734303 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************
2025-02-22 17:29:43,246 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:29:44,396 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:29:44,397 p=734303 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************
2025-02-22 17:29:45,271 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:29:45,802 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:29:45,803 p=734303 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************
2025-02-22 17:29:45,870 p=734303 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************
2025-02-22 17:29:46,386 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:29:46,387 p=734303 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************
2025-02-22 17:29:46,774 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:29:46,775 p=734303 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************
2025-02-22 17:29:52,142 p=734303 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:29:52,143 p=734303 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************
2025-02-22 17:29:52,179 p=734303 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************
2025-02-22 17:29:52,939 p=734303 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 17:29:53,111 p=734303 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 17:29:53,112 p=734303 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************
2025-02-22 17:29:54,181 p=734303 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:29:54,221 p=734303 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 17:29:54,222 p=734303 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************
2025-02-22 17:29:54,253 p=734303 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************
2025-02-22 17:29:54,925 p=734303 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:29:54,926 p=734303 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************
2025-02-22 17:29:56,977 p=734303 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:29:56,978 p=734303 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************
2025-02-22 17:29:57,003 p=734303 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************
2025-02-22 17:29:57,688 p=734303 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:29:57,689 p=734303 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************
2025-02-22 17:30:00,174 p=734303 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:30:00,175 p=734303 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************
2025-02-22 17:30:00,203 p=734303 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************
2025-02-22 17:30:00,890 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:00,891 p=734303 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************
2025-02-22 17:30:01,278 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:01,279 p=734303 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************
2025-02-22 17:30:03,390 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:03,391 p=734303 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************
2025-02-22 17:30:07,196 p=734303 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:30:07,197 p=734303 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************
2025-02-22 17:30:07,269 p=734303 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************
2025-02-22 17:30:07,960 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:30:07,961 p=734303 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************
2025-02-22 17:30:09,534 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:30:09,535 p=734303 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************
2025-02-22 17:30:12,098 p=734303 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 17:30:12,099 p=734303 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************
2025-02-22 17:30:12,127 p=734303 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ***************************************************************************************************************************************************************
2025-02-22 17:30:12,929 p=734303 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 17:30:13,034 p=734303 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:30:13,035 p=734303 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************
2025-02-22 17:30:14,421 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:30:15,432 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:15,433 p=734303 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************
2025-02-22 17:30:15,823 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:30:15,834 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:15,859 p=734303 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************
2025-02-22 17:30:16,192 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:16,230 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:30:16,231 p=734303 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************
2025-02-22 17:30:18,251 p=734303 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:30:18,300 p=734303 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:30:18,301 p=734303 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************
2025-02-22 17:30:19,336 p=734303 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 17:30:20,067 p=734303 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:30:20,068 p=734303 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************
2025-02-22 17:30:20,100 p=734303 u=digitd n=ansible INFO| db.master.lan              : ok=15   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:30:20,133 p=734303 u=digitd n=ansible INFO| db.slave.lan               : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:30:20,183 p=734303 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:30:20,275 p=734303 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:39:28,459 p=752377 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************
2025-02-22 17:39:28,463 p=752377 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************
2025-02-22 17:39:30,282 p=752377 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 17:39:30,283 p=752377 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************
2025-02-22 17:39:31,611 p=752377 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 17:39:31,612 p=752377 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************
2025-02-22 17:39:31,639 p=752377 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************
2025-02-22 17:39:33,442 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:39:33,654 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:33,655 p=752377 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************
2025-02-22 17:39:34,581 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:34,669 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:39:34,670 p=752377 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************
2025-02-22 17:39:34,705 p=752377 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************
2025-02-22 17:39:35,122 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:35,123 p=752377 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************
2025-02-22 17:39:35,470 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:35,471 p=752377 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************
2025-02-22 17:39:40,776 p=752377 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:39:40,777 p=752377 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************
2025-02-22 17:39:40,905 p=752377 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************
2025-02-22 17:39:41,735 p=752377 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 17:39:41,824 p=752377 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 17:39:41,824 p=752377 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************
2025-02-22 17:39:42,823 p=752377 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:39:42,975 p=752377 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 17:39:42,977 p=752377 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************
2025-02-22 17:39:43,063 p=752377 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************
2025-02-22 17:39:43,837 p=752377 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:39:43,838 p=752377 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************
2025-02-22 17:39:45,848 p=752377 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:39:45,848 p=752377 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************
2025-02-22 17:39:45,996 p=752377 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************
2025-02-22 17:39:46,656 p=752377 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:39:46,657 p=752377 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************
2025-02-22 17:39:48,661 p=752377 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 17:39:48,662 p=752377 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************
2025-02-22 17:39:48,696 p=752377 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************
2025-02-22 17:39:49,310 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:49,311 p=752377 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************
2025-02-22 17:39:49,687 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:49,688 p=752377 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************
2025-02-22 17:39:51,258 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:51,259 p=752377 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************
2025-02-22 17:39:53,592 p=752377 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:39:53,593 p=752377 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************
2025-02-22 17:39:53,620 p=752377 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************
2025-02-22 17:39:54,262 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:39:54,262 p=752377 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************
2025-02-22 17:39:55,885 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:39:55,886 p=752377 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************
2025-02-22 17:39:58,590 p=752377 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 17:39:58,591 p=752377 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************
2025-02-22 17:39:58,637 p=752377 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ***************************************************************************************************************************************************************
2025-02-22 17:39:59,314 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:39:59,353 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:39:59,354 p=752377 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************
2025-02-22 17:40:14,048 p=752377 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 17:40:15,281 p=752377 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:40:15,282 p=752377 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************
2025-02-22 17:40:15,749 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:40:16,519 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:40:16,520 p=752377 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************
2025-02-22 17:40:16,893 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:40:16,896 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:40:16,943 p=752377 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************
2025-02-22 17:40:19,187 p=752377 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 17:40:19,775 p=752377 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 17:40:19,776 p=752377 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************
2025-02-22 17:40:21,123 p=752377 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 17:40:22,618 p=752377 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 17:40:22,619 p=752377 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************
2025-02-22 17:40:22,691 p=752377 u=digitd n=ansible INFO| db.master.lan              : ok=15   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:40:22,833 p=752377 u=digitd n=ansible INFO| db.slave.lan               : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:40:22,883 p=752377 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 17:40:22,958 p=752377 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:34:56,895 p=951758 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 19:34:56,899 p=951758 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:04,751 p=951758 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:35:04,753 p=951758 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:06,049 p=951758 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:35:06,050 p=951758 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 19:35:06,089 p=951758 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:22,289 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:24,744 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:24,744 p=951758 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:26,222 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:26,284 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:26,285 p=951758 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 19:35:26,313 p=951758 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 19:35:26,773 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:26,774 p=951758 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 19:35:27,140 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:27,141 p=951758 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 19:35:32,095 p=951758 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:35:32,096 p=951758 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 19:35:32,146 p=951758 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 19:35:32,937 p=951758 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:35:33,260 p=951758 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 19:35:33,261 p=951758 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:34,336 p=951758 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 19:35:34,509 p=951758 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:35:34,511 p=951758 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 19:35:34,553 p=951758 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 19:35:35,298 p=951758 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:35:35,299 p=951758 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 19:35:37,282 p=951758 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:35:37,283 p=951758 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 19:35:37,320 p=951758 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 19:35:38,003 p=951758 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:35:38,004 p=951758 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 19:35:39,930 p=951758 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:35:39,931 p=951758 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 19:35:39,953 p=951758 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:40,732 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:40,733 p=951758 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:41,039 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:41,039 p=951758 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:42,574 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:42,575 p=951758 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:45,596 p=951758 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:35:45,597 p=951758 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 19:35:45,702 p=951758 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:46,507 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:46,508 p=951758 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:48,030 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:48,031 p=951758 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:50,652 p=951758 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:35:50,653 p=951758 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:50,703 p=951758 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ***************************************************************************************************************************************************************************************************
2025-02-22 19:35:51,439 p=951758 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:35:51,487 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:51,488 p=951758 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:53,019 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:53,028 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:53,043 p=951758 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 19:35:53,374 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:53,415 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:53,415 p=951758 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 19:35:53,797 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:53,797 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:53,826 p=951758 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 19:35:55,976 p=951758 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:35:56,037 p=951758 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:35:56,038 p=951758 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:57,365 p=951758 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:35:57,621 p=951758 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:35:57,621 p=951758 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 19:35:57,658 p=951758 u=digitd n=ansible INFO| db.master.lan              : ok=15   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:35:57,683 p=951758 u=digitd n=ansible INFO| db.slave.lan               : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:35:57,708 p=951758 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:35:57,733 p=951758 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:38:09,967 p=958177 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 19:38:09,972 p=958177 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:11,832 p=958177 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:38:11,834 p=958177 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:13,014 p=958177 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:38:13,016 p=958177 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 19:38:13,049 p=958177 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:14,960 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:15,164 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:15,165 p=958177 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:16,029 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:16,086 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:16,087 p=958177 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 19:38:16,115 p=958177 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 19:38:16,592 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:16,593 p=958177 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 19:38:16,946 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:16,947 p=958177 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 19:38:22,408 p=958177 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:38:22,410 p=958177 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 19:38:22,456 p=958177 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 19:38:23,240 p=958177 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:38:23,380 p=958177 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 19:38:23,380 p=958177 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:24,388 p=958177 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:38:24,498 p=958177 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 19:38:24,499 p=958177 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 19:38:24,539 p=958177 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 19:38:25,182 p=958177 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:38:25,183 p=958177 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 19:38:27,106 p=958177 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:38:27,107 p=958177 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 19:38:27,155 p=958177 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 19:38:27,783 p=958177 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:38:27,784 p=958177 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 19:38:30,012 p=958177 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:38:30,013 p=958177 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 19:38:30,047 p=958177 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:30,654 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:30,655 p=958177 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:31,034 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:31,035 p=958177 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:32,383 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:32,384 p=958177 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:34,985 p=958177 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:38:34,986 p=958177 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 19:38:35,013 p=958177 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:35,699 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:35,700 p=958177 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:37,107 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:37,108 p=958177 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:41,499 p=958177 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:38:41,500 p=958177 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:41,529 p=958177 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ***************************************************************************************************************************************************************************************************
2025-02-22 19:38:42,276 p=958177 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:38:42,510 p=958177 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:38:42,511 p=958177 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:44,064 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:44,199 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:44,200 p=958177 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 19:38:44,522 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:44,574 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:44,575 p=958177 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 19:38:44,901 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:44,956 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:44,957 p=958177 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 19:38:47,018 p=958177 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:38:47,065 p=958177 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:38:47,066 p=958177 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:48,544 p=958177 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:38:48,738 p=958177 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:38:48,738 p=958177 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 19:38:48,738 p=958177 u=digitd n=ansible INFO| db.master.lan              : ok=15   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:38:48,794 p=958177 u=digitd n=ansible INFO| db.slave.lan               : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:38:48,819 p=958177 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:38:48,844 p=958177 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:52:48,517 p=985007 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 19:52:48,521 p=985007 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 19:52:50,402 p=985007 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:52:50,403 p=985007 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:52:51,625 p=985007 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:52:51,626 p=985007 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 19:52:51,691 p=985007 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 19:52:53,860 p=985007 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:52:54,331 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:52:54,331 p=985007 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 19:52:55,293 p=985007 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:52:55,492 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:52:55,493 p=985007 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 19:52:55,524 p=985007 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 19:52:55,910 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:52:55,911 p=985007 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 19:52:56,228 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:52:56,229 p=985007 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 19:53:01,117 p=985007 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:53:01,118 p=985007 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 19:53:01,141 p=985007 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 19:53:01,903 p=985007 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 19:53:02,056 p=985007 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 19:53:02,057 p=985007 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:03,119 p=985007 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:53:03,174 p=985007 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 19:53:03,175 p=985007 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 19:53:03,207 p=985007 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 19:53:03,823 p=985007 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:53:03,824 p=985007 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 19:53:05,758 p=985007 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:53:05,759 p=985007 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 19:53:05,790 p=985007 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 19:53:06,439 p=985007 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:53:06,440 p=985007 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 19:53:08,487 p=985007 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 19:53:08,488 p=985007 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 19:53:08,532 p=985007 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:09,138 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:53:09,139 p=985007 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:09,520 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:53:09,521 p=985007 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:10,901 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:53:10,902 p=985007 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:14,521 p=985007 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:53:14,522 p=985007 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 19:53:14,573 p=985007 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:15,194 p=985007 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:53:15,195 p=985007 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:16,805 p=985007 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:53:16,806 p=985007 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:20,563 p=985007 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:53:20,564 p=985007 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:20,622 p=985007 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ***************************************************************************************************************************************************************************************************
2025-02-22 19:53:21,295 p=985007 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:53:21,353 p=985007 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:53:21,354 p=985007 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 19:53:23,042 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:55:09,840 p=985007 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:55:09,842 p=985007 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 19:55:10,505 p=985007 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:55:10,690 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:55:10,691 p=985007 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 19:55:12,327 p=985007 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:55:12,329 p=985007 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:55:12,396 p=985007 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 19:55:14,635 p=985007 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 19:55:14,637 p=985007 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 19:55:14,696 p=985007 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 19:55:20,231 p=985007 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 19:55:21,295 p=985007 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 19:55:21,296 p=985007 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 19:55:21,395 p=985007 u=digitd n=ansible INFO| db.master.lan              : ok=15   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:55:21,428 p=985007 u=digitd n=ansible INFO| db.slave.lan               : ok=11   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:55:21,470 p=985007 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 19:55:21,578 p=985007 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:21:59,451 p=1037787 u=digitd n=ansible ERROR| ERROR! Invalid variable name in 'register' specified: 'etcdctl output'
2025-02-22 20:22:41,501 p=1039219 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 20:22:41,504 p=1039219 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 20:22:43,293 p=1039219 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:22:43,294 p=1039219 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:22:44,450 p=1039219 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:22:44,451 p=1039219 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:22:44,498 p=1039219 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 20:22:46,248 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:22:48,540 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:22:48,541 p=1039219 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 20:22:49,490 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:22:49,619 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:22:49,620 p=1039219 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 20:22:49,656 p=1039219 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:22:50,097 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:22:50,098 p=1039219 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 20:22:50,542 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:22:50,543 p=1039219 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 20:22:55,612 p=1039219 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:22:55,613 p=1039219 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 20:22:55,647 p=1039219 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 20:22:56,429 p=1039219 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:22:56,521 p=1039219 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 20:22:56,522 p=1039219 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:22:57,562 p=1039219 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:22:57,626 p=1039219 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 20:22:57,627 p=1039219 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:22:57,655 p=1039219 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:22:58,264 p=1039219 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:22:58,265 p=1039219 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 20:23:00,163 p=1039219 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:23:00,164 p=1039219 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:23:00,188 p=1039219 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:23:00,842 p=1039219 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:23:00,843 p=1039219 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 20:23:02,979 p=1039219 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:23:02,980 p=1039219 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 20:23:03,063 p=1039219 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:03,654 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:03,655 p=1039219 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:04,033 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:04,034 p=1039219 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:05,475 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:05,476 p=1039219 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:08,515 p=1039219 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:23:08,516 p=1039219 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 20:23:09,112 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:09,114 p=1039219 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 20:23:09,204 p=1039219 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:09,854 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:09,855 p=1039219 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:11,443 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:11,444 p=1039219 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:14,014 p=1039219 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:23:14,015 p=1039219 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:14,045 p=1039219 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the nodes] ***************************************************************************************************************************************************************************************************
2025-02-22 20:23:14,762 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:14,878 p=1039219 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:23:14,879 p=1039219 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:16,504 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:16,664 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:16,665 p=1039219 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 20:23:17,024 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:17,032 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:17,294 p=1039219 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 20:23:17,653 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:17,687 p=1039219 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:23:17,688 p=1039219 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 20:23:19,695 p=1039219 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:23:19,791 p=1039219 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:23:19,792 p=1039219 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:20,836 p=1039219 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:23:22,362 p=1039219 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:23:22,362 p=1039219 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 20:23:22,460 p=1039219 u=digitd n=ansible INFO| db.master.lan              : ok=16   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:23:22,560 p=1039219 u=digitd n=ansible INFO| db.slave.lan               : ok=11   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:23:22,635 p=1039219 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:23:22,668 p=1039219 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:32:39,286 p=1058044 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 20:32:39,290 p=1058044 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 20:32:41,065 p=1058044 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:32:41,066 p=1058044 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:32:42,375 p=1058044 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:32:42,376 p=1058044 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:32:42,408 p=1058044 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 20:32:44,343 p=1058044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:32:45,366 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:32:45,367 p=1058044 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 20:32:46,311 p=1058044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:32:46,675 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:32:46,676 p=1058044 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 20:32:46,707 p=1058044 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:32:47,092 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:32:47,093 p=1058044 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 20:32:47,466 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:32:47,467 p=1058044 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 20:32:52,196 p=1058044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:32:52,197 p=1058044 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 20:32:52,232 p=1058044 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 20:32:52,991 p=1058044 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:32:53,130 p=1058044 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 20:32:53,130 p=1058044 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:32:54,192 p=1058044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:32:54,278 p=1058044 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 20:32:54,279 p=1058044 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:32:54,315 p=1058044 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:32:54,931 p=1058044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:32:54,932 p=1058044 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 20:32:56,995 p=1058044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:32:56,996 p=1058044 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:32:57,040 p=1058044 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:32:57,680 p=1058044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:32:57,681 p=1058044 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 20:32:59,834 p=1058044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:32:59,835 p=1058044 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 20:32:59,865 p=1058044 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:00,521 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:00,522 p=1058044 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:00,924 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:00,926 p=1058044 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:02,585 p=1058044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:02,586 p=1058044 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:06,381 p=1058044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:06,382 p=1058044 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 20:33:07,006 p=1058044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:07,008 p=1058044 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 20:33:07,097 p=1058044 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:07,865 p=1058044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:07,866 p=1058044 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:08,633 p=1058044 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-22 20:33:17,745 p=1059714 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 20:33:17,749 p=1059714 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:19,197 p=1059714 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:33:19,198 p=1059714 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:20,366 p=1059714 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:33:20,367 p=1059714 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:33:20,413 p=1059714 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:21,958 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:22,058 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:22,059 p=1059714 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:22,945 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:23,067 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:23,068 p=1059714 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 20:33:23,096 p=1059714 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:33:23,469 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:23,470 p=1059714 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 20:33:23,820 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:23,821 p=1059714 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 20:33:28,820 p=1059714 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:28,822 p=1059714 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 20:33:28,855 p=1059714 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 20:33:29,591 p=1059714 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 20:33:29,720 p=1059714 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:33:29,721 p=1059714 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:30,800 p=1059714 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 20:33:30,805 p=1059714 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:33:30,837 p=1059714 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:33:30,871 p=1059714 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:33:31,565 p=1059714 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:33:31,567 p=1059714 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 20:33:33,547 p=1059714 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:33:33,548 p=1059714 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:33:33,603 p=1059714 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:33:34,256 p=1059714 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:33:34,257 p=1059714 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 20:33:36,390 p=1059714 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:33:36,391 p=1059714 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 20:33:36,428 p=1059714 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:37,072 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:37,073 p=1059714 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:37,452 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:37,453 p=1059714 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:38,904 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:38,905 p=1059714 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:41,732 p=1059714 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:41,733 p=1059714 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 20:33:42,308 p=1059714 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:42,309 p=1059714 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 20:33:42,428 p=1059714 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:43,097 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:43,099 p=1059714 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:44,623 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:44,624 p=1059714 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:47,675 p=1059714 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:33:47,676 p=1059714 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:47,702 p=1059714 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************
2025-02-22 20:33:48,441 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:48,666 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:48,667 p=1059714 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:48,702 p=1059714 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************
2025-02-22 20:33:49,362 p=1059714 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:33:49,564 p=1059714 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:49,565 p=1059714 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:49,594 p=1059714 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:51,191 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:51,254 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:51,255 p=1059714 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 20:33:51,654 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:51,659 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:51,693 p=1059714 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 20:33:52,032 p=1059714 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:52,070 p=1059714 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:33:52,072 p=1059714 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 20:33:54,065 p=1059714 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:33:54,217 p=1059714 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:33:54,218 p=1059714 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:55,227 p=1059714 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:33:56,871 p=1059714 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:33:56,872 p=1059714 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:57,680 p=1059714 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": true, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "status"], "delta": "0:00:00.262191", "end": "2025-02-22 20:33:57.660315", "msg": "non-zero return code", "rc": 2, "start": "2025-02-22 20:33:57.398124", "stderr": "Usage: patronictl [OPTIONS] COMMAND [ARGS]...\nTry 'patronictl --help' for help.\n\nError: No such command 'status'.", "stderr_lines": ["Usage: patronictl [OPTIONS] COMMAND [ARGS]...", "Try 'patronictl --help' for help.", "", "Error: No such command 'status'."], "stdout": "", "stdout_lines": []}
2025-02-22 20:33:57,821 p=1059714 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": true, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "status"], "delta": "0:00:00.442167", "end": "2025-02-22 20:33:57.794614", "msg": "non-zero return code", "rc": 2, "start": "2025-02-22 20:33:57.352447", "stderr": "Usage: patronictl [OPTIONS] COMMAND [ARGS]...\nTry 'patronictl --help' for help.\n\nError: No such command 'status'.", "stderr_lines": ["Usage: patronictl [OPTIONS] COMMAND [ARGS]...", "Try 'patronictl --help' for help.", "", "Error: No such command 'status'."], "stdout": "", "stdout_lines": []}
2025-02-22 20:33:57,822 p=1059714 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 20:33:57,922 p=1059714 u=digitd n=ansible INFO| db.master.lan              : ok=17   changed=6    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 20:33:58,067 p=1059714 u=digitd n=ansible INFO| db.slave.lan               : ok=12   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 20:33:58,192 p=1059714 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:33:58,258 p=1059714 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:40:54,272 p=1074803 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 20:40:54,277 p=1074803 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 20:40:56,038 p=1074803 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:40:56,039 p=1074803 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:40:57,198 p=1074803 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:40:57,199 p=1074803 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:40:57,293 p=1074803 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 20:40:59,302 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:40:59,357 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:40:59,357 p=1074803 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:00,344 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:00,387 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:00,389 p=1074803 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 20:41:00,417 p=1074803 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:41:00,843 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:00,844 p=1074803 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 20:41:01,227 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:01,227 p=1074803 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 20:41:06,167 p=1074803 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:41:06,169 p=1074803 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 20:41:06,209 p=1074803 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 20:41:06,987 p=1074803 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:41:07,136 p=1074803 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 20:41:07,137 p=1074803 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:08,133 p=1074803 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:41:08,253 p=1074803 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 20:41:08,255 p=1074803 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:41:08,283 p=1074803 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:41:08,974 p=1074803 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:41:08,975 p=1074803 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 20:41:10,999 p=1074803 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:41:11,001 p=1074803 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:41:11,033 p=1074803 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:41:11,633 p=1074803 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:41:11,634 p=1074803 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 20:41:13,702 p=1074803 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:41:13,703 p=1074803 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 20:41:13,750 p=1074803 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:14,426 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:14,427 p=1074803 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:14,870 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:14,871 p=1074803 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:16,230 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:16,231 p=1074803 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:18,617 p=1074803 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:41:18,618 p=1074803 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 20:41:19,289 p=1074803 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:41:19,290 p=1074803 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 20:41:19,349 p=1074803 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:20,047 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:20,048 p=1074803 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:21,625 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:21,626 p=1074803 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:24,387 p=1074803 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:41:24,388 p=1074803 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:24,424 p=1074803 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************
2025-02-22 20:41:25,081 p=1074803 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:41:25,140 p=1074803 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:41:25,141 p=1074803 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:25,174 p=1074803 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************
2025-02-22 20:41:25,755 p=1074803 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:41:25,847 p=1074803 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:41:25,848 p=1074803 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:25,882 p=1074803 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:27,383 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:27,479 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:27,479 p=1074803 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 20:41:27,831 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:27,831 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:27,865 p=1074803 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 20:41:28,200 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:28,250 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:28,251 p=1074803 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 20:41:30,355 p=1074803 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:41:30,401 p=1074803 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:41:30,402 p=1074803 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:31,335 p=1074803 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:41:31,572 p=1074803 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:41:31,573 p=1074803 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:32,326 p=1074803 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "status"], "delta": "0:00:00.340580", "end": "2025-02-22 20:41:32.272903", "msg": "non-zero return code", "rc": 2, "start": "2025-02-22 20:41:31.932323", "stderr": "Usage: patronictl [OPTIONS] COMMAND [ARGS]...\nTry 'patronictl --help' for help.\n\nError: No such command 'status'.", "stderr_lines": ["Usage: patronictl [OPTIONS] COMMAND [ARGS]...", "Try 'patronictl --help' for help.", "", "Error: No such command 'status'."], "stdout": "", "stdout_lines": []}
2025-02-22 20:41:32,488 p=1074803 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "status"], "delta": "0:00:00.386492", "end": "2025-02-22 20:41:32.454255", "msg": "non-zero return code", "rc": 2, "start": "2025-02-22 20:41:32.067763", "stderr": "Usage: patronictl [OPTIONS] COMMAND [ARGS]...\nTry 'patronictl --help' for help.\n\nError: No such command 'status'.", "stderr_lines": ["Usage: patronictl [OPTIONS] COMMAND [ARGS]...", "Try 'patronictl --help' for help.", "", "Error: No such command 'status'."], "stdout": "", "stdout_lines": []}
2025-02-22 20:41:32,488 p=1074803 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 20:41:32,530 p=1074803 u=digitd n=ansible INFO| db.master.lan              : ok=17   changed=6    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 20:41:32,613 p=1074803 u=digitd n=ansible INFO| db.slave.lan               : ok=12   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-22 20:41:32,663 p=1074803 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:41:32,705 p=1074803 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:48:39,539 p=1088705 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 20:48:39,543 p=1088705 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 20:48:41,350 p=1088705 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:48:41,351 p=1088705 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:48:42,649 p=1088705 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:48:42,651 p=1088705 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:48:42,687 p=1088705 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 20:48:44,414 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:48:44,940 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:48:44,940 p=1088705 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 20:48:45,976 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:48:46,026 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:48:46,027 p=1088705 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 20:48:46,062 p=1088705 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 20:48:46,563 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:48:46,564 p=1088705 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 20:48:47,223 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:48:47,224 p=1088705 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 20:48:52,684 p=1088705 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:48:52,686 p=1088705 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 20:48:52,720 p=1088705 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 20:48:53,489 p=1088705 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 20:48:53,593 p=1088705 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 20:48:53,594 p=1088705 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:48:54,559 p=1088705 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:48:54,639 p=1088705 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 20:48:54,640 p=1088705 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:48:54,703 p=1088705 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:48:55,435 p=1088705 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:48:55,436 p=1088705 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 20:48:57,499 p=1088705 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:48:57,500 p=1088705 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 20:48:57,536 p=1088705 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 20:48:58,229 p=1088705 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:48:58,230 p=1088705 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 20:49:00,231 p=1088705 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 20:49:00,232 p=1088705 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 20:49:00,285 p=1088705 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:00,930 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:00,931 p=1088705 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:01,311 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:01,312 p=1088705 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:02,938 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:02,939 p=1088705 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:06,556 p=1088705 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:49:06,557 p=1088705 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 20:49:07,138 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:07,140 p=1088705 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 20:49:07,235 p=1088705 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:07,926 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:49:07,926 p=1088705 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:09,315 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:49:09,316 p=1088705 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:11,811 p=1088705 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:49:11,812 p=1088705 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:11,851 p=1088705 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************
2025-02-22 20:49:12,588 p=1088705 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:49:12,676 p=1088705 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:49:12,677 p=1088705 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:12,768 p=1088705 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************
2025-02-22 20:49:13,412 p=1088705 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:49:13,483 p=1088705 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:49:13,484 p=1088705 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:13,518 p=1088705 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:15,067 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:49:15,234 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:15,235 p=1088705 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 20:49:15,587 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:49:15,588 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:15,800 p=1088705 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 20:49:16,138 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:16,186 p=1088705 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:49:16,187 p=1088705 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 20:49:18,269 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:49:18,884 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:18,885 p=1088705 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:19,860 p=1088705 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 20:49:21,258 p=1088705 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 20:49:21,259 p=1088705 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:22,368 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 20:49:22,913 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 20:49:22,914 p=1088705 u=digitd n=ansible INFO| TASK [Print it] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:23,023 p=1088705 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "out.stdout": "+ Cluster: postgres_cluster -+---------+---------+----+-----------+\n| Member | Host              | Role    | State   | TL | Lag in MB |\n+--------+-------------------+---------+---------+----+-----------+\n| slave  | 192.168.2.16:5050 | Replica | stopped |    |   unknown |\n+--------+-------------------+---------+---------+----+-----------+"
}
2025-02-22 20:49:23,074 p=1088705 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "out.stdout": "+ Cluster: postgres_cluster -+---------+---------+----+-----------+\n| Member | Host              | Role    | State   | TL | Lag in MB |\n+--------+-------------------+---------+---------+----+-----------+\n| slave  | 192.168.2.16:5050 | Replica | stopped |    |   unknown |\n+--------+-------------------+---------+---------+----+-----------+"
}
2025-02-22 20:49:23,115 p=1088705 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 20:49:23,157 p=1088705 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:49:23,182 p=1088705 u=digitd n=ansible INFO| db.slave.lan               : ok=14   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:49:23,273 p=1088705 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 20:49:23,348 p=1088705 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:01:03,182 p=1111473 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 21:01:03,186 p=1111473 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 21:01:05,397 p=1111473 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:01:05,398 p=1111473 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 21:01:06,951 p=1111473 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:01:06,952 p=1111473 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 21:01:07,094 p=1111473 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 21:01:09,010 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:01:13,869 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:01:13,870 p=1111473 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 21:01:18,558 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:01:19,742 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:01:19,743 p=1111473 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 21:01:20,239 p=1111473 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 21:01:22,257 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:01:22,258 p=1111473 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 21:01:23,573 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:01:23,574 p=1111473 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 21:01:48,723 p=1111473 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:01:48,724 p=1111473 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 21:01:51,318 p=1111473 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 21:01:53,598 p=1111473 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:01:54,176 p=1111473 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 21:01:54,177 p=1111473 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 21:01:56,519 p=1111473 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:01:56,713 p=1111473 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 21:01:56,714 p=1111473 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 21:01:56,932 p=1111473 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 21:01:59,022 p=1111473 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:01:59,023 p=1111473 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 21:02:02,220 p=1111473 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:02:02,222 p=1111473 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 21:02:02,443 p=1111473 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 21:02:03,522 p=1111473 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:02:03,523 p=1111473 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 21:02:06,298 p=1111473 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:02:06,299 p=1111473 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 21:02:07,659 p=1111473 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:09,940 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:02:09,941 p=1111473 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:11,237 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:02:11,238 p=1111473 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:14,003 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:02:14,004 p=1111473 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:31,172 p=1111473 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:02:31,173 p=1111473 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 21:02:35,136 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:02:35,137 p=1111473 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 21:02:35,470 p=1111473 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:37,424 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:02:37,425 p=1111473 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:39,941 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:02:39,942 p=1111473 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:48,706 p=1111473 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:02:48,707 p=1111473 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:49,632 p=1111473 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************
2025-02-22 21:02:52,242 p=1111473 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:02:53,030 p=1111473 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:02:53,031 p=1111473 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 21:02:53,535 p=1111473 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************
2025-02-22 21:02:55,284 p=1111473 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:02:55,800 p=1111473 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:02:55,801 p=1111473 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 21:03:01,271 p=1111473 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 21:03:03,986 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:03:04,709 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:03:04,710 p=1111473 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 21:03:06,310 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:03:06,958 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:03:06,959 p=1111473 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 21:03:08,176 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:03:08,920 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:03:08,922 p=1111473 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 21:03:12,507 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:03:13,006 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:03:13,008 p=1111473 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:03:15,062 p=1111473 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:03:45,274 p=1111473 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:03:45,275 p=1111473 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************
2025-02-22 21:03:48,433 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:03:48,435 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:03:48,936 p=1111473 u=digitd n=ansible INFO| TASK [Print it] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 21:03:50,314 p=1111473 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "out.stdout": "+ Cluster: cluster ----------+--------+---------+----+-----------+\n| Member | Host              | Role   | State   | TL | Lag in MB |\n+--------+-------------------+--------+---------+----+-----------+\n| slave  | 192.168.2.16:5050 | Leader | running |  1 |           |\n+--------+-------------------+--------+---------+----+-----------+"
}
2025-02-22 21:03:50,846 p=1111473 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "out.stdout": "+ Cluster: cluster ----------+--------+---------+----+-----------+\n| Member | Host              | Role   | State   | TL | Lag in MB |\n+--------+-------------------+--------+---------+----+-----------+\n| slave  | 192.168.2.16:5050 | Leader | running |  1 |           |\n+--------+-------------------+--------+---------+----+-----------+"
}
2025-02-22 21:03:51,846 p=1111473 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:03:52,806 p=1111473 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:03:53,170 p=1111473 u=digitd n=ansible INFO| db.slave.lan               : ok=14   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:03:53,420 p=1111473 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:03:53,629 p=1111473 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:04:35,113 p=1118833 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************
2025-02-22 21:04:35,116 p=1118833 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************
2025-02-22 21:04:38,163 p=1118833 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:04:38,164 p=1118833 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************
2025-02-22 21:04:43,645 p=1118833 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:04:43,646 p=1118833 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************
2025-02-22 21:04:44,341 p=1118833 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************
2025-02-22 21:04:47,010 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:04:47,790 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:04:47,791 p=1118833 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************
2025-02-22 21:04:50,245 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:04:50,858 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:04:50,859 p=1118833 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************
2025-02-22 21:04:51,325 p=1118833 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************
2025-02-22 21:04:52,884 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:04:52,885 p=1118833 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************
2025-02-22 21:04:54,352 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:04:54,353 p=1118833 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************
2025-02-22 21:05:33,191 p=1118833 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:05:33,192 p=1118833 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************
2025-02-22 21:05:33,835 p=1118833 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 21:05:35,855 p=1118833 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:05:36,422 p=1118833 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 21:05:36,423 p=1118833 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************
2025-02-22 21:05:39,014 p=1118833 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:05:40,105 p=1118833 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 21:05:40,106 p=1118833 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 21:05:40,880 p=1118833 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 21:05:42,870 p=1118833 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:05:42,871 p=1118833 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************
2025-02-22 21:05:46,437 p=1118833 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:05:46,438 p=1118833 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************
2025-02-22 21:05:51,295 p=1118833 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************
2025-02-22 21:05:53,316 p=1118833 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:05:53,317 p=1118833 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************
2025-02-22 21:05:57,864 p=1118833 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:05:57,866 p=1118833 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************
2025-02-22 21:05:58,352 p=1118833 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:00,545 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:06:00,546 p=1118833 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:01,855 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:06:01,857 p=1118833 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:04,761 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:06:04,762 p=1118833 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:25,954 p=1118833 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:06:25,956 p=1118833 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************
2025-02-22 21:06:31,626 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:06:31,627 p=1118833 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************
2025-02-22 21:06:32,267 p=1118833 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:34,290 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:06:34,291 p=1118833 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:36,843 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:06:36,844 p=1118833 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:52,686 p=1118833 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:06:52,687 p=1118833 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:53,391 p=1118833 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************
2025-02-22 21:06:55,880 p=1118833 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:06:55,882 p=1118833 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:56,798 p=1118833 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************
2025-02-22 21:06:58,431 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:06:58,432 p=1118833 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************
2025-02-22 21:06:58,715 p=1118833 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************
2025-02-22 21:07:00,653 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:07:01,302 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:07:01,303 p=1118833 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************
2025-02-22 21:07:02,237 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:07:02,238 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:07:02,809 p=1118833 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************
2025-02-22 21:07:03,688 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:07:03,938 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:07:03,939 p=1118833 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************
2025-02-22 21:07:08,543 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:07:09,372 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:07:09,373 p=1118833 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:07:14,522 p=1118833 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:07:24,185 p=1118833 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:07:24,186 p=1118833 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************
2025-02-22 21:07:28,687 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:07:29,756 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:07:29,757 p=1118833 u=digitd n=ansible INFO| TASK [Print it] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 21:07:30,286 p=1118833 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "out.stdout": "+ Cluster: cluster ----------+---------+---------+----+-----------+\n| Member | Host              | Role    | State   | TL | Lag in MB |\n+--------+-------------------+---------+---------+----+-----------+\n| master | 192.168.2.16:5050 | Replica | stopped |    |   unknown |\n| slave  | 192.168.2.16:5050 | Leader  | stopped |    |           |\n+--------+-------------------+---------+---------+----+-----------+"
}
2025-02-22 21:07:30,436 p=1118833 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "out.stdout": "+ Cluster: cluster ----------+---------+---------+----+-----------+\n| Member | Host              | Role    | State   | TL | Lag in MB |\n+--------+-------------------+---------+---------+----+-----------+\n| master | 192.168.2.16:5050 | Replica | stopped |    |   unknown |\n| slave  | 192.168.2.16:5050 | Leader  | stopped |    |           |\n+--------+-------------------+---------+---------+----+-----------+"
}
2025-02-22 21:07:30,436 p=1118833 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:07:30,436 p=1118833 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:07:30,436 p=1118833 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:07:30,436 p=1118833 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:07:30,436 p=1118833 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:49:22,343 p=1200889 u=digitd n=ansible ERROR| ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  found unacceptable key (unhashable type: 'AnsibleMapping'). while constructing a mapping
  in "<unicode string>", line 268, column 14
found unacceptable key (unhashable type: 'AnsibleMapping')
  in "<unicode string>", line 268, column 15

The error appears to be in '/run/media/digitd/NFS/git/travelata_test/ansible/start_services.yml': line 268, column 15, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

      ansible.builtin.debug:
        var: {{ out.stdout_lines }}
              ^ here
We could be wrong, but this one looks like it might be an issue with
missing quotes. Always quote template expression brackets when they
start a value. For instance:

    with_items:
      - {{ foo }}

Should be written as:

    with_items:
      - "{{ foo }}"

2025-02-22 21:49:39,440 p=1201575 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:39,444 p=1201575 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:41,349 p=1201575 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:49:41,351 p=1201575 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:42,630 p=1201575 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:49:42,631 p=1201575 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:42,745 p=1201575 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:44,695 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:49:45,628 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:49:45,629 p=1201575 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:46,952 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:49:47,090 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:49:47,092 p=1201575 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:47,203 p=1201575 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:47,630 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:49:47,632 p=1201575 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:48,057 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:49:48,058 p=1201575 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:55,715 p=1201575 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:49:55,716 p=1201575 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************************************************
2025-02-22 21:49:55,828 p=1201575 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:56,669 p=1201575 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:49:56,822 p=1201575 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 21:49:56,823 p=1201575 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:58,026 p=1201575 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 21:49:58,277 p=1201575 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:49:58,278 p=1201575 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:58,852 p=1201575 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:49:59,919 p=1201575 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:49:59,920 p=1201575 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:02,080 p=1201575 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:50:02,081 p=1201575 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:03,143 p=1201575 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:04,092 p=1201575 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:50:04,093 p=1201575 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:06,406 p=1201575 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:50:06,407 p=1201575 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:06,460 p=1201575 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:07,257 p=1201575 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:50:07,258 p=1201575 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:07,654 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:50:07,655 p=1201575 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:09,360 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:50:09,361 p=1201575 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:13,379 p=1201575 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:50:13,380 p=1201575 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:14,502 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:50:14,504 p=1201575 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:14,651 p=1201575 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:15,511 p=1201575 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:50:15,511 p=1201575 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:17,234 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:50:17,235 p=1201575 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:20,164 p=1201575 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:50:20,165 p=1201575 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***********************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:20,334 p=1201575 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:21,098 p=1201575 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:50:21,099 p=1201575 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:21,359 p=1201575 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:21,979 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:50:21,980 p=1201575 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:22,076 p=1201575 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:50:23,746 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:52:40,423 p=1201575 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:52:40,425 p=1201575 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:42,149 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:52:42,383 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:52:42,385 p=1201575 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:43,016 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:52:43,082 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:52:43,083 p=1201575 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:45,298 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:52:46,436 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:52:46,437 p=1201575 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:49,639 p=1201575 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:52:52,486 p=1201575 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:52:52,487 p=1201575 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:54,084 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:52:54,350 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:52:54,352 p=1201575 u=digitd n=ansible INFO| TASK [Print it] *******************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:54,505 p=1201575 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "<class 'list'>": "VARIABLE IS NOT DEFINED!"
}
2025-02-22 21:52:54,611 p=1201575 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "<class 'list'>": "VARIABLE IS NOT DEFINED!"
}
2025-02-22 21:52:54,611 p=1201575 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:52:54,727 p=1201575 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:52:54,728 p=1201575 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:52:54,728 p=1201575 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:52:54,728 p=1201575 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:53:46,041 p=1209310 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ********************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:46,045 p=1209310 u=digitd n=ansible INFO| TASK [Install HAProxy] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:47,968 p=1209310 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:53:47,969 p=1209310 u=digitd n=ansible INFO| TASK [Check service status] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:49,338 p=1209310 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:53:49,339 p=1209310 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ****************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:49,441 p=1209310 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:50,943 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:53:51,249 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:53:51,250 p=1209310 u=digitd n=ansible INFO| TASK [Check service] **************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:52,367 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:53:52,752 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:53:52,754 p=1209310 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] **************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:52,791 p=1209310 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ****************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:53,286 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:53:53,287 p=1209310 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:53:53,682 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:53:53,683 p=1209310 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:00,756 p=1209310 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:54:00,758 p=1209310 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ******************************************************************************************************************************************************************************************
2025-02-22 21:54:00,798 p=1209310 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:01,638 p=1209310 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 21:54:01,763 p=1209310 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 21:54:01,764 p=1209310 u=digitd n=ansible INFO| TASK [Restart haproxy service] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:02,830 p=1209310 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:54:02,941 p=1209310 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 21:54:02,942 p=1209310 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:02,981 p=1209310 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:03,872 p=1209310 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:54:03,873 p=1209310 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:06,025 p=1209310 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:54:06,026 p=1209310 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:06,064 p=1209310 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:06,658 p=1209310 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:54:06,659 p=1209310 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ********************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:09,453 p=1209310 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 21:54:09,454 p=1209310 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:09,498 p=1209310 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:10,184 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:10,185 p=1209310 u=digitd n=ansible INFO| TASK [Create data directory] ******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:10,633 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:10,634 p=1209310 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:12,666 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:12,666 p=1209310 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:15,847 p=1209310 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:54:15,848 p=1209310 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:16,570 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:16,572 p=1209310 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:16,639 p=1209310 u=digitd n=ansible INFO| TASK [Copy etcd file] *************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:17,367 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:17,368 p=1209310 u=digitd n=ansible INFO| TASK [Install etcd] ***************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:19,620 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:19,621 p=1209310 u=digitd n=ansible INFO| TASK [Restart etcd service] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:22,409 p=1209310 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:54:22,410 p=1209310 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***********************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:22,530 p=1209310 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] **************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:23,230 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:23,231 p=1209310 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:23,313 p=1209310 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:23,972 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:23,974 p=1209310 u=digitd n=ansible INFO| PLAY [Configure Patroni] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:24,021 p=1209310 u=digitd n=ansible INFO| TASK [Install patroni package] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:25,668 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:25,746 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:25,747 p=1209310 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:26,093 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:26,199 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:26,200 p=1209310 u=digitd n=ansible INFO| TASK [Create data directory for database] *****************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:26,545 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:26,597 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:26,598 p=1209310 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ******************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:28,636 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:28,703 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:28,704 p=1209310 u=digitd n=ansible INFO| TASK [Start services] *************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:29,714 p=1209310 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 21:54:32,459 p=1209310 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 21:54:32,460 p=1209310 u=digitd n=ansible INFO| TASK [Get patronictl status] ******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:34,319 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 21:54:34,756 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 21:54:34,757 p=1209310 u=digitd n=ansible INFO| TASK [Print it] *******************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:34,844 p=1209310 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: cluster ----------+---------+---------+----+-----------+",
        "| Member | Host              | Role    | State   | TL | Lag in MB |",
        "+--------+-------------------+---------+---------+----+-----------+",
        "| master | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slave  | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "+--------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 21:54:34,886 p=1209310 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: cluster ----------+---------+---------+----+-----------+",
        "| Member | Host              | Role    | State   | TL | Lag in MB |",
        "+--------+-------------------+---------+---------+----+-----------+",
        "| master | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slave  | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "+--------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 21:54:34,886 p=1209310 u=digitd n=ansible INFO| PLAY RECAP ************************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 21:54:34,994 p=1209310 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:54:34,994 p=1209310 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:54:34,994 p=1209310 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 21:54:34,994 p=1209310 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 22:50:27,296 p=1311358 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *****************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:27,300 p=1311358 u=digitd n=ansible INFO| TASK [Install HAProxy] *********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:29,089 p=1311358 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 22:50:29,090 p=1311358 u=digitd n=ansible INFO| TASK [Check service status] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:30,400 p=1311358 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 22:50:30,401 p=1311358 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:30,501 p=1311358 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:32,286 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:50:33,611 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:33,612 p=1311358 u=digitd n=ansible INFO| TASK [Check service] ***********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:34,849 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:50:35,028 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:35,029 p=1311358 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:35,076 p=1311358 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:35,499 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:35,500 p=1311358 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:36,055 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:36,056 p=1311358 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:42,038 p=1311358 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 22:50:42,040 p=1311358 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ***************************************************************************************************************************************************************************************
2025-02-22 22:50:42,075 p=1311358 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] **********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:42,852 p=1311358 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 22:50:43,036 p=1311358 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 22:50:43,037 p=1311358 u=digitd n=ansible INFO| TASK [Restart haproxy service] *************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:44,084 p=1311358 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 22:50:44,136 p=1311358 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 22:50:44,138 p=1311358 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:44,175 p=1311358 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:44,865 p=1311358 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 22:50:44,866 p=1311358 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:46,850 p=1311358 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 22:50:46,851 p=1311358 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:46,900 p=1311358 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:47,455 p=1311358 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 22:50:47,456 p=1311358 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:49,679 p=1311358 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 22:50:49,681 p=1311358 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:49,716 p=1311358 u=digitd n=ansible INFO| TASK [Copy etcd file] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:50,423 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:50,424 p=1311358 u=digitd n=ansible INFO| TASK [Create data directory] ***************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:50,796 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:50,797 p=1311358 u=digitd n=ansible INFO| TASK [Install etcd] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:52,299 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:52,300 p=1311358 u=digitd n=ansible INFO| TASK [Restart etcd service] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:56,629 p=1311358 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 22:50:56,630 p=1311358 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] *********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:57,237 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:50:57,238 p=1311358 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ****************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:57,332 p=1311358 u=digitd n=ansible INFO| TASK [Copy etcd file] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:58,014 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:50:58,015 p=1311358 u=digitd n=ansible INFO| TASK [Install etcd] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:50:59,423 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:50:59,424 p=1311358 u=digitd n=ansible INFO| TASK [Restart etcd service] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:02,477 p=1311358 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 22:51:02,478 p=1311358 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ********************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:02,523 p=1311358 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:03,314 p=1311358 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 22:51:03,314 p=1311358 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] *********************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:03,357 p=1311358 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] **********************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:04,060 p=1311358 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 22:51:04,061 p=1311358 u=digitd n=ansible INFO| PLAY [Configure Patroni] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:04,099 p=1311358 u=digitd n=ansible INFO| TASK [Install patroni package] *************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:05,702 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:51:05,711 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:51:05,739 p=1311358 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] **********************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:06,082 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:51:06,137 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:51:06,138 p=1311358 u=digitd n=ansible INFO| TASK [Create data directory for database] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:06,644 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:51:06,653 p=1311358 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 22:51:06,756 p=1311358 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ***************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:08,792 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:51:08,909 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:51:08,910 p=1311358 u=digitd n=ansible INFO| TASK [Start services] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:09,853 p=1311358 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 22:51:12,356 p=1311358 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 22:51:12,357 p=1311358 u=digitd n=ansible INFO| TASK [Get patronictl status] ***************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:13,708 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 22:51:14,103 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 22:51:14,104 p=1311358 u=digitd n=ansible INFO| TASK [Print it] ****************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:14,206 p=1311358 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: cluster ------------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| master   | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 22:51:14,271 p=1311358 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: cluster ------------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| master   | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 22:51:14,272 p=1311358 u=digitd n=ansible INFO| PLAY RECAP *********************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 22:51:14,354 p=1311358 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 22:51:14,354 p=1311358 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 22:51:14,355 p=1311358 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 22:51:14,355 p=1311358 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:03:25,064 p=1334860 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] *****************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:25,069 p=1334860 u=digitd n=ansible INFO| TASK [Install HAProxy] *********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:26,858 p=1334860 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:03:26,859 p=1334860 u=digitd n=ansible INFO| TASK [Check service status] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:28,078 p=1334860 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:03:28,079 p=1334860 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:28,104 p=1334860 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:29,827 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:03:30,380 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:30,381 p=1334860 u=digitd n=ansible INFO| TASK [Check service] ***********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:31,318 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:31,373 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:03:31,375 p=1334860 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:31,420 p=1334860 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:31,838 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:31,839 p=1334860 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:32,206 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:32,207 p=1334860 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:37,791 p=1334860 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:03:37,792 p=1334860 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] ***************************************************************************************************************************************************************************************
2025-02-22 23:03:37,829 p=1334860 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] **********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:38,632 p=1334860 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:03:38,802 p=1334860 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 23:03:38,803 p=1334860 u=digitd n=ansible INFO| TASK [Restart haproxy service] *************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:39,939 p=1334860 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:03:39,939 p=1334860 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 23:03:39,970 p=1334860 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:40,003 p=1334860 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:40,611 p=1334860 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:03:40,612 p=1334860 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:42,641 p=1334860 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:03:42,642 p=1334860 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:42,678 p=1334860 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:43,304 p=1334860 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:03:43,305 p=1334860 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:45,461 p=1334860 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:03:45,463 p=1334860 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] ***************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:45,502 p=1334860 u=digitd n=ansible INFO| TASK [Copy etcd file] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:46,140 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:46,141 p=1334860 u=digitd n=ansible INFO| TASK [Create data directory] ***************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:46,616 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:46,617 p=1334860 u=digitd n=ansible INFO| TASK [Install etcd] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:48,158 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:48,159 p=1334860 u=digitd n=ansible INFO| TASK [Restart etcd service] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:51,017 p=1334860 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:03:51,019 p=1334860 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] *********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:51,627 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:51,628 p=1334860 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:51,677 p=1334860 u=digitd n=ansible INFO| TASK [Copy etcd file] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:52,380 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:03:52,381 p=1334860 u=digitd n=ansible INFO| TASK [Install etcd] ************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:53,886 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:03:53,887 p=1334860 u=digitd n=ansible INFO| TASK [Restart etcd service] ****************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:56,782 p=1334860 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:03:56,783 p=1334860 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ********************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:56,827 p=1334860 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:57,552 p=1334860 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:03:57,553 p=1334860 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] *********************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:57,593 p=1334860 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:58,312 p=1334860 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:03:58,313 p=1334860 u=digitd n=ansible INFO| PLAY [Configure Patroni] *******************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:58,351 p=1334860 u=digitd n=ansible INFO| TASK [Install patroni package] *************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:03:59,879 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:03:59,931 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:03:59,932 p=1334860 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] **********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:00,272 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:04:00,322 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:04:00,323 p=1334860 u=digitd n=ansible INFO| TASK [Create data directory for database] **************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:00,709 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:04:00,714 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:04:00,742 p=1334860 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] ***************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:02,893 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:04:02,999 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:04:03,000 p=1334860 u=digitd n=ansible INFO| TASK [Start services] **********************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:03,944 p=1334860 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:04:05,469 p=1334860 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:04:05,470 p=1334860 u=digitd n=ansible INFO| TASK [Get patronictl status] ***************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:07,539 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:04:07,544 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:04:07,626 p=1334860 u=digitd n=ansible INFO| TASK [Print it] ****************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:07,716 p=1334860 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: cluster ------------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 23:04:07,774 p=1334860 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: cluster ------------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 23:04:07,775 p=1334860 u=digitd n=ansible INFO| PLAY RECAP *********************************************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:04:07,841 p=1334860 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:04:07,841 p=1334860 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:04:07,841 p=1334860 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:04:07,841 p=1334860 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:33:55,022 p=1390881 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ************************************************************************************************************************************************************************************************************************
2025-02-22 23:33:55,026 p=1390881 u=digitd n=ansible INFO| TASK [Install HAProxy] ****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:33:56,958 p=1390881 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:33:56,959 p=1390881 u=digitd n=ansible INFO| TASK [Check service status] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:33:58,233 p=1390881 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:33:58,235 p=1390881 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:33:58,268 p=1390881 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:00,108 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:00,745 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:00,746 p=1390881 u=digitd n=ansible INFO| TASK [Check service] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:01,796 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:02,033 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:02,035 p=1390881 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ******************************************************************************************************************************************************************************************************
2025-02-22 23:34:02,076 p=1390881 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:34:02,484 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:02,485 p=1390881 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:34:02,875 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:02,876 p=1390881 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***************************************************************************************************************************************************************************************************************
2025-02-22 23:34:07,958 p=1390881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:34:07,959 p=1390881 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] **********************************************************************************************************************************************************
2025-02-22 23:34:07,993 p=1390881 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:34:08,784 p=1390881 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:34:08,917 p=1390881 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 23:34:08,919 p=1390881 u=digitd n=ansible INFO| TASK [Restart haproxy service] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:10,010 p=1390881 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 23:34:10,116 p=1390881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:34:10,117 p=1390881 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:34:10,159 p=1390881 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:34:10,782 p=1390881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:34:10,783 p=1390881 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ************************************************************************************************************************************************************************************************************
2025-02-22 23:34:12,968 p=1390881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:34:12,969 p=1390881 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:34:13,009 p=1390881 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:34:13,672 p=1390881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:34:13,673 p=1390881 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ************************************************************************************************************************************************************************************************************
2025-02-22 23:34:15,696 p=1390881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:34:15,697 p=1390881 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] **********************************************************************************************************************************************************************************************************
2025-02-22 23:34:15,733 p=1390881 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:16,452 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:16,453 p=1390881 u=digitd n=ansible INFO| TASK [Create data directory] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:16,831 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:16,832 p=1390881 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:18,307 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:18,308 p=1390881 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:22,983 p=1390881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:34:22,984 p=1390881 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ****************************************************************************************************************************************************************************************************************
2025-02-22 23:34:23,697 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:23,698 p=1390881 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ***********************************************************************************************************************************************************************************************************
2025-02-22 23:34:23,758 p=1390881 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:24,438 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:24,439 p=1390881 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:25,966 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:25,967 p=1390881 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:28,320 p=1390881 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:34:28,321 p=1390881 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:28,399 p=1390881 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ******************************************************************************************************************************************************************************************************
2025-02-22 23:34:29,111 p=1390881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:34:29,112 p=1390881 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ****************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:29,166 p=1390881 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *****************************************************************************************************************************************************************************************************
2025-02-22 23:34:29,854 p=1390881 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:34:29,855 p=1390881 u=digitd n=ansible INFO| PLAY [Configure Patroni] **************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:30,215 p=1390881 u=digitd n=ansible INFO| TASK [Install patroni package] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:31,745 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:31,747 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:31,798 p=1390881 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:34:32,268 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:32,320 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:32,321 p=1390881 u=digitd n=ansible INFO| TASK [Create data directory for database] *********************************************************************************************************************************************************************************************************************
2025-02-22 23:34:32,707 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:32,713 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:32,748 p=1390881 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] **********************************************************************************************************************************************************************************************************************
2025-02-22 23:34:34,742 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:34,888 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:34,889 p=1390881 u=digitd n=ansible INFO| TASK [Start services] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:35,890 p=1390881 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:34:39,682 p=1390881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:34:39,683 p=1390881 u=digitd n=ansible INFO| TASK [Get patronictl status] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:40,912 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:34:41,118 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:34:41,120 p=1390881 u=digitd n=ansible INFO| TASK [Print it] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:41,215 p=1390881 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 23:34:41,246 p=1390881 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ---------+---------+---------+----+-----------+",
        "| Member  | Host              | Role    | State   | TL | Lag in MB |",
        "+---------+-------------------+---------+---------+----+-----------+",
        "| slavedb | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+---------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 23:34:41,280 p=1390881 u=digitd n=ansible INFO| PLAY RECAP ****************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:34:41,330 p=1390881 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:34:41,405 p=1390881 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:34:41,455 p=1390881 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:34:41,488 p=1390881 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:45:28,509 p=1412498 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:28,513 p=1412498 u=digitd n=ansible INFO| TASK [Install HAProxy] ****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:30,416 p=1412498 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:45:30,417 p=1412498 u=digitd n=ansible INFO| TASK [Check service status] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:31,706 p=1412498 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:45:31,707 p=1412498 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:45:31,743 p=1412498 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:33,550 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:34,694 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:45:34,695 p=1412498 u=digitd n=ansible INFO| TASK [Check service] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:35,682 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:45:35,889 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:35,890 p=1412498 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ******************************************************************************************************************************************************************************************************
2025-02-22 23:45:35,918 p=1412498 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:45:36,307 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:36,308 p=1412498 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:45:36,660 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:36,661 p=1412498 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***************************************************************************************************************************************************************************************************************
2025-02-22 23:45:41,996 p=1412498 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:45:41,997 p=1412498 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] **********************************************************************************************************************************************************
2025-02-22 23:45:42,035 p=1412498 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:45:42,859 p=1412498 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:45:43,004 p=1412498 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 23:45:43,005 p=1412498 u=digitd n=ansible INFO| TASK [Restart haproxy service] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:44,187 p=1412498 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:45:44,189 p=1412498 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 23:45:44,301 p=1412498 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:45:44,343 p=1412498 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:45:45,009 p=1412498 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:45:45,010 p=1412498 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ************************************************************************************************************************************************************************************************************
2025-02-22 23:45:47,027 p=1412498 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:45:47,028 p=1412498 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:45:47,059 p=1412498 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:45:47,728 p=1412498 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:45:47,729 p=1412498 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ************************************************************************************************************************************************************************************************************
2025-02-22 23:45:49,745 p=1412498 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:45:49,746 p=1412498 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] **********************************************************************************************************************************************************************************************************
2025-02-22 23:45:49,909 p=1412498 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:50,689 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:50,690 p=1412498 u=digitd n=ansible INFO| TASK [Create data directory] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:51,084 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:51,084 p=1412498 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:52,678 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:52,679 p=1412498 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:55,106 p=1412498 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:45:55,107 p=1412498 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ****************************************************************************************************************************************************************************************************************
2025-02-22 23:45:55,892 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:45:55,893 p=1412498 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ***********************************************************************************************************************************************************************************************************
2025-02-22 23:45:55,983 p=1412498 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:56,748 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:45:56,748 p=1412498 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:45:58,251 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:45:58,251 p=1412498 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:01,081 p=1412498 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:46:01,082 p=1412498 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:01,124 p=1412498 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ******************************************************************************************************************************************************************************************************
2025-02-22 23:46:01,774 p=1412498 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:46:01,776 p=1412498 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ****************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:01,807 p=1412498 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *****************************************************************************************************************************************************************************************************
2025-02-22 23:46:02,485 p=1412498 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:46:02,486 p=1412498 u=digitd n=ansible INFO| PLAY [Configure Patroni] **************************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:02,532 p=1412498 u=digitd n=ansible INFO| TASK [Install patroni package] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:04,036 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:46:04,149 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:46:04,150 p=1412498 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:46:04,467 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:46:04,467 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:46:04,507 p=1412498 u=digitd n=ansible INFO| TASK [Create data directory for database] *********************************************************************************************************************************************************************************************************************
2025-02-22 23:46:04,851 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:46:04,901 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:46:04,902 p=1412498 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] **********************************************************************************************************************************************************************************************************************
2025-02-22 23:46:07,036 p=1412498 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:46:08,060 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:46:08,061 p=1412498 u=digitd n=ansible INFO| TASK [Start services] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:09,125 p=1412498 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:46:10,404 p=1412498 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:46:10,406 p=1412498 u=digitd n=ansible INFO| TASK [Get patronictl status] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:46:11,768 p=1412498 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:50:02,792 p=1412498 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-22 23:51:49,294 p=1424666 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ************************************************************************************************************************************************************************************************************************
2025-02-22 23:51:49,298 p=1424666 u=digitd n=ansible INFO| TASK [Install HAProxy] ****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:51:51,007 p=1424666 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:51:51,008 p=1424666 u=digitd n=ansible INFO| TASK [Check service status] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:51:52,292 p=1424666 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:51:52,294 p=1424666 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:51:52,378 p=1424666 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *************************************************************************************************************************************************************************************************************************************
2025-02-22 23:51:54,234 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:51:54,932 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:51:54,933 p=1424666 u=digitd n=ansible INFO| TASK [Check service] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:51:56,001 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:51:56,248 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:51:56,249 p=1424666 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ******************************************************************************************************************************************************************************************************
2025-02-22 23:51:56,337 p=1424666 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:51:56,815 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:51:56,816 p=1424666 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:51:57,195 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:51:57,196 p=1424666 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***************************************************************************************************************************************************************************************************************
2025-02-22 23:52:02,206 p=1424666 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:52:02,208 p=1424666 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] **********************************************************************************************************************************************************
2025-02-22 23:52:02,245 p=1424666 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:52:03,014 p=1424666 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:52:03,162 p=1424666 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 23:52:03,163 p=1424666 u=digitd n=ansible INFO| TASK [Restart haproxy service] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:04,225 p=1424666 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:52:04,281 p=1424666 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 23:52:04,282 p=1424666 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:52:04,311 p=1424666 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:52:04,996 p=1424666 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:52:04,998 p=1424666 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ************************************************************************************************************************************************************************************************************
2025-02-22 23:52:07,078 p=1424666 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:52:07,079 p=1424666 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:52:07,427 p=1424666 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:52:08,112 p=1424666 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:52:08,113 p=1424666 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ************************************************************************************************************************************************************************************************************
2025-02-22 23:52:10,040 p=1424666 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:52:10,041 p=1424666 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] **********************************************************************************************************************************************************************************************************
2025-02-22 23:52:10,110 p=1424666 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:10,882 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:10,883 p=1424666 u=digitd n=ansible INFO| TASK [Create data directory] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:11,289 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:11,290 p=1424666 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:12,902 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:12,904 p=1424666 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:17,855 p=1424666 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:52:17,856 p=1424666 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ****************************************************************************************************************************************************************************************************************
2025-02-22 23:52:18,580 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:18,581 p=1424666 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ***********************************************************************************************************************************************************************************************************
2025-02-22 23:52:18,635 p=1424666 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:19,373 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:52:19,374 p=1424666 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:20,880 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:52:20,880 p=1424666 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:24,462 p=1424666 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:52:24,463 p=1424666 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:24,501 p=1424666 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ******************************************************************************************************************************************************************************************************
2025-02-22 23:52:25,165 p=1424666 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:52:25,166 p=1424666 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ****************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:25,209 p=1424666 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *****************************************************************************************************************************************************************************************************
2025-02-22 23:52:25,872 p=1424666 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:52:25,873 p=1424666 u=digitd n=ansible INFO| PLAY [Configure Patroni] **************************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:25,909 p=1424666 u=digitd n=ansible INFO| TASK [Install patroni package] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:27,399 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:52:27,515 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:27,516 p=1424666 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:52:27,866 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:52:27,919 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:27,920 p=1424666 u=digitd n=ansible INFO| TASK [Create data directory for database] *********************************************************************************************************************************************************************************************************************
2025-02-22 23:52:28,312 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:52:28,318 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:28,350 p=1424666 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] **********************************************************************************************************************************************************************************************************************
2025-02-22 23:52:30,662 p=1424666 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:52:30,953 p=1424666 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:52:30,954 p=1424666 u=digitd n=ansible INFO| TASK [Start services] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:52:32,025 p=1424666 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:52:34,160 p=1424666 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:52:34,161 p=1424666 u=digitd n=ansible INFO| TASK [Get patronictl status] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:53:47,128 p=1424666 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-02-22 23:53:50,854 p=1428881 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ************************************************************************************************************************************************************************************************************************
2025-02-22 23:53:50,858 p=1428881 u=digitd n=ansible INFO| TASK [Install HAProxy] ****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:53:52,608 p=1428881 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:53:52,609 p=1428881 u=digitd n=ansible INFO| TASK [Check service status] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:53:53,872 p=1428881 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:53:53,873 p=1428881 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:53:53,935 p=1428881 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *************************************************************************************************************************************************************************************************************************************
2025-02-22 23:53:55,551 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:53:56,465 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:53:56,466 p=1428881 u=digitd n=ansible INFO| TASK [Check service] ******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:53:57,648 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:53:57,893 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:53:57,895 p=1428881 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ******************************************************************************************************************************************************************************************************
2025-02-22 23:53:57,926 p=1428881 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ********************************************************************************************************************************************************************************************************************
2025-02-22 23:53:58,353 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:53:58,354 p=1428881 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:53:58,735 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:53:58,736 p=1428881 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***************************************************************************************************************************************************************************************************************
2025-02-22 23:54:03,398 p=1428881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:54:03,399 p=1428881 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] **********************************************************************************************************************************************************
2025-02-22 23:54:03,434 p=1428881 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:54:04,203 p=1428881 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-22 23:54:04,295 p=1428881 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-22 23:54:04,296 p=1428881 u=digitd n=ansible INFO| TASK [Restart haproxy service] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:05,312 p=1428881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:54:05,369 p=1428881 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-22 23:54:05,370 p=1428881 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:54:05,409 p=1428881 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:54:06,354 p=1428881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:54:06,355 p=1428881 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ************************************************************************************************************************************************************************************************************
2025-02-22 23:54:08,283 p=1428881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:54:08,284 p=1428881 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-22 23:54:08,318 p=1428881 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-22 23:54:08,970 p=1428881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:54:08,971 p=1428881 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ************************************************************************************************************************************************************************************************************
2025-02-22 23:54:10,984 p=1428881 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-22 23:54:10,985 p=1428881 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] **********************************************************************************************************************************************************************************************************
2025-02-22 23:54:11,034 p=1428881 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:11,673 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:11,674 p=1428881 u=digitd n=ansible INFO| TASK [Create data directory] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:12,001 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:12,002 p=1428881 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:13,657 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:13,658 p=1428881 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:16,524 p=1428881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:54:16,525 p=1428881 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ****************************************************************************************************************************************************************************************************************
2025-02-22 23:54:17,054 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:17,056 p=1428881 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ***********************************************************************************************************************************************************************************************************
2025-02-22 23:54:17,116 p=1428881 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:17,840 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:17,840 p=1428881 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:19,226 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:19,228 p=1428881 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:21,856 p=1428881 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:54:21,857 p=1428881 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:21,908 p=1428881 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ******************************************************************************************************************************************************************************************************
2025-02-22 23:54:23,006 p=1428881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:54:23,007 p=1428881 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ****************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:23,049 p=1428881 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *****************************************************************************************************************************************************************************************************
2025-02-22 23:54:23,693 p=1428881 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:54:23,695 p=1428881 u=digitd n=ansible INFO| PLAY [Configure Patroni] **************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:23,808 p=1428881 u=digitd n=ansible INFO| TASK [Install patroni package] ********************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:25,275 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:25,350 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:25,350 p=1428881 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *****************************************************************************************************************************************************************************************************************
2025-02-22 23:54:25,848 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:26,164 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:26,165 p=1428881 u=digitd n=ansible INFO| TASK [Create data directory for database] *********************************************************************************************************************************************************************************************************************
2025-02-22 23:54:26,633 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:26,677 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:26,678 p=1428881 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] **********************************************************************************************************************************************************************************************************************
2025-02-22 23:54:28,702 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:28,810 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:28,810 p=1428881 u=digitd n=ansible INFO| TASK [Start services] *****************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:29,819 p=1428881 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-22 23:54:29,877 p=1428881 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-22 23:54:29,878 p=1428881 u=digitd n=ansible INFO| TASK [Get patronictl status] **********************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:31,377 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-22 23:54:31,512 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-22 23:54:31,513 p=1428881 u=digitd n=ansible INFO| TASK [Print it] ***********************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:31,572 p=1428881 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ---------+---------+---------+----+-----------+",
        "| Member  | Host              | Role    | State   | TL | Lag in MB |",
        "+---------+-------------------+---------+---------+----+-----------+",
        "| slavedb | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+---------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-22 23:54:31,755 p=1428881 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb --+-------+----+-----------+",
        "| Member | Host | Role | State | TL | Lag in MB |",
        "+--------+------+------+-------+----+-----------+",
        "+--------+------+------+-------+----+-----------+"
    ]
}
2025-02-22 23:54:31,797 p=1428881 u=digitd n=ansible INFO| PLAY RECAP ****************************************************************************************************************************************************************************************************************************************************
2025-02-22 23:54:31,930 p=1428881 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:54:32,005 p=1428881 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:54:32,089 p=1428881 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-22 23:54:32,214 p=1428881 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:09:49,745 p=1458523 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ************************************************************************************************************************************************************************************************************************
2025-02-23 00:09:49,749 p=1458523 u=digitd n=ansible INFO| TASK [Install HAProxy] ****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:09:57,167 p=1458523 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 00:09:57,168 p=1458523 u=digitd n=ansible INFO| TASK [Check service status] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 00:09:58,538 p=1458523 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 00:09:58,539 p=1458523 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ********************************************************************************************************************************************************************************************************************
2025-02-23 00:09:58,580 p=1458523 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:07,059 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:10,990 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:10,991 p=1458523 u=digitd n=ansible INFO| TASK [Check service] ******************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:12,497 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:13,039 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:13,040 p=1458523 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ******************************************************************************************************************************************************************************************************
2025-02-23 00:10:13,104 p=1458523 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ********************************************************************************************************************************************************************************************************************
2025-02-23 00:10:13,598 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:13,599 p=1458523 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ******************************************************************************************************************************************************************************************************************
2025-02-23 00:10:13,982 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:13,983 p=1458523 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***************************************************************************************************************************************************************************************************************
2025-02-23 00:10:19,969 p=1458523 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:10:19,970 p=1458523 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] **********************************************************************************************************************************************************
2025-02-23 00:10:20,003 p=1458523 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *****************************************************************************************************************************************************************************************************************
2025-02-23 00:10:20,813 p=1458523 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 00:10:20,936 p=1458523 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 00:10:20,937 p=1458523 u=digitd n=ansible INFO| TASK [Restart haproxy service] ********************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:22,010 p=1458523 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:10:22,088 p=1458523 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 00:10:22,089 p=1458523 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-23 00:10:22,128 p=1458523 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-23 00:10:22,902 p=1458523 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:10:22,903 p=1458523 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ************************************************************************************************************************************************************************************************************
2025-02-23 00:10:24,915 p=1458523 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:10:24,916 p=1458523 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-23 00:10:24,970 p=1458523 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-23 00:10:25,668 p=1458523 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:10:25,669 p=1458523 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ************************************************************************************************************************************************************************************************************
2025-02-23 00:10:27,645 p=1458523 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:10:27,647 p=1458523 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] **********************************************************************************************************************************************************************************************************
2025-02-23 00:10:27,744 p=1458523 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:28,515 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:28,516 p=1458523 u=digitd n=ansible INFO| TASK [Create data directory] **********************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:28,896 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:28,897 p=1458523 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:31,018 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:31,018 p=1458523 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:37,833 p=1458523 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:10:37,834 p=1458523 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ****************************************************************************************************************************************************************************************************************
2025-02-23 00:10:39,416 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:39,417 p=1458523 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ***********************************************************************************************************************************************************************************************************
2025-02-23 00:10:39,577 p=1458523 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:40,528 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:40,529 p=1458523 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:45,057 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:45,058 p=1458523 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:48,650 p=1458523 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 00:10:48,652 p=1458523 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:48,784 p=1458523 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ******************************************************************************************************************************************************************************************************
2025-02-23 00:10:49,802 p=1458523 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:10:49,804 p=1458523 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ****************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:49,884 p=1458523 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *****************************************************************************************************************************************************************************************************
2025-02-23 00:10:50,848 p=1458523 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 00:10:50,849 p=1458523 u=digitd n=ansible INFO| PLAY [Configure Patroni] **************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:50,942 p=1458523 u=digitd n=ansible INFO| TASK [Install patroni package] ********************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:52,756 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:52,901 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:52,902 p=1458523 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *****************************************************************************************************************************************************************************************************************
2025-02-23 00:10:54,012 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:54,020 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:54,639 p=1458523 u=digitd n=ansible INFO| TASK [Create data directory for database] *********************************************************************************************************************************************************************************************************************
2025-02-23 00:10:55,149 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:55,347 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:55,348 p=1458523 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] **********************************************************************************************************************************************************************************************************************
2025-02-23 00:10:57,744 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:10:57,892 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:10:57,893 p=1458523 u=digitd n=ansible INFO| TASK [Start services] *****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:10:59,417 p=1458523 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:11:02,815 p=1458523 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 00:11:02,816 p=1458523 u=digitd n=ansible INFO| TASK [Get patronictl status] **********************************************************************************************************************************************************************************************************************************
2025-02-23 00:11:03,966 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:11:04,225 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:11:04,226 p=1458523 u=digitd n=ansible INFO| TASK [Print it] ***********************************************************************************************************************************************************************************************************************************************
2025-02-23 00:11:04,290 p=1458523 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 00:11:04,340 p=1458523 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 00:11:04,440 p=1458523 u=digitd n=ansible INFO| PLAY RECAP ****************************************************************************************************************************************************************************************************************************************************
2025-02-23 00:11:04,498 p=1458523 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:11:04,548 p=1458523 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:11:04,698 p=1458523 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:11:04,781 p=1458523 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:21:24,358 p=1479468 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ************************************************************************************************************************************************************************************************************************
2025-02-23 00:21:24,362 p=1479468 u=digitd n=ansible INFO| TASK [Install HAProxy] ****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:21:26,586 p=1479468 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 00:21:26,588 p=1479468 u=digitd n=ansible INFO| TASK [Check service status] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 00:21:29,210 p=1479468 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 00:21:29,212 p=1479468 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] ********************************************************************************************************************************************************************************************************************
2025-02-23 00:21:31,762 p=1479468 u=digitd n=ansible INFO| TASK [Install PostgreSQL] *************************************************************************************************************************************************************************************************************************************
2025-02-23 00:21:35,437 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:21:36,728 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:21:36,729 p=1479468 u=digitd n=ansible INFO| TASK [Check service] ******************************************************************************************************************************************************************************************************************************************
2025-02-23 00:21:38,765 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:21:39,103 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:21:39,104 p=1479468 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] ******************************************************************************************************************************************************************************************************
2025-02-23 00:21:39,401 p=1479468 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] ********************************************************************************************************************************************************************************************************************
2025-02-23 00:21:40,922 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:21:40,923 p=1479468 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] ******************************************************************************************************************************************************************************************************************
2025-02-23 00:21:42,861 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:21:42,862 p=1479468 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] ***************************************************************************************************************************************************************************************************************
2025-02-23 00:22:18,534 p=1479468 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:22:18,535 p=1479468 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] **********************************************************************************************************************************************************
2025-02-23 00:22:21,892 p=1479468 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] *****************************************************************************************************************************************************************************************************************
2025-02-23 00:22:23,559 p=1479468 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 00:22:24,301 p=1479468 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 00:22:24,302 p=1479468 u=digitd n=ansible INFO| TASK [Restart haproxy service] ********************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:26,764 p=1479468 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 00:22:27,250 p=1479468 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:22:27,251 p=1479468 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-23 00:22:27,701 p=1479468 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-23 00:22:31,471 p=1479468 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:22:31,472 p=1479468 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ************************************************************************************************************************************************************************************************************
2025-02-23 00:22:34,895 p=1479468 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:22:34,896 p=1479468 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] *************************************************************************************************************************************************************************************************************
2025-02-23 00:22:36,233 p=1479468 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] ******************************************************************************************************************************************************************************************************************
2025-02-23 00:22:39,609 p=1479468 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:22:39,610 p=1479468 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ************************************************************************************************************************************************************************************************************
2025-02-23 00:22:44,066 p=1479468 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 00:22:44,067 p=1479468 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] **********************************************************************************************************************************************************************************************************
2025-02-23 00:22:44,116 p=1479468 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:44,835 p=1479468 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:22:44,835 p=1479468 u=digitd n=ansible INFO| TASK [Create data directory] **********************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:45,245 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:22:45,246 p=1479468 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:46,764 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:22:46,765 p=1479468 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:50,187 p=1479468 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:22:50,188 p=1479468 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ****************************************************************************************************************************************************************************************************************
2025-02-23 00:22:50,711 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:22:50,713 p=1479468 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] ***********************************************************************************************************************************************************************************************************
2025-02-23 00:22:50,774 p=1479468 u=digitd n=ansible INFO| TASK [Copy etcd file] *****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:51,973 p=1479468 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 00:22:51,974 p=1479468 u=digitd n=ansible INFO| TASK [Install etcd] *******************************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:54,097 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:22:54,098 p=1479468 u=digitd n=ansible INFO| TASK [Restart etcd service] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:56,619 p=1479468 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 00:22:56,620 p=1479468 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] ***************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:56,673 p=1479468 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] ******************************************************************************************************************************************************************************************************
2025-02-23 00:22:57,338 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:22:57,339 p=1479468 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ****************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:57,365 p=1479468 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] *****************************************************************************************************************************************************************************************************
2025-02-23 00:22:57,961 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:22:57,962 p=1479468 u=digitd n=ansible INFO| PLAY [Configure Patroni] **************************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:57,998 p=1479468 u=digitd n=ansible INFO| TASK [Install patroni package] ********************************************************************************************************************************************************************************************************************************
2025-02-23 00:22:59,421 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:22:59,558 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:22:59,559 p=1479468 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] *****************************************************************************************************************************************************************************************************************
2025-02-23 00:22:59,940 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:22:59,995 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:22:59,996 p=1479468 u=digitd n=ansible INFO| TASK [Create data directory for database] *********************************************************************************************************************************************************************************************************************
2025-02-23 00:23:00,390 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:23:00,444 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:23:00,445 p=1479468 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] **********************************************************************************************************************************************************************************************************************
2025-02-23 00:23:02,562 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:23:02,648 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:23:02,649 p=1479468 u=digitd n=ansible INFO| TASK [Start services] *****************************************************************************************************************************************************************************************************************************************
2025-02-23 00:23:03,779 p=1479468 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 00:23:05,296 p=1479468 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 00:23:05,297 p=1479468 u=digitd n=ansible INFO| TASK [Get patronictl status] **********************************************************************************************************************************************************************************************************************************
2025-02-23 00:23:06,708 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 00:23:06,775 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 00:23:06,777 p=1479468 u=digitd n=ansible INFO| TASK [Print it] ***********************************************************************************************************************************************************************************************************************************************
2025-02-23 00:23:06,930 p=1479468 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 00:23:07,013 p=1479468 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 00:23:07,121 p=1479468 u=digitd n=ansible INFO| PLAY RECAP ****************************************************************************************************************************************************************************************************************************************************
2025-02-23 00:23:07,221 p=1479468 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:23:07,304 p=1479468 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:23:07,388 p=1479468 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 00:23:07,471 p=1479468 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:19:56,854 p=392077 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 12:19:56,861 p=392077 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 12:20:10,977 p=392077 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:20:10,978 p=392077 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:20:13,596 p=392077 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:20:13,597 p=392077 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 12:20:13,629 p=392077 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 12:20:26,173 p=392077 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:20:28,295 p=392077 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:20:28,296 p=392077 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 12:20:29,800 p=392077 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:20:29,869 p=392077 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:20:29,871 p=392077 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 12:20:29,910 p=392077 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 12:20:30,346 p=392077 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:20:30,347 p=392077 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 12:20:30,658 p=392077 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:20:30,659 p=392077 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 12:20:35,290 p=392077 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:20:35,291 p=392077 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 12:20:35,327 p=392077 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 12:20:37,018 p=392077 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:20:38,094 p=392077 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 12:20:38,095 p=392077 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 12:20:39,233 p=392077 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 12:20:39,960 p=392077 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:20:39,961 p=392077 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:20:40,009 p=392077 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:20:40,697 p=392077 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:20:40,698 p=392077 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 12:20:42,793 p=392077 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:20:42,794 p=392077 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:20:42,834 p=392077 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:20:43,464 p=392077 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:20:43,465 p=392077 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 12:20:45,466 p=392077 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:20:45,467 p=392077 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 12:20:45,509 p=392077 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 12:20:46,372 p=392077 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:20:46,373 p=392077 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 12:20:46,737 p=392077 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:20:46,738 p=392077 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 12:20:48,324 p=392077 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:20:48,325 p=392077 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:20:49,213 p=392077 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Unable to start service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-23 12:20:49,214 p=392077 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 12:20:49,249 p=392077 u=digitd n=ansible INFO| db.master.lan              : ok=8    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:20:49,282 p=392077 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:20:49,315 p=392077 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:20:49,348 p=392077 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:31:44,086 p=412998 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 12:31:44,091 p=412998 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 12:31:45,812 p=412998 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:31:45,813 p=412998 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:31:46,981 p=412998 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:31:46,982 p=412998 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 12:31:47,012 p=412998 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 12:31:48,751 p=412998 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:31:48,811 p=412998 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:31:48,811 p=412998 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 12:31:49,789 p=412998 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:31:49,943 p=412998 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:31:49,944 p=412998 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 12:31:50,037 p=412998 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 12:31:50,505 p=412998 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:31:50,506 p=412998 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 12:31:50,975 p=412998 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:31:50,976 p=412998 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 12:31:56,444 p=412998 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:31:56,445 p=412998 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 12:31:56,479 p=412998 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 12:31:57,264 p=412998 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:31:57,351 p=412998 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 12:31:57,352 p=412998 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 12:31:58,517 p=412998 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:31:58,584 p=412998 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 12:31:58,585 p=412998 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:31:58,628 p=412998 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:31:59,364 p=412998 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:31:59,365 p=412998 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 12:32:01,512 p=412998 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:32:01,513 p=412998 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:32:01,553 p=412998 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:32:02,315 p=412998 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:32:02,316 p=412998 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 12:32:04,436 p=412998 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:32:04,437 p=412998 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 12:32:04,470 p=412998 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 12:32:05,195 p=412998 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:32:05,196 p=412998 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 12:32:05,647 p=412998 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:32:05,648 p=412998 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 12:32:07,052 p=412998 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:32:07,053 p=412998 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:32:07,969 p=412998 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Unable to restart service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-23 12:32:07,969 p=412998 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 12:32:08,009 p=412998 u=digitd n=ansible INFO| db.master.lan              : ok=8    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:32:08,051 p=412998 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:32:08,093 p=412998 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:32:08,126 p=412998 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:32:52,353 p=415507 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 12:32:52,357 p=415507 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 12:32:53,916 p=415507 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:32:53,917 p=415507 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:32:55,276 p=415507 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:32:55,277 p=415507 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 12:32:55,315 p=415507 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 12:32:56,787 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:32:56,998 p=415507 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:32:56,999 p=415507 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 12:32:57,956 p=415507 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:32:58,239 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:32:58,240 p=415507 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 12:32:58,398 p=415507 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 12:32:58,870 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:32:58,871 p=415507 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 12:32:59,245 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:32:59,246 p=415507 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 12:33:04,140 p=415507 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:33:04,141 p=415507 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 12:33:04,207 p=415507 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 12:33:05,000 p=415507 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:33:05,102 p=415507 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 12:33:05,102 p=415507 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 12:33:06,198 p=415507 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:33:06,241 p=415507 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 12:33:06,242 p=415507 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:33:06,272 p=415507 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:33:06,889 p=415507 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:33:06,891 p=415507 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 12:33:08,839 p=415507 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:33:08,841 p=415507 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:33:08,897 p=415507 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:33:09,568 p=415507 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:33:09,569 p=415507 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 12:33:11,589 p=415507 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:33:11,590 p=415507 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 12:33:11,631 p=415507 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 12:33:12,320 p=415507 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:33:12,320 p=415507 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 12:33:12,710 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:33:12,712 p=415507 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 12:33:14,079 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:33:14,080 p=415507 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:34:20,002 p=415507 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:34:20,003 p=415507 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 12:34:21,132 p=415507 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:34:21,133 p=415507 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 12:34:21,191 p=415507 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 12:34:22,289 p=415507 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 12:34:22,290 p=415507 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 12:34:23,998 p=415507 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:34:23,999 p=415507 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:34:25,497 p=415507 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Unable to restart service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-23 12:34:25,497 p=415507 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 12:34:25,531 p=415507 u=digitd n=ansible INFO| db.master.lan              : ok=10   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:34:25,564 p=415507 u=digitd n=ansible INFO| db.slave.lan               : ok=4    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:34:25,606 p=415507 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:34:25,648 p=415507 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:35:27,767 p=420785 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 12:35:27,771 p=420785 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 12:35:30,057 p=420785 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:35:30,058 p=420785 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:35:31,377 p=420785 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:35:31,379 p=420785 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 12:35:31,427 p=420785 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 12:35:33,163 p=420785 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:35:33,258 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:33,259 p=420785 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 12:35:34,192 p=420785 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:35:34,300 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:34,301 p=420785 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 12:35:34,652 p=420785 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 12:35:35,277 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:35,278 p=420785 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 12:35:35,677 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:35,679 p=420785 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 12:35:41,133 p=420785 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:35:41,134 p=420785 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 12:35:41,285 p=420785 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 12:35:42,078 p=420785 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:35:42,229 p=420785 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 12:35:42,230 p=420785 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 12:35:43,364 p=420785 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 12:35:43,367 p=420785 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:35:43,401 p=420785 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:35:43,434 p=420785 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:35:44,083 p=420785 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:35:44,084 p=420785 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 12:35:46,054 p=420785 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:35:46,055 p=420785 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:35:46,084 p=420785 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:35:46,792 p=420785 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:35:46,793 p=420785 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 12:35:48,989 p=420785 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:35:48,990 p=420785 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 12:35:49,025 p=420785 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 12:35:49,708 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:49,708 p=420785 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 12:35:50,098 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:50,099 p=420785 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 12:35:51,522 p=420785 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:35:51,523 p=420785 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:37:22,602 p=420785 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Unable to restart service etcd: Job for etcd.service failed because a timeout was exceeded.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-23 12:37:22,603 p=420785 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 12:37:22,658 p=420785 u=digitd n=ansible INFO| db.master.lan              : ok=8    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:37:22,699 p=420785 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:37:22,741 p=420785 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:37:22,783 p=420785 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:45:00,706 p=440233 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 12:45:00,710 p=440233 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 12:45:02,519 p=440233 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:45:02,520 p=440233 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:45:03,869 p=440233 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:45:03,871 p=440233 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 12:45:03,904 p=440233 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 12:45:05,739 p=440233 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:45:05,862 p=440233 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:45:05,863 p=440233 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 12:45:06,855 p=440233 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 12:45:07,578 p=440233 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:45:07,579 p=440233 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 12:45:07,704 p=440233 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 12:45:08,129 p=440233 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:45:08,130 p=440233 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 12:45:08,576 p=440233 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 12:45:08,577 p=440233 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 12:45:15,721 p=440233 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 12:45:15,722 p=440233 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 12:45:15,838 p=440233 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 12:45:16,687 p=440233 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 12:45:16,828 p=440233 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 12:45:16,829 p=440233 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 12:45:17,925 p=440233 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 12:45:19,061 p=440233 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:45:19,062 p=440233 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:45:19,736 p=440233 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:45:20,601 p=440233 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:45:20,602 p=440233 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 12:45:22,653 p=440233 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:45:22,654 p=440233 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 12:45:22,769 p=440233 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 12:45:23,404 p=440233 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:45:23,405 p=440233 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 12:45:25,416 p=440233 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 12:45:25,418 p=440233 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 12:45:25,469 p=440233 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 12:45:29,385 p=440233 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 12:45:30,923 p=440233 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.015796", "end": "2025-02-23 12:45:30.884250", "msg": "non-zero return code", "rc": 1, "start": "2025-02-23 12:45:25.868454", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-02-23T12:45:30.882+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-72bb54c5-6360-416c-8bd5-57a223ab72a4/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-02-23T12:45:30.882+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-72bb54c5-6360-416c-8bd5-57a223ab72a4/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-02-23 12:45:30,936 p=440233 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.014935", "end": "2025-02-23 12:45:30.897209", "msg": "non-zero return code", "rc": 1, "start": "2025-02-23 12:45:25.882274", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-02-23T12:45:30.895+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-57068e2c-bbbd-480c-bf6f-e96ae17aa3d1/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-02-23T12:45:30.895+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-57068e2c-bbbd-480c-bf6f-e96ae17aa3d1/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-02-23 12:45:31,018 p=440233 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 12:45:31,060 p=440233 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 12:45:31,102 p=440233 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 12:45:31,143 p=440233 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 12:45:32,125 p=440233 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 12:45:32,126 p=440233 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 12:45:42,458 p=440233 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 12:45:42,459 p=440233 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 12:45:43,862 p=440233 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": false, "msg": "Unable to restart service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-23 12:45:43,863 p=440233 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 12:45:43,899 p=440233 u=digitd n=ansible INFO| db.etcd.lan                : ok=3    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:45:43,932 p=440233 u=digitd n=ansible INFO| db.master.lan              : ok=5    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:45:44,032 p=440233 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 12:45:44,082 p=440233 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 12:45:44,124 p=440233 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:25:35,574 p=513406 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 13:25:35,577 p=513406 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 13:25:37,381 p=513406 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:25:37,382 p=513406 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:25:38,575 p=513406 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:25:38,577 p=513406 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 13:25:38,618 p=513406 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:25:40,364 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:40,441 p=513406 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:25:40,441 p=513406 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 13:25:41,340 p=513406 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:25:41,385 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:41,386 p=513406 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 13:25:41,418 p=513406 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 13:25:41,803 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:41,804 p=513406 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 13:25:42,227 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:42,228 p=513406 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 13:25:47,394 p=513406 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:25:47,396 p=513406 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 13:25:47,426 p=513406 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 13:25:48,221 p=513406 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:25:48,365 p=513406 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 13:25:48,366 p=513406 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:25:49,543 p=513406 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:25:49,589 p=513406 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 13:25:49,590 p=513406 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:25:49,626 p=513406 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:25:50,263 p=513406 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:25:50,264 p=513406 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 13:25:52,286 p=513406 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:25:52,287 p=513406 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:25:52,367 p=513406 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:25:53,038 p=513406 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:25:53,039 p=513406 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 13:25:55,138 p=513406 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:25:55,139 p=513406 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:25:55,225 p=513406 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:25:55,836 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:55,921 p=513406 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:25:55,926 p=513406 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:25:55,958 p=513406 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 13:25:55,992 p=513406 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:25:56,630 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:56,631 p=513406 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:25:56,967 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:56,968 p=513406 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:25:58,383 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:58,384 p=513406 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:25:58,826 p=513406 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:25:58,827 p=513406 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:26:00,612 p=513406 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:26:00,613 p=513406 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 13:26:00,750 p=513406 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:26:01,427 p=513406 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:26:01,427 p=513406 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:26:02,863 p=513406 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:26:02,864 p=513406 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:26:03,359 p=513406 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:26:03,360 p=513406 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:26:05,078 p=513406 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Unable to restart service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-02-23 13:26:05,078 p=513406 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 13:26:05,131 p=513406 u=digitd n=ansible INFO| db.etcd.lan                : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:26:05,164 p=513406 u=digitd n=ansible INFO| db.master.lan              : ok=11   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:26:05,198 p=513406 u=digitd n=ansible INFO| db.slave.lan               : ok=6    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 13:26:05,223 p=513406 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:26:05,264 p=513406 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:29:49,460 p=521381 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 13:29:49,464 p=521381 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 13:29:51,225 p=521381 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:29:51,226 p=521381 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:29:52,528 p=521381 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:29:52,529 p=521381 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 13:29:52,622 p=521381 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:29:54,419 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:29:54,482 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:29:54,483 p=521381 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 13:29:55,383 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:29:55,485 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:29:55,486 p=521381 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 13:29:55,530 p=521381 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 13:29:55,923 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:29:55,924 p=521381 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 13:29:56,240 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:29:56,242 p=521381 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 13:30:02,374 p=521381 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:30:02,375 p=521381 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 13:30:02,413 p=521381 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 13:30:03,224 p=521381 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:30:03,371 p=521381 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 13:30:03,372 p=521381 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:30:04,388 p=521381 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:30:04,519 p=521381 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 13:30:04,521 p=521381 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:30:04,563 p=521381 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:30:05,270 p=521381 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:30:05,271 p=521381 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 13:30:07,223 p=521381 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:30:07,224 p=521381 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:30:07,280 p=521381 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:30:07,980 p=521381 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:30:07,981 p=521381 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 13:30:09,958 p=521381 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:30:09,959 p=521381 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:30:09,996 p=521381 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:30:10,635 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:10,640 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:10,790 p=521381 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:30:10,791 p=521381 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 13:30:10,821 p=521381 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:11,476 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:11,477 p=521381 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:30:11,856 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:11,856 p=521381 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:13,315 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:13,316 p=521381 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:30:13,889 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:13,890 p=521381 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:30:16,904 p=521381 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:30:16,905 p=521381 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 13:30:16,970 p=521381 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:17,648 p=521381 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:30:17,649 p=521381 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:19,045 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:19,046 p=521381 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:30:19,469 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:19,470 p=521381 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:30:22,485 p=521381 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:30:22,486 p=521381 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 13:30:22,570 p=521381 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:23,279 p=521381 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 13:30:23,280 p=521381 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:24,705 p=521381 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:30:24,706 p=521381 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:30:25,179 p=521381 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:30:25,180 p=521381 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:30:26,899 p=521381 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 13:30:26,900 p=521381 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 13:30:26,961 p=521381 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 13:30:27,745 p=521381 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:30:27,746 p=521381 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 13:30:27,777 p=521381 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 13:30:28,495 p=521381 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:30:28,496 p=521381 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:28,528 p=521381 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:30:30,498 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:30,563 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:30,564 p=521381 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 13:30:30,902 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:30,963 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:30,964 p=521381 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 13:30:31,321 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:31,393 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:31,394 p=521381 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 13:30:33,679 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:34,337 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:34,338 p=521381 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:35,411 p=521381 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:30:35,412 p=521381 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:30:35,451 p=521381 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:30:37,681 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:30:37,767 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:30:37,768 p=521381 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:37,859 p=521381 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:30:38,084 p=521381 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:30:38,167 p=521381 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 13:30:38,208 p=521381 u=digitd n=ansible INFO| db.etcd.lan                : ok=5    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:30:38,308 p=521381 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:30:38,459 p=521381 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:30:38,492 p=521381 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:30:38,558 p=521381 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:33:28,658 p=528725 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 13:33:28,662 p=528725 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:30,460 p=528725 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:33:30,461 p=528725 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:33:31,738 p=528725 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:33:31,739 p=528725 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 13:33:31,812 p=528725 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:33,478 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:33:33,584 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:33,585 p=528725 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:34,465 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:33:34,644 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:34,645 p=528725 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 13:33:34,703 p=528725 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 13:33:35,132 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:35,133 p=528725 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 13:33:35,495 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:35,496 p=528725 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 13:33:40,672 p=528725 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:33:40,673 p=528725 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 13:33:40,712 p=528725 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 13:33:41,515 p=528725 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:33:41,689 p=528725 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 13:33:41,690 p=528725 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:33:42,718 p=528725 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:33:42,850 p=528725 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 13:33:42,851 p=528725 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:33:42,886 p=528725 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:33:43,513 p=528725 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:33:43,514 p=528725 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 13:33:45,582 p=528725 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:33:45,583 p=528725 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:33:45,636 p=528725 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:33:46,314 p=528725 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:33:46,315 p=528725 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 13:33:48,257 p=528725 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:33:48,258 p=528725 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:33:48,361 p=528725 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:33:49,168 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:33:49,310 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:49,598 p=528725 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:33:49,599 p=528725 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 13:33:49,661 p=528725 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:50,315 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:50,316 p=528725 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:33:50,820 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:50,821 p=528725 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:52,361 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:52,362 p=528725 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:33:52,830 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:33:52,831 p=528725 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:33:54,975 p=528725 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:33:54,976 p=528725 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 13:33:55,052 p=528725 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:55,786 p=528725 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:33:55,787 p=528725 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:33:57,172 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:33:57,173 p=528725 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:33:57,663 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:33:57,664 p=528725 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:34:00,751 p=528725 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:34:00,752 p=528725 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 13:34:01,035 p=528725 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:34:02,303 p=528725 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:34:02,304 p=528725 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:34:03,820 p=528725 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:34:03,821 p=528725 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:34:04,622 p=528725 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:34:04,623 p=528725 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:34:06,489 p=528725 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 13:34:06,490 p=528725 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 13:34:06,559 p=528725 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 13:34:07,231 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:34:07,232 p=528725 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 13:34:07,276 p=528725 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 13:34:07,909 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:34:07,910 p=528725 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 13:34:07,951 p=528725 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:34:09,372 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:34:09,420 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:34:09,422 p=528725 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 13:34:09,756 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:34:09,762 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:34:09,792 p=528725 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 13:34:10,131 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:34:10,131 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:34:10,167 p=528725 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 13:34:12,123 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:34:12,665 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:34:12,666 p=528725 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:34:13,768 p=528725 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:34:16,668 p=528725 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:34:16,669 p=528725 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:34:17,939 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:34:18,265 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:34:18,266 p=528725 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:34:18,491 p=528725 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:34:18,757 p=528725 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:34:18,824 p=528725 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 13:34:18,948 p=528725 u=digitd n=ansible INFO| db.etcd.lan                : ok=5    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:34:19,257 p=528725 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:34:19,315 p=528725 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:34:20,065 p=528725 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:34:20,673 p=528725 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:42:33,236 p=546238 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 13:42:33,241 p=546238 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 13:42:34,980 p=546238 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:42:34,981 p=546238 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:42:36,218 p=546238 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:42:36,219 p=546238 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 13:42:36,259 p=546238 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:42:38,006 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:42:38,065 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:38,066 p=546238 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 13:42:38,997 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:42:39,098 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:39,099 p=546238 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 13:42:39,133 p=546238 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 13:42:39,532 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:39,533 p=546238 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 13:42:39,855 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:39,856 p=546238 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 13:42:44,787 p=546238 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:42:44,788 p=546238 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 13:42:44,833 p=546238 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 13:42:45,645 p=546238 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:42:45,785 p=546238 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 13:42:45,786 p=546238 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:42:46,832 p=546238 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:42:46,980 p=546238 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 13:42:46,981 p=546238 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:42:47,058 p=546238 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:42:47,821 p=546238 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:42:47,822 p=546238 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 13:42:49,859 p=546238 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:42:49,860 p=546238 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:42:49,899 p=546238 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:42:50,596 p=546238 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:42:50,597 p=546238 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 13:42:52,641 p=546238 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:42:52,642 p=546238 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:42:52,682 p=546238 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:42:53,303 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:53,305 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:42:53,787 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:42:53,788 p=546238 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 13:42:53,941 p=546238 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:42:54,745 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:54,746 p=546238 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:42:55,207 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:55,207 p=546238 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:42:56,729 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:56,730 p=546238 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:42:57,176 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:42:57,177 p=546238 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:42:59,322 p=546238 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:42:59,323 p=546238 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 13:42:59,415 p=546238 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:00,061 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:00,062 p=546238 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:01,382 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:01,383 p=546238 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:43:01,859 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:01,860 p=546238 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:43:03,868 p=546238 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:43:03,870 p=546238 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 13:43:03,965 p=546238 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:04,639 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:43:04,640 p=546238 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:06,096 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:43:06,098 p=546238 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:43:06,579 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:43:06,580 p=546238 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:43:11,535 p=546238 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 13:43:11,536 p=546238 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:12,265 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:43:12,267 p=546238 u=digitd n=ansible INFO| TASK [Print i] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:12,305 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |   78 kB |     false |      false |       301 |        293 |                292 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |   78 kB |      true |      false |       301 |        293 |                293 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |   78 kB |     false |      false |       301 |        293 |                293 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 13:43:12,364 p=546238 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:12,800 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:43:12,801 p=546238 u=digitd n=ansible INFO| TASK [Print i] ***********************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:13,030 p=546238 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 13:43:13,105 p=546238 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 13:43:13,181 p=546238 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 13:43:13,977 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:43:13,978 p=546238 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 13:43:14,039 p=546238 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 13:43:14,714 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:14,715 p=546238 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:14,905 p=546238 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:43:16,514 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:17,387 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:43:17,388 p=546238 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 13:43:17,847 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:17,848 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:43:17,896 p=546238 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 13:43:18,333 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:18,424 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:43:18,425 p=546238 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 13:43:20,804 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:21,226 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:43:21,227 p=546238 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:22,312 p=546238 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:43:25,493 p=546238 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:43:25,494 p=546238 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:43:27,017 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:43:27,018 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:43:27,170 p=546238 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:27,263 p=546238 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:43:27,320 p=546238 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:43:27,421 p=546238 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 13:43:27,461 p=546238 u=digitd n=ansible INFO| db.etcd.lan                : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:43:27,519 p=546238 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:43:27,561 p=546238 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:43:27,836 p=546238 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:43:27,911 p=546238 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:45:52,649 p=553182 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 13:45:52,653 p=553182 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 13:45:54,559 p=553182 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:45:54,560 p=553182 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:45:55,899 p=553182 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:45:55,900 p=553182 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 13:45:55,941 p=553182 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:45:57,696 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:45:57,753 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:45:57,754 p=553182 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 13:45:58,699 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:45:58,751 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:45:58,753 p=553182 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 13:45:58,791 p=553182 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 13:45:59,230 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:45:59,231 p=553182 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 13:45:59,623 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:45:59,624 p=553182 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 13:46:04,823 p=553182 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:46:04,824 p=553182 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 13:46:04,873 p=553182 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 13:46:05,655 p=553182 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:46:05,774 p=553182 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 13:46:05,775 p=553182 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:46:06,927 p=553182 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:46:06,975 p=553182 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 13:46:06,976 p=553182 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:46:07,015 p=553182 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:46:07,814 p=553182 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:46:07,815 p=553182 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 13:46:09,759 p=553182 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:46:09,760 p=553182 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:46:09,806 p=553182 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:46:10,461 p=553182 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:46:10,462 p=553182 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 13:46:12,405 p=553182 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:46:12,406 p=553182 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:46:12,439 p=553182 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:46:13,041 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:13,042 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:13,294 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:46:13,296 p=553182 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 13:46:13,356 p=553182 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:14,116 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:14,116 p=553182 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:46:14,663 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:14,664 p=553182 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:16,083 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:16,084 p=553182 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:46:16,552 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:16,553 p=553182 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:46:18,528 p=553182 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:46:18,529 p=553182 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 13:46:18,572 p=553182 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:19,265 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:19,266 p=553182 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:20,687 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:20,688 p=553182 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:46:21,183 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:21,184 p=553182 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:46:24,730 p=553182 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:46:24,732 p=553182 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 13:46:24,829 p=553182 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:25,467 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:46:25,468 p=553182 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:27,038 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:46:27,039 p=553182 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:46:28,692 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:46:28,693 p=553182 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:46:30,730 p=553182 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 13:46:30,731 p=553182 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:31,209 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:46:31,211 p=553182 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:31,255 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |   98 kB |     false |      false |       303 |        381 |                381 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |   98 kB |     false |      false |       303 |        381 |                381 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |   98 kB |      true |      false |       303 |        381 |                381 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 13:46:31,303 p=553182 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:31,775 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:46:31,776 p=553182 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:31,828 p=553182 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 13:46:31,854 p=553182 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 13:46:31,896 p=553182 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 13:46:32,591 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:32,592 p=553182 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 13:46:32,638 p=553182 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 13:46:33,275 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:33,276 p=553182 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:33,312 p=553182 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:46:34,794 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:34,886 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:34,886 p=553182 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 13:46:35,350 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:35,400 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:35,401 p=553182 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 13:46:35,778 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:36,204 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:36,205 p=553182 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 13:46:38,498 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:38,926 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:38,927 p=553182 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:40,590 p=553182 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:46:43,452 p=553182 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:46:43,453 p=553182 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:46:45,090 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:46:45,348 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:46:45,349 p=553182 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:45,477 p=553182 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:46:45,510 p=553182 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:46:45,552 p=553182 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 13:46:45,669 p=553182 u=digitd n=ansible INFO| db.etcd.lan                : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:46:45,759 p=553182 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:46:45,809 p=553182 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:46:45,893 p=553182 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:46:46,009 p=553182 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:55:13,387 p=571095 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 13:55:13,391 p=571095 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:15,161 p=571095 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:55:15,162 p=571095 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:55:16,417 p=571095 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:55:16,418 p=571095 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 13:55:16,449 p=571095 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:18,224 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:18,351 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:18,352 p=571095 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:19,294 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:19,334 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:19,335 p=571095 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 13:55:19,374 p=571095 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 13:55:19,764 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:19,765 p=571095 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 13:55:20,149 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:20,150 p=571095 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 13:55:25,079 p=571095 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:55:25,081 p=571095 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 13:55:25,116 p=571095 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 13:55:25,925 p=571095 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 13:55:26,025 p=571095 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 13:55:26,026 p=571095 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:55:27,051 p=571095 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:55:27,184 p=571095 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 13:55:27,185 p=571095 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:55:27,223 p=571095 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:55:27,915 p=571095 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:55:27,916 p=571095 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 13:55:29,877 p=571095 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:55:29,878 p=571095 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 13:55:29,965 p=571095 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 13:55:30,704 p=571095 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:55:30,705 p=571095 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 13:55:32,778 p=571095 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 13:55:32,779 p=571095 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:55:33,065 p=571095 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:55:33,910 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:34,230 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:55:34,368 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:34,369 p=571095 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 13:55:34,489 p=571095 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:35,186 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:35,187 p=571095 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:55:35,617 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:35,618 p=571095 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:37,186 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:37,187 p=571095 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:55:37,912 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:37,913 p=571095 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:55:40,040 p=571095 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:55:40,042 p=571095 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 13:55:40,131 p=571095 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:40,812 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:40,813 p=571095 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:42,192 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:42,193 p=571095 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:55:42,697 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:42,698 p=571095 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:55:44,785 p=571095 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:55:44,787 p=571095 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 13:55:44,914 p=571095 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:45,629 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:55:45,630 p=571095 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:47,068 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:55:47,069 p=571095 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 13:55:48,405 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:55:48,406 p=571095 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 13:55:51,266 p=571095 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 13:55:51,267 p=571095 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:51,739 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:55:51,741 p=571095 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:51,837 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  131 kB |      true |      false |       305 |        562 |                562 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  131 kB |     false |      false |       305 |        562 |                562 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |  131 kB |     false |      false |       305 |        562 |                562 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 13:55:51,862 p=571095 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:52,257 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 13:55:52,258 p=571095 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:52,381 p=571095 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 13:55:52,404 p=571095 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 13:55:52,438 p=571095 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 13:55:53,075 p=571095 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:55:53,076 p=571095 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 13:55:53,171 p=571095 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 13:55:53,818 p=571095 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:55:53,819 p=571095 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:53,888 p=571095 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 13:55:55,259 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:55,489 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:55,490 p=571095 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 13:55:55,824 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:55,835 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:55,862 p=571095 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 13:55:56,202 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:56,246 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:56,247 p=571095 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 13:55:58,294 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:55:58,351 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:55:58,352 p=571095 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 13:55:59,384 p=571095 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 13:56:03,373 p=571095 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 13:56:03,374 p=571095 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 13:56:04,781 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 13:56:04,868 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 13:56:04,870 p=571095 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 13:56:05,070 p=571095 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:56:05,561 p=571095 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 13:56:05,868 p=571095 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 13:56:05,941 p=571095 u=digitd n=ansible INFO| db.etcd.lan                : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:56:06,135 p=571095 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:56:06,369 p=571095 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:56:06,419 p=571095 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 13:56:06,794 p=571095 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:39:49,369 p=1069810 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 18:39:49,373 p=1069810 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 18:40:05,162 p=1069810 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:40:05,164 p=1069810 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:40:07,555 p=1069810 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:40:07,556 p=1069810 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 18:40:07,616 p=1069810 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 18:40:10,371 p=1069810 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:40:18,281 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:18,281 p=1069810 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 18:40:19,605 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:21,136 p=1069810 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 18:40:21,137 p=1069810 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 18:40:21,190 p=1069810 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 18:40:21,631 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:21,632 p=1069810 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 18:40:22,015 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:22,016 p=1069810 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 18:40:27,003 p=1069810 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 18:40:27,004 p=1069810 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 18:40:27,040 p=1069810 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 18:40:28,652 p=1069810 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:40:29,700 p=1069810 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 18:40:29,701 p=1069810 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 18:40:30,892 p=1069810 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 18:40:31,186 p=1069810 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:40:31,188 p=1069810 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 18:40:31,281 p=1069810 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 18:40:31,969 p=1069810 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:40:31,970 p=1069810 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 18:40:34,220 p=1069810 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:40:34,221 p=1069810 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 18:40:34,255 p=1069810 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 18:40:34,886 p=1069810 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:40:34,887 p=1069810 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 18:40:36,800 p=1069810 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:40:36,802 p=1069810 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 18:40:36,864 p=1069810 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:40:37,384 p=1069810 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "cmd": "etcdctl del '' --prefix", "msg": "[Errno 2]     : b'etcdctl'", "rc": 2, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-02-23 18:40:39,120 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:43,636 p=1069810 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:40:43,637 p=1069810 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 18:40:43,705 p=1069810 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:40:45,107 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:45,108 p=1069810 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 18:40:45,606 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:45,607 p=1069810 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:40:47,168 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:47,169 p=1069810 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:40:47,655 p=1069810 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:40:47,656 p=1069810 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:40:49,988 p=1069810 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 18:40:49,989 p=1069810 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 18:40:50,063 p=1069810 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 18:40:50,138 p=1069810 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:40:51,262 p=1069810 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:40:51,263 p=1069810 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:41:00,965 p=1069810 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:41:00,966 p=1069810 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:41:01,424 p=1069810 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:41:01,425 p=1069810 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:41:05,053 p=1069810 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 18:41:05,053 p=1069810 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 18:41:10,581 p=1069810 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "--cluster=true", "endpoint", "status", "--write-out=table"], "delta": "0:00:05.068852", "end": "2025-02-23 18:41:10.547695", "msg": "non-zero return code", "rc": 1, "start": "2025-02-23 18:41:05.478843", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-02-23T18:41:10.514+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"passthrough:///http://192.168.2.17:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: connection error: desc = \\\"transport: Error while dialing dial tcp 192.168.2.17:2379: connect: connection refused\\\"\"}\nFailed to get the status of endpoint http://192.168.2.17:2379 (context deadline exceeded)", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-02-23T18:41:10.514+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"passthrough:///http://192.168.2.17:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: connection error: desc = \\\"transport: Error while dialing dial tcp 192.168.2.17:2379: connect: connection refused\\\"\"}", "Failed to get the status of endpoint http://192.168.2.17:2379 (context deadline exceeded)"], "stdout": "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |\n+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  209 kB |      true |      false |      4925 |       1417 |               1417 |        |\n| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  209 kB |     false |      false |      4925 |       1417 |               1417 |        |\n+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "stdout_lines": ["+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |", "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  209 kB |      true |      false |      4925 |       1417 |               1417 |        |", "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  209 kB |     false |      false |      4925 |       1417 |               1417 |        |", "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"]}
2025-02-23 18:41:10,582 p=1069810 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 18:41:10,618 p=1069810 u=digitd n=ansible INFO| db.etcd.lan                : ok=5    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 18:41:10,660 p=1069810 u=digitd n=ansible INFO| db.master.lan              : ok=11   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:41:10,701 p=1069810 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 18:41:10,734 p=1069810 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:41:10,768 p=1069810 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:43:10,685 p=1076799 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 18:43:10,690 p=1076799 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:12,529 p=1076799 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:43:12,530 p=1076799 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:43:13,834 p=1076799 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:43:13,835 p=1076799 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 18:43:13,876 p=1076799 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:15,667 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:15,669 p=1076799 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:43:15,708 p=1076799 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:16,673 p=1076799 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:43:16,724 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:16,725 p=1076799 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 18:43:16,767 p=1076799 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 18:43:17,221 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:17,222 p=1076799 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 18:43:17,612 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:17,613 p=1076799 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 18:43:22,802 p=1076799 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 18:43:22,803 p=1076799 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 18:43:22,834 p=1076799 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 18:43:23,619 p=1076799 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:43:23,731 p=1076799 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 18:43:23,732 p=1076799 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 18:43:24,742 p=1076799 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 18:43:24,820 p=1076799 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:43:24,821 p=1076799 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 18:43:24,875 p=1076799 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 18:43:25,591 p=1076799 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:43:25,592 p=1076799 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 18:43:27,581 p=1076799 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:43:27,582 p=1076799 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 18:43:27,624 p=1076799 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 18:43:28,339 p=1076799 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:43:28,340 p=1076799 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 18:43:30,398 p=1076799 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:43:30,399 p=1076799 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 18:43:30,500 p=1076799 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:43:31,014 p=1076799 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:43:31,130 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:31,297 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:43:31,298 p=1076799 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 18:43:31,416 p=1076799 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:32,122 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:32,123 p=1076799 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 18:43:32,699 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:32,700 p=1076799 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:34,254 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:34,255 p=1076799 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:43:34,841 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:34,842 p=1076799 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:43:37,383 p=1076799 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 18:43:37,384 p=1076799 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 18:43:37,441 p=1076799 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:38,188 p=1076799 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 18:43:38,189 p=1076799 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:39,663 p=1076799 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:43:39,664 p=1076799 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:43:40,090 p=1076799 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:43:40,091 p=1076799 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:43:43,076 p=1076799 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 18:43:43,077 p=1076799 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 18:43:43,123 p=1076799 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:43,872 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:43:43,873 p=1076799 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:45,456 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:43:45,457 p=1076799 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:43:45,873 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:43:45,874 p=1076799 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:43:48,768 p=1076799 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 18:43:48,769 p=1076799 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:49,362 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:43:49,363 p=1076799 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:49,456 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  209 kB |      true |      false |      4927 |       1459 |               1459 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  209 kB |     false |      false |      4927 |       1459 |               1459 |        |",
        "| http://192.168.2.17:2379 | 8e9e05c52164694d |  3.4.23 |   20 kB |      true |      false |         3 |          8 |                  8 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 18:43:49,489 p=1076799 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:50,077 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:43:50,078 p=1076799 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:50,113 p=1076799 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 18:43:50,147 p=1076799 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 18:43:50,190 p=1076799 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 18:43:50,911 p=1076799 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:43:50,912 p=1076799 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 18:43:50,948 p=1076799 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 18:43:51,615 p=1076799 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "checksum": "ffc53338a8dab293f51065d777d40fceef18015b", "msg": "Destination directory /etc/patroni does not exist"}
2025-02-23 18:43:51,615 p=1076799 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 18:43:51,655 p=1076799 u=digitd n=ansible INFO| db.etcd.lan                : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:43:51,696 p=1076799 u=digitd n=ansible INFO| db.master.lan              : ok=12   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:43:51,730 p=1076799 u=digitd n=ansible INFO| db.slave.lan               : ok=7    changed=2    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 18:43:51,763 p=1076799 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:43:51,805 p=1076799 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:56:32,812 p=1101509 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 18:56:32,816 p=1101509 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 18:56:34,613 p=1101509 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:56:34,614 p=1101509 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:56:35,854 p=1101509 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:56:35,855 p=1101509 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 18:56:35,893 p=1101509 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 18:56:37,730 p=1101509 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:56:37,849 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:37,850 p=1101509 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 18:56:38,810 p=1101509 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 18:56:38,853 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:38,854 p=1101509 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 18:56:38,892 p=1101509 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 18:56:39,342 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:39,343 p=1101509 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 18:56:39,735 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:39,736 p=1101509 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 18:56:44,565 p=1101509 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 18:56:44,566 p=1101509 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 18:56:44,601 p=1101509 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 18:56:45,400 p=1101509 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 18:56:45,547 p=1101509 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 18:56:45,548 p=1101509 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 18:56:46,636 p=1101509 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:56:46,748 p=1101509 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 18:56:46,749 p=1101509 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 18:56:46,792 p=1101509 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 18:56:47,583 p=1101509 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:56:47,584 p=1101509 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 18:56:49,569 p=1101509 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:56:49,570 p=1101509 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 18:56:49,608 p=1101509 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 18:56:50,330 p=1101509 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:56:50,331 p=1101509 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 18:56:52,365 p=1101509 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 18:56:52,367 p=1101509 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 18:56:52,416 p=1101509 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:56:52,969 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:53,488 p=1101509 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:56:57,887 p=1101509 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.014857", "end": "2025-02-23 18:56:57.850931", "msg": "non-zero return code", "rc": 1, "start": "2025-02-23 18:56:52.836074", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-02-23T18:56:57.848+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-8ce65965-dfbe-42d9-a2e5-24873e3e4238/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-02-23T18:56:57.848+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-8ce65965-dfbe-42d9-a2e5-24873e3e4238/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-02-23 18:56:57,888 p=1101509 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 18:56:57,924 p=1101509 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:56:58,557 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:58,558 p=1101509 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 18:56:58,942 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:56:58,943 p=1101509 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:57:00,469 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:57:00,470 p=1101509 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:57:00,943 p=1101509 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 18:57:00,944 p=1101509 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:57:02,965 p=1101509 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 18:57:02,966 p=1101509 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 18:57:03,040 p=1101509 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 18:57:03,107 p=1101509 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 18:57:03,784 p=1101509 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:57:03,785 p=1101509 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 18:57:05,583 p=1101509 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:57:05,584 p=1101509 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 18:57:06,055 p=1101509 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 18:57:06,056 p=1101509 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 18:57:08,004 p=1101509 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 18:57:08,005 p=1101509 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 18:57:14,662 p=1101509 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "--cluster=true", "endpoint", "status", "--write-out=table"], "delta": "0:00:05.845766", "end": "2025-02-23 18:57:14.640317", "msg": "non-zero return code", "rc": 1, "start": "2025-02-23 18:57:08.794551", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-02-23T18:57:14.631+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"passthrough:///http://192.168.2.17:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: connection error: desc = \\\"transport: Error while dialing dial tcp 192.168.2.17:2379: connect: connection refused\\\"\"}\nFailed to get the status of endpoint http://192.168.2.17:2379 (context deadline exceeded)", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-02-23T18:57:14.631+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"passthrough:///http://192.168.2.17:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: connection error: desc = \\\"transport: Error while dialing dial tcp 192.168.2.17:2379: connect: connection refused\\\"\"}", "Failed to get the status of endpoint http://192.168.2.17:2379 (context deadline exceeded)"], "stdout": "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |\n+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  209 kB |      true |      false |      4929 |       1553 |               1552 |        |\n| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  209 kB |     false |      false |      4929 |       1553 |               1553 |        |\n+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "stdout_lines": ["+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |", "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  209 kB |      true |      false |      4929 |       1553 |               1552 |        |", "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  209 kB |     false |      false |      4929 |       1553 |               1553 |        |", "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"]}
2025-02-23 18:57:14,662 p=1101509 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 18:57:14,696 p=1101509 u=digitd n=ansible INFO| db.etcd.lan                : ok=5    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 18:57:14,730 p=1101509 u=digitd n=ansible INFO| db.master.lan              : ok=11   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:57:14,763 p=1101509 u=digitd n=ansible INFO| db.slave.lan               : ok=2    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 18:57:14,805 p=1101509 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 18:57:14,838 p=1101509 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:08:17,591 p=1122913 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 19:08:17,595 p=1122913 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:19,373 p=1122913 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 19:08:19,374 p=1122913 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:08:20,727 p=1122913 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 19:08:20,728 p=1122913 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 19:08:20,776 p=1122913 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:22,617 p=1122913 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:08:22,768 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:22,769 p=1122913 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:23,689 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:23,695 p=1122913 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:08:23,758 p=1122913 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 19:08:23,917 p=1122913 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 19:08:24,678 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:24,679 p=1122913 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 19:08:25,060 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:25,061 p=1122913 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 19:08:30,186 p=1122913 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 19:08:30,187 p=1122913 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 19:08:30,300 p=1122913 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 19:08:31,122 p=1122913 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 19:08:31,224 p=1122913 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 19:08:31,225 p=1122913 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 19:08:32,318 p=1122913 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 19:08:32,435 p=1122913 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:08:32,436 p=1122913 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 19:08:32,475 p=1122913 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 19:08:33,136 p=1122913 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:08:33,137 p=1122913 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 19:08:35,164 p=1122913 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:08:35,165 p=1122913 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 19:08:35,200 p=1122913 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 19:08:35,911 p=1122913 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:08:35,912 p=1122913 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 19:08:38,063 p=1122913 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:08:38,064 p=1122913 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 19:08:38,100 p=1122913 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:08:38,803 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:38,807 p=1122913 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:08:39,222 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:08:39,223 p=1122913 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 19:08:39,258 p=1122913 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:40,135 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:40,136 p=1122913 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 19:08:40,618 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:40,619 p=1122913 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:42,300 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:42,301 p=1122913 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:08:42,816 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:42,817 p=1122913 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:08:45,072 p=1122913 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 19:08:45,073 p=1122913 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 19:08:45,199 p=1122913 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:45,921 p=1122913 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:08:45,922 p=1122913 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:47,461 p=1122913 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:08:47,462 p=1122913 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:08:47,885 p=1122913 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:08:47,886 p=1122913 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:08:50,349 p=1122913 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:08:50,350 p=1122913 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 19:08:50,432 p=1122913 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:51,196 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:08:51,196 p=1122913 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:52,713 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:08:52,714 p=1122913 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:08:53,149 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:08:53,150 p=1122913 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:08:55,296 p=1122913 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 19:08:55,297 p=1122913 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:55,736 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:08:55,737 p=1122913 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:55,856 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |   49 kB |      true |      false |         8 |         64 |                 64 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |   49 kB |     false |      false |         8 |         64 |                 64 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |   49 kB |     false |      false |         8 |         64 |                 64 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 19:08:55,939 p=1122913 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:56,450 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:08:56,451 p=1122913 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:56,497 p=1122913 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 19:08:56,522 p=1122913 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 19:08:56,606 p=1122913 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:56,990 p=1122913 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 19:08:56,991 p=1122913 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 19:08:57,603 p=1122913 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:08:57,604 p=1122913 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 19:08:57,639 p=1122913 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 19:08:58,299 p=1122913 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "checksum": "ffc53338a8dab293f51065d777d40fceef18015b", "msg": "Destination directory /etc/patroni does not exist"}
2025-02-23 19:08:58,299 p=1122913 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 19:08:58,329 p=1122913 u=digitd n=ansible INFO| db.etcd.lan                : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:08:58,371 p=1122913 u=digitd n=ansible INFO| db.master.lan              : ok=13   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:08:58,413 p=1122913 u=digitd n=ansible INFO| db.slave.lan               : ok=7    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 19:08:58,454 p=1122913 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:08:58,496 p=1122913 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:09:53,017 p=1126420 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 19:09:53,021 p=1126420 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 19:09:54,842 p=1126420 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 19:09:54,843 p=1126420 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:09:56,064 p=1126420 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 19:09:56,066 p=1126420 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 19:09:56,110 p=1126420 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 19:09:57,664 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:09:57,721 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:09:57,722 p=1126420 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 19:09:58,715 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:09:58,898 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:09:58,900 p=1126420 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 19:09:58,951 p=1126420 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 19:09:59,412 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:09:59,413 p=1126420 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 19:09:59,772 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:09:59,773 p=1126420 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 19:10:05,497 p=1126420 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 19:10:05,498 p=1126420 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 19:10:05,535 p=1126420 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 19:10:06,312 p=1126420 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 19:10:06,406 p=1126420 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 19:10:06,407 p=1126420 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 19:10:07,485 p=1126420 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 19:10:07,541 p=1126420 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:10:07,542 p=1126420 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 19:10:07,950 p=1126420 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 19:10:08,870 p=1126420 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:10:08,871 p=1126420 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 19:10:11,047 p=1126420 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:10:11,049 p=1126420 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 19:10:11,225 p=1126420 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 19:10:11,874 p=1126420 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:10:11,875 p=1126420 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 19:10:13,821 p=1126420 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 19:10:13,822 p=1126420 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 19:10:13,858 p=1126420 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:10:14,532 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:10:14,666 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:14,823 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:10:14,824 p=1126420 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 19:10:14,875 p=1126420 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:15,638 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:15,639 p=1126420 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 19:10:16,096 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:16,096 p=1126420 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:17,678 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:17,679 p=1126420 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:10:18,154 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:18,154 p=1126420 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:10:20,388 p=1126420 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 19:10:20,389 p=1126420 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 19:10:20,466 p=1126420 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:21,360 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:10:21,361 p=1126420 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:22,747 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:10:22,748 p=1126420 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:10:23,324 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:10:23,325 p=1126420 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:10:25,553 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:10:25,555 p=1126420 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 19:10:25,624 p=1126420 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:26,693 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:10:26,694 p=1126420 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:28,206 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:10:28,207 p=1126420 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 19:10:28,870 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:10:28,871 p=1126420 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 19:10:31,259 p=1126420 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 19:10:31,260 p=1126420 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:32,178 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:10:32,179 p=1126420 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:32,223 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |   66 kB |      true |      false |        11 |        107 |                107 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |   66 kB |     false |      false |        11 |        107 |                107 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |   66 kB |     false |      false |        11 |        107 |                107 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 19:10:32,247 p=1126420 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:32,665 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 19:10:32,666 p=1126420 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:32,714 p=1126420 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 19:10:32,748 p=1126420 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 19:10:32,790 p=1126420 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:33,201 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:33,202 p=1126420 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 19:10:33,852 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:10:33,853 p=1126420 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 19:10:33,890 p=1126420 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:34,279 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:10:34,280 p=1126420 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 19:10:34,913 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:10:34,914 p=1126420 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 19:10:34,990 p=1126420 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 19:10:36,552 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:12:01,169 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:12:01,170 p=1126420 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 19:12:01,514 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:12:01,915 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:12:01,916 p=1126420 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 19:12:02,499 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:12:02,499 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:12:02,500 p=1126420 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 19:12:04,647 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:12:04,797 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:12:04,798 p=1126420 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 19:12:05,898 p=1126420 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 19:12:07,626 p=1126420 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 19:12:07,627 p=1126420 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 19:12:09,060 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 19:12:09,418 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 19:12:09,419 p=1126420 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 19:12:09,465 p=1126420 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 19:12:09,497 p=1126420 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 19:12:09,531 p=1126420 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 19:12:09,564 p=1126420 u=digitd n=ansible INFO| db.etcd.lan                : ok=9    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:12:09,597 p=1126420 u=digitd n=ansible INFO| db.master.lan              : ok=20   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:12:09,630 p=1126420 u=digitd n=ansible INFO| db.slave.lan               : ok=16   changed=8    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:12:09,664 p=1126420 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 19:12:09,697 p=1126420 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:31:23,211 p=1388044 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 21:31:23,215 p=1388044 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 21:31:26,100 p=1388044 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 21:31:26,101 p=1388044 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:31:27,879 p=1388044 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 21:31:27,880 p=1388044 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 21:31:28,816 p=1388044 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 21:31:41,975 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:31:43,061 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:31:43,062 p=1388044 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 21:31:45,288 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:31:46,937 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:31:46,939 p=1388044 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 21:31:47,634 p=1388044 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 21:31:51,839 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:31:51,840 p=1388044 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 21:31:53,042 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:31:53,043 p=1388044 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 21:31:56,655 p=1388044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:31:56,656 p=1388044 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 21:31:57,467 p=1388044 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 21:31:59,664 p=1388044 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 21:32:00,644 p=1388044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:32:00,645 p=1388044 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 21:32:03,523 p=1388044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:32:04,394 p=1388044 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 21:32:04,395 p=1388044 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 21:32:05,281 p=1388044 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 21:32:07,546 p=1388044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:32:07,547 p=1388044 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 21:32:11,354 p=1388044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:32:11,355 p=1388044 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 21:32:12,496 p=1388044 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 21:32:15,966 p=1388044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:32:15,967 p=1388044 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 21:32:18,865 p=1388044 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:32:18,866 p=1388044 u=digitd n=ansible INFO| PLAY [Clear etcd old values] *********************************************************************************************************************************************************************************************************************
2025-02-23 21:32:19,333 p=1388044 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 21:32:24,068 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:32:24,068 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:32:30,768 p=1388044 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.015562", "end": "2025-02-23 21:32:27.168153", "msg": "non-zero return code", "rc": 1, "start": "2025-02-23 21:32:22.152591", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-02-23T21:32:27.166+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-5b887b51-448e-4117-9d2c-a9f1c73d2bcf/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-02-23T21:32:27.166+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-5b887b51-448e-4117-9d2c-a9f1c73d2bcf/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-02-23 21:32:32,143 p=1388044 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 21:32:32,829 p=1388044 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:32:35,872 p=1388044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:32:35,873 p=1388044 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 21:32:37,617 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:32:37,619 p=1388044 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 21:32:40,017 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:32:40,018 p=1388044 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 21:32:43,452 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:32:43,453 p=1388044 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:32:56,224 p=1388044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:32:56,225 p=1388044 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 21:32:56,885 p=1388044 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:00,928 p=1388044 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:33:00,928 p=1388044 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:05,009 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:05,010 p=1388044 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 21:33:08,356 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:08,357 p=1388044 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:33:20,536 p=1388044 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:33:20,537 p=1388044 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 21:33:20,996 p=1388044 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 21:33:21,441 p=1388044 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:22,646 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:33:22,647 p=1388044 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 21:33:23,641 p=1388044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:33:23,642 p=1388044 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 21:33:23,899 p=1388044 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:24,796 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:24,797 p=1388044 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 21:33:25,926 p=1388044 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:33:25,927 p=1388044 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:26,266 p=1388044 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 21:33:29,142 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:29,721 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:33:29,722 p=1388044 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 21:33:31,796 p=1388044 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:33:31,805 p=1388044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:33:32,283 p=1388044 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 21:33:33,265 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:33:33,276 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:33,706 p=1388044 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 21:33:36,346 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:37,283 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:33:37,284 p=1388044 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:43,082 p=1388044 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:33:44,078 p=1388044 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:33:44,079 p=1388044 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 21:33:47,175 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:33:48,932 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:33:48,933 p=1388044 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:49,973 p=1388044 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 21:33:50,340 p=1388044 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 21:33:50,646 p=1388044 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 21:33:51,321 p=1388044 u=digitd n=ansible INFO| db.etcd.lan                : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-02-23 21:33:51,820 p=1388044 u=digitd n=ansible INFO| db.master.lan              : ok=20   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:33:52,244 p=1388044 u=digitd n=ansible INFO| db.slave.lan               : ok=16   changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:33:52,837 p=1388044 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:33:53,458 p=1388044 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:42:17,742 p=1409631 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 21:42:17,746 p=1409631 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 21:42:21,361 p=1409631 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 21:42:21,362 p=1409631 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:42:26,431 p=1409631 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 21:42:26,432 p=1409631 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 21:42:27,263 p=1409631 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 21:42:32,413 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:42:53,391 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:42:53,392 p=1409631 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 21:43:04,545 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:43:30,628 p=1409631 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:43:30,629 p=1409631 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 21:43:32,674 p=1409631 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 21:43:36,464 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:43:36,465 p=1409631 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 21:43:38,061 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:43:38,062 p=1409631 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 21:43:42,692 p=1409631 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:43:42,694 p=1409631 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 21:43:44,158 p=1409631 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 21:43:50,007 p=1409631 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 21:43:51,208 p=1409631 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 21:43:51,209 p=1409631 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 21:43:54,194 p=1409631 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:43:54,988 p=1409631 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 21:43:54,989 p=1409631 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 21:43:56,456 p=1409631 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 21:44:09,768 p=1409631 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:44:09,769 p=1409631 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 21:44:15,300 p=1409631 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:44:15,301 p=1409631 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 21:44:16,020 p=1409631 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 21:44:18,154 p=1409631 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:44:18,155 p=1409631 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 21:44:21,338 p=1409631 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 21:44:21,339 p=1409631 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 21:44:22,157 p=1409631 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:44:25,021 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:44:25,022 p=1409631 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 21:44:27,053 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:44:27,054 p=1409631 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 21:44:31,322 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:44:31,323 p=1409631 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 21:44:35,722 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:44:35,723 p=1409631 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:44:56,535 p=1409631 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:44:56,536 p=1409631 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 21:44:57,838 p=1409631 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:45:03,892 p=1409631 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:45:03,893 p=1409631 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 21:45:10,687 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:45:10,688 p=1409631 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 21:45:15,094 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:45:15,095 p=1409631 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:45:43,643 p=1409631 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:45:43,644 p=1409631 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 21:45:44,194 p=1409631 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:45:46,727 p=1409631 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 21:45:46,728 p=1409631 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 21:45:48,946 p=1409631 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 21:45:48,947 p=1409631 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 21:45:50,787 p=1409631 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 21:45:50,788 p=1409631 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 21:46:15,330 p=1409631 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 21:46:15,331 p=1409631 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:17,445 p=1409631 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 21:46:17,447 p=1409631 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:18,034 p=1409631 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  139 kB |     false |      false |        42 |       1120 |               1120 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  143 kB |      true |      false |        42 |       1120 |               1120 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |  143 kB |     false |      false |        36 |       1115 |               1115 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 21:46:18,376 p=1409631 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:19,860 p=1409631 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 21:46:19,861 p=1409631 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:20,496 p=1409631 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 21:46:20,893 p=1409631 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 21:46:21,693 p=1409631 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:23,470 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:46:23,471 p=1409631 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 21:46:24,900 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:46:24,901 p=1409631 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 21:46:25,317 p=1409631 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:26,333 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:46:26,334 p=1409631 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 21:46:27,475 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:46:27,476 p=1409631 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:27,750 p=1409631 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 21:46:30,046 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:46:30,441 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:46:30,442 p=1409631 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 21:46:33,690 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:46:34,230 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:46:34,230 p=1409631 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 21:46:35,500 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:46:35,944 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:46:35,945 p=1409631 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 21:46:39,920 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:46:41,472 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:46:41,473 p=1409631 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 21:46:45,783 p=1409631 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 21:47:11,726 p=1409631 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 21:47:11,727 p=1409631 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 21:47:13,434 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 21:47:14,303 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 21:47:14,304 p=1409631 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 21:47:15,055 p=1409631 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+----------+----+-----------+",
        "| Member   | Host              | Role    | State    | TL | Lag in MB |",
        "+----------+-------------------+---------+----------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | starting |    |   unknown |",
        "+----------+-------------------+---------+----------+----+-----------+"
    ]
}
2025-02-23 21:47:15,553 p=1409631 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+----------+----+-----------+",
        "| Member   | Host              | Role    | State    | TL | Lag in MB |",
        "+----------+-------------------+---------+----------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | starting |    |   unknown |",
        "+----------+-------------------+---------+----------+----+-----------+"
    ]
}
2025-02-23 21:47:16,151 p=1409631 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 21:47:16,720 p=1409631 u=digitd n=ansible INFO| db.etcd.lan                : ok=8    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:47:17,220 p=1409631 u=digitd n=ansible INFO| db.master.lan              : ok=19   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:47:17,600 p=1409631 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:47:18,060 p=1409631 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 21:47:18,619 p=1409631 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:12:30,094 p=1465497 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 22:12:30,097 p=1465497 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 22:12:31,862 p=1465497 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 22:12:31,863 p=1465497 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:12:33,211 p=1465497 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 22:12:33,212 p=1465497 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 22:12:33,246 p=1465497 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 22:12:40,226 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:12:40,479 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:40,479 p=1465497 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 22:12:42,189 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:12:42,274 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:42,275 p=1465497 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 22:12:42,311 p=1465497 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 22:12:42,750 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:42,750 p=1465497 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 22:12:43,101 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:43,102 p=1465497 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 22:12:44,093 p=1465497 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:12:44,094 p=1465497 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 22:12:44,170 p=1465497 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 22:12:45,090 p=1465497 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 22:12:45,182 p=1465497 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 22:12:45,182 p=1465497 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 22:12:46,181 p=1465497 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxyvip (Sun 2025-02-23 22:12:46 MSK):    haproxy[3008]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxyvip (Sun 2025-02-23 22:12:46 MSK):    haproxy[3008]: backend master_back has no server available!

2025-02-23 22:12:46,241 p=1465497 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:12:46,242 p=1465497 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxydeb (Sun 2025-02-23 22:12:46 MSK):    haproxy[4523]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxydeb (Sun 2025-02-23 22:12:46 MSK):    haproxy[4523]: backend master_back has no server available!

2025-02-23 22:12:46,301 p=1465497 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 22:12:46,328 p=1465497 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 22:12:46,370 p=1465497 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 22:12:47,081 p=1465497 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:12:47,082 p=1465497 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 22:12:49,213 p=1465497 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:12:49,214 p=1465497 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 22:12:49,245 p=1465497 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 22:12:49,951 p=1465497 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:12:49,952 p=1465497 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 22:12:52,083 p=1465497 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:12:52,084 p=1465497 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 22:12:52,127 p=1465497 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:12:52,879 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:52,880 p=1465497 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 22:12:53,262 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:53,263 p=1465497 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 22:12:54,802 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:54,804 p=1465497 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 22:12:55,893 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:12:55,895 p=1465497 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:12:58,773 p=1465497 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:12:58,774 p=1465497 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 22:12:58,927 p=1465497 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:12:59,745 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:12:59,746 p=1465497 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:01,317 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:01,318 p=1465497 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 22:13:02,695 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:02,696 p=1465497 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:13:05,960 p=1465497 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 22:13:05,961 p=1465497 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 22:13:06,001 p=1465497 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:06,992 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:13:06,993 p=1465497 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:08,347 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:13:08,348 p=1465497 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 22:13:08,835 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:13:08,836 p=1465497 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:13:12,482 p=1465497 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 22:13:12,483 p=1465497 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:13,034 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:13:13,035 p=1465497 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:13,083 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  197 kB |      true |      false |       103 |       1385 |               1385 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  201 kB |     false |      false |       103 |       1385 |               1385 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |  201 kB |     false |      false |       103 |       1385 |               1385 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 22:13:13,117 p=1465497 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:13,532 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:13:13,533 p=1465497 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:13,575 p=1465497 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 22:13:13,600 p=1465497 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 22:13:13,634 p=1465497 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:14,023 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:14,024 p=1465497 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 22:13:14,778 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:14,779 p=1465497 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 22:13:14,826 p=1465497 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:15,219 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:15,220 p=1465497 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 22:13:15,826 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:15,827 p=1465497 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:15,867 p=1465497 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 22:13:17,363 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:17,481 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:17,482 p=1465497 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 22:13:17,852 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:17,860 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:17,916 p=1465497 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 22:13:18,355 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:18,356 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:18,450 p=1465497 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 22:13:20,475 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:20,536 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:20,537 p=1465497 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:13:21,521 p=1465497 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:13:24,245 p=1465497 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 22:13:24,246 p=1465497 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 22:13:25,418 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:13:26,137 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:13:26,138 p=1465497 u=digitd n=ansible INFO| TASK [Pause for initializing of patroni] *********************************************************************************************************************************************************************************************************
2025-02-23 22:13:26,271 p=1465497 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-02-23 22:13:26,390 p=1465497 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-02-23 22:15:26,459 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:15:26,463 p=1465497 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 22:15:26,514 p=1465497 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+--------------+----+-----------+",
        "| Member   | Host              | Role    | State        | TL | Lag in MB |",
        "+----------+-------------------+---------+--------------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | start failed |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped      |    |   unknown |",
        "+----------+-------------------+---------+--------------+----+-----------+"
    ]
}
2025-02-23 22:15:26,547 p=1465497 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+--------------+----+-----------+",
        "| Member   | Host              | Role    | State        | TL | Lag in MB |",
        "+----------+-------------------+---------+--------------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | start failed |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped      |    |   unknown |",
        "+----------+-------------------+---------+--------------+----+-----------+"
    ]
}
2025-02-23 22:15:26,589 p=1465497 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 22:15:26,622 p=1465497 u=digitd n=ansible INFO| db.etcd.lan                : ok=8    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:15:26,680 p=1465497 u=digitd n=ansible INFO| db.master.lan              : ok=20   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:15:26,771 p=1465497 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:15:26,813 p=1465497 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:15:26,888 p=1465497 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:53:34,658 p=1535161 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-02-23 22:53:34,662 p=1535161 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-02-23 22:53:36,356 p=1535161 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 22:53:36,357 p=1535161 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:53:37,646 p=1535161 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 22:53:37,647 p=1535161 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-02-23 22:53:37,681 p=1535161 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-02-23 22:53:39,414 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:53:39,533 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:39,534 p=1535161 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-02-23 22:53:40,588 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:53:43,480 p=1535161 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:53:43,481 p=1535161 u=digitd n=ansible INFO| PLAY [Correct configs for PostgreSQL on the master node] *****************************************************************************************************************************************************************************************
2025-02-23 22:53:43,522 p=1535161 u=digitd n=ansible INFO| TASK [Edit or ensure port for the service] *******************************************************************************************************************************************************************************************************
2025-02-23 22:53:43,975 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:43,976 p=1535161 u=digitd n=ansible INFO| TASK [Let's listen all incoming connections] *****************************************************************************************************************************************************************************************************
2025-02-23 22:53:44,387 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:44,388 p=1535161 u=digitd n=ansible INFO| TASK [Restart service after editing of configs] **************************************************************************************************************************************************************************************************
2025-02-23 22:53:45,465 p=1535161 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:53:45,466 p=1535161 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-02-23 22:53:45,514 p=1535161 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-02-23 22:53:46,391 p=1535161 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-02-23 22:53:46,486 p=1535161 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-02-23 22:53:46,487 p=1535161 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-02-23 22:53:47,573 p=1535161 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxyvip (Sun 2025-02-23 22:53:47 MSK):    haproxy[3341]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxyvip (Sun 2025-02-23 22:53:47 MSK):    haproxy[3341]: backend master_back has no server available!

2025-02-23 22:53:47,627 p=1535161 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:53:47,770 p=1535161 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxydeb (Sun 2025-02-23 22:53:47 MSK):    haproxy[4975]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxydeb (Sun 2025-02-23 22:53:47 MSK):    haproxy[4975]: backend master_back has no server available!

2025-02-23 22:53:47,819 p=1535161 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-02-23 22:53:47,820 p=1535161 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 22:53:47,855 p=1535161 u=digitd n=ansible INFO| TASK [Run keepalived on MASTER HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 22:53:48,504 p=1535161 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:53:48,505 p=1535161 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-02-23 22:53:49,019 p=1535161 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxyvip (Sun 2025-02-23 22:53:49 MSK):    haproxy[3341]: backend pg_cluster has no server available!      Broadcast message from systemd-
journald@haproxyvip (Sun 2025-02-23 22:53:49 MSK):    haproxy[3341]: backend pg_cluster has no server available!

2025-02-23 22:53:50,523 p=1535161 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:53:50,524 p=1535161 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-02-23 22:53:50,630 p=1535161 u=digitd n=ansible INFO| TASK [Run keepalived on BACKUP HAProxy node] *****************************************************************************************************************************************************************************************************
2025-02-23 22:53:51,464 p=1535161 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:53:51,465 p=1535161 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-02-23 22:53:53,454 p=1535161 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-02-23 22:53:53,455 p=1535161 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-02-23 22:53:53,646 p=1535161 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:53:54,248 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:54,249 p=1535161 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-02-23 22:53:54,591 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:54,592 p=1535161 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 22:53:55,978 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:55,979 p=1535161 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 22:53:56,552 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:53:56,553 p=1535161 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:53:58,703 p=1535161 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:53:58,704 p=1535161 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-02-23 22:53:58,746 p=1535161 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:53:59,422 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:53:59,422 p=1535161 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:00,814 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:00,815 p=1535161 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 22:54:01,348 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:01,349 p=1535161 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:54:03,139 p=1535161 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 22:54:03,140 p=1535161 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-02-23 22:54:03,221 p=1535161 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:04,184 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:54:04,185 p=1535161 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:05,578 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:54:05,579 p=1535161 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-02-23 22:54:06,466 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:54:06,467 p=1535161 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-02-23 22:54:08,408 p=1535161 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-02-23 22:54:08,409 p=1535161 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:08,874 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:54:08,875 p=1535161 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:09,224 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.4.23 |  229 kB |      true |      false |       106 |       1654 |               1654 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  234 kB |     false |      false |       106 |       1654 |               1654 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.4.23 |  234 kB |     false |      false |       106 |       1654 |               1654 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-02-23 22:54:09,453 p=1535161 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:10,066 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-02-23 22:54:10,067 p=1535161 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:10,120 p=1535161 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-02-23 22:54:10,145 p=1535161 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-02-23 22:54:10,187 p=1535161 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:10,588 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:10,589 p=1535161 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-02-23 22:54:11,231 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:11,232 p=1535161 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-02-23 22:54:11,262 p=1535161 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:11,724 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:11,725 p=1535161 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-02-23 22:54:12,396 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:12,397 p=1535161 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:12,437 p=1535161 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-02-23 22:54:13,927 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:14,006 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:14,007 p=1535161 u=digitd n=ansible INFO| TASK [Create unnecessary directory for certs] ****************************************************************************************************************************************************************************************************
2025-02-23 22:54:14,358 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:14,404 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:14,405 p=1535161 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-02-23 22:54:14,743 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:14,791 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:14,792 p=1535161 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-02-23 22:54:16,723 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:17,438 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:17,440 p=1535161 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-02-23 22:54:18,489 p=1535161 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-02-23 22:54:19,104 p=1535161 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-02-23 22:54:19,105 p=1535161 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-02-23 22:54:20,583 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-02-23 22:54:20,698 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:54:20,700 p=1535161 u=digitd n=ansible INFO| TASK [Pause for initializing of patroni] *********************************************************************************************************************************************************************************************************
2025-02-23 22:54:20,799 p=1535161 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-02-23 22:54:20,843 p=1535161 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-02-23 22:56:21,003 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-02-23 22:56:21,007 p=1535161 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-02-23 22:56:21,050 p=1535161 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 22:56:21,083 p=1535161 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb ----------+---------+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-02-23 22:56:21,116 p=1535161 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-02-23 22:56:21,149 p=1535161 u=digitd n=ansible INFO| db.etcd.lan                : ok=8    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:56:21,183 p=1535161 u=digitd n=ansible INFO| db.master.lan              : ok=20   changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:56:21,216 p=1535161 u=digitd n=ansible INFO| db.slave.lan               : ok=15   changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:56:21,249 p=1535161 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-02-23 22:56:21,283 p=1535161 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 15:47:52,463 p=659398 u=digitd n=ansible INFO| Using /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg as config file
2025-03-01 15:47:52,610 p=659398 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-03-01 15:47:52,614 p=659398 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-03-01 15:47:55,899 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740830385, "cache_updated": false, "changed": false}
2025-03-01 15:48:05,371 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740833281, "cache_updated": true, "changed": false}
2025-03-01 15:48:05,372 p=659398 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:06,868 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "enabled": false, "name": "postgresql", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "systemd-journald.socket postgresql@15-main.service sysinit.target system.slice basic.target", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ConsistsOf": "postgresql@15-main.service", "ControlGroupId": "0", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "PostgreSQL RDBMS", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/postgresql.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "postgresql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1587396608", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "[not set]", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "[not set]", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "postgresql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "PropagatesReloadTo": "postgresql@15-main.service", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "yes", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "no", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "oneshot", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "UtmpMode": "init", "Wants": "postgresql@15-main.service", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity"}}
2025-03-01 15:48:08,384 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "enabled": false, "name": "postgresql", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "systemd-journald.socket postgresql@15-main.service sysinit.target basic.target system.slice", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ConsistsOf": "postgresql@15-main.service", "ControlGroupId": "0", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "PostgreSQL RDBMS", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/postgresql.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "postgresql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1643425792", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "[not set]", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "[not set]", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "postgresql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "PropagatesReloadTo": "postgresql@15-main.service", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "yes", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "no", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "oneshot", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "UtmpMode": "init", "Wants": "postgresql@15-main.service", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity"}}
2025-03-01 15:48:08,385 p=659398 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-03-01 15:48:09,158 p=659398 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:10,656 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "checksum": "e2fedb4e1237da20f4c73b66ef8b9893cbaebc0f", "dest": "/etc/default/etcd", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/default/etcd", "size": 1666, "state": "file", "uid": 0}
2025-03-01 15:48:10,657 p=659398 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 15:48:11,074 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 111, "group": "etcd", "mode": "0770", "owner": "etcd", "path": "/var/lib/etcd", "size": 4096, "state": "directory", "uid": 103}
2025-03-01 15:48:11,075 p=659398 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:13,327 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"cache_update_time": 1740830385, "cache_updated": false, "changed": false}
2025-03-01 15:48:13,328 p=659398 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 15:48:15,800 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:00.774328", "end": "2025-03-01 15:48:15.753002", "msg": "", "rc": 0, "start": "2025-03-01 15:48:14.978674", "stderr": "", "stderr_lines": [], "stdout": "7", "stdout_lines": ["7"]}
2025-03-01 15:48:15,801 p=659398 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 15:48:20,823 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 12:29:46 MSK", "ActiveEnterTimestampMonotonic": "34035263", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "systemd-journald.socket sysinit.target system.slice network.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 12:29:33 MSK", "AssertTimestampMonotonic": "21382807", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "227514565000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 12:29:33 MSK", "ConditionTimestampMonotonic": "21382806", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "1981", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 12:29:34 MSK", "ExecMainHandoffTimestampMonotonic": "21558095", "ExecMainPID": "564", "ExecMainStartTimestamp": "Sat 2025-03-01 12:29:34 MSK", "ExecMainStartTimestampMonotonic": "21461700", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sat 2025-03-01 12:29:34 MSK", "InactiveExitTimestampMonotonic": "21462456", "InvocationID": "2e8a1077edf84fbdadca903b8cf77279", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "564", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1605033984", "MemoryCurrent": "91205632", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "91734016", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 12:29:46 MSK", "StateChangeTimestampMonotonic": "34035263", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "10", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:48:20,825 p=659398 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-03-01 15:48:20,871 p=659398 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:21,578 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "checksum": "4fb16fe2a7b6f713b4a92c9446a9dc1c39660a21", "dest": "/etc/default/etcd", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/default/etcd", "size": 1584, "state": "file", "uid": 0}
2025-03-01 15:48:21,579 p=659398 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:23,559 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"cache_update_time": 1740833281, "cache_updated": false, "changed": false}
2025-03-01 15:48:23,560 p=659398 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 15:48:24,093 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:00.113773", "end": "2025-03-01 15:48:24.042537", "msg": "", "rc": 0, "start": "2025-03-01 15:48:23.928764", "stderr": "", "stderr_lines": [], "stdout": "7", "stdout_lines": ["7"]}
2025-03-01 15:48:24,094 p=659398 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 15:48:29,405 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 12:33:19 MSK", "ActiveEnterTimestampMonotonic": "204733332", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 12:32:00 MSK", "AssertTimestampMonotonic": "126240532", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "200643357000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 12:32:00 MSK", "ConditionTimestampMonotonic": "126240526", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "1938", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 12:32:01 MSK", "ExecMainHandoffTimestampMonotonic": "126821073", "ExecMainPID": "551", "ExecMainStartTimestamp": "Sat 2025-03-01 12:32:00 MSK", "ExecMainStartTimestampMonotonic": "126366862", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 12:32:00 MSK] ; stop_time=[n/a] ; pid=551 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 12:32:00 MSK] ; stop_time=[n/a] ; pid=551 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sat 2025-03-01 12:32:00 MSK", "InactiveExitTimestampMonotonic": "126367685", "InvocationID": "ba32d13c652d455db5ce286b232c5ec1", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "551", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1668341760", "MemoryCurrent": "95821824", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "100970496", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 12:33:19 MSK", "StateChangeTimestampMonotonic": "204733332", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:48:29,406 p=659398 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-03-01 15:48:29,519 p=659398 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:35,225 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "checksum": "60484e138bba76cd1caa22bfb1cb13542ef696b1", "dest": "/etc/default/etcd", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/default/etcd", "size": 1570, "state": "file", "uid": 0}
2025-03-01 15:48:35,226 p=659398 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:48:54,021 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"cache_update_time": 1740833322, "cache_updated": true, "changed": false}
2025-03-01 15:48:54,022 p=659398 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 15:48:55,407 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:00.743277", "end": "2025-03-01 15:48:55.355997", "msg": "", "rc": 0, "start": "2025-03-01 15:48:54.612720", "stderr": "", "stderr_lines": [], "stdout": "7", "stdout_lines": ["7"]}
2025-03-01 15:48:55,408 p=659398 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 15:49:09,068 p=659398 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2025-02-28 16:17:16 MSK", "ActiveEnterTimestampMonotonic": "239237231173", "ActiveExitTimestamp": "Fri 2025-02-28 16:16:54 MSK", "ActiveExitTimestampMonotonic": "239215141690", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Fri 2025-02-28 16:17:03 MSK", "AssertTimestampMonotonic": "239223574971", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1163596484000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2025-02-28 16:17:03 MSK", "ConditionTimestampMonotonic": "239223574969", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "64333", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "20091", "ExecMainStartTimestamp": "Fri 2025-02-28 16:17:03 MSK", "ExecMainStartTimestampMonotonic": "239223584179", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Fri 2025-02-28 16:17:03 MSK] ; stop_time=[n/a] ; pid=20091 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Fri 2025-02-28 16:17:03 MSK] ; stop_time=[n/a] ; pid=20091 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2025-02-28 16:17:02 MSK", "InactiveEnterTimestampMonotonic": "239222307419", "InactiveExitTimestamp": "Fri 2025-02-28 16:17:03 MSK", "InactiveExitTimestampMonotonic": "239223584452", "InvocationID": "566c8ad6fd764a1ab6013b79dc601dcf", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "20091", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "98275328", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2025-02-28 16:17:16 MSK", "StateChangeTimestampMonotonic": "239237231173", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:49:09,069 p=659398 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:09,655 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "--cluster=true", "endpoint", "status", "--write-out=table"], "delta": "0:00:00.075576", "end": "2025-03-01 15:49:09.607436", "msg": "", "rc": 0, "start": "2025-03-01 15:49:09.531860", "stderr": "", "stderr_lines": [], "stdout": "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |\n+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+\n| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.5.16 |  172 kB |      true |      false |      2755 |      34109 |              34109 |        |\n| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  172 kB |     false |      false |      2755 |      34109 |              34109 |        |\n| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.5.16 |  172 kB |     false |      false |      2755 |      34109 |              34109 |        |\n+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "stdout_lines": ["+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |", "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+", "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.5.16 |  172 kB |      true |      false |      2755 |      34109 |              34109 |        |", "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  172 kB |     false |      false |      2755 |      34109 |              34109 |        |", "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.5.16 |  172 kB |     false |      false |      2755 |      34109 |              34109 |        |", "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"]}
2025-03-01 15:49:09,657 p=659398 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:09,752 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.5.16 |  172 kB |      true |      false |      2755 |      34109 |              34109 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  172 kB |     false |      false |      2755 |      34109 |              34109 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.5.16 |  172 kB |     false |      false |      2755 |      34109 |              34109 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-03-01 15:49:09,775 p=659398 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:10,296 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "member", "list", "--write-out=table"], "delta": "0:00:00.020588", "end": "2025-03-01 15:49:10.254630", "msg": "", "rc": 0, "start": "2025-03-01 15:49:10.234042", "stderr": "", "stderr_lines": [], "stdout": "+------------------+---------+----------+--------------------------+--------------------------+------------+\n|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |\n+------------------+---------+----------+--------------------------+--------------------------+------------+\n| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |\n| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |\n| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |\n+------------------+---------+----------+--------------------------+--------------------------+------------+", "stdout_lines": ["+------------------+---------+----------+--------------------------+--------------------------+------------+", "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |", "+------------------+---------+----------+--------------------------+--------------------------+------------+", "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |", "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |", "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |", "+------------------+---------+----------+--------------------------+--------------------------+------------+"]}
2025-03-01 15:49:10,297 p=659398 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:10,343 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-03-01 15:49:10,367 p=659398 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-03-01 15:49:10,401 p=659398 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:10,880 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/patroni", "size": 4096, "state": "directory", "uid": 0}
2025-03-01 15:49:10,881 p=659398 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-03-01 15:49:11,643 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "checksum": "d539f05dee13bd527e251e234f60249b97932999", "dest": "/etc/patroni/config.yml", "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/etc/patroni/config.yml", "size": 3575, "state": "file", "uid": 102}
2025-03-01 15:49:11,644 p=659398 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-03-01 15:49:11,742 p=659398 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:12,149 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/patroni", "size": 4096, "state": "directory", "uid": 0}
2025-03-01 15:49:12,149 p=659398 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-03-01 15:49:12,892 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "checksum": "ad9f4bcdc347e99b30b1da7dee192a0e2903636c", "dest": "/etc/patroni/config.yml", "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/etc/patroni/config.yml", "size": 3370, "state": "file", "uid": 103}
2025-03-01 15:49:12,893 p=659398 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:12,983 p=659398 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-03-01 15:49:14,788 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"cache_update_time": 1740833281, "cache_updated": false, "changed": false}
2025-03-01 15:49:14,909 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"cache_update_time": 1740830385, "cache_updated": false, "changed": false}
2025-03-01 15:49:14,910 p=659398 u=digitd n=ansible INFO| TASK [Create necessary directory for certs] ******************************************************************************************************************************************************************************************************
2025-03-01 15:49:15,309 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/ssl", "size": 4096, "state": "directory", "uid": 103}
2025-03-01 15:49:15,320 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/ssl", "size": 4096, "state": "directory", "uid": 102}
2025-03-01 15:49:15,341 p=659398 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-03-01 15:49:15,798 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/data", "size": 4096, "state": "directory", "uid": 103}
2025-03-01 15:49:15,809 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/data", "size": 4096, "state": "directory", "uid": 102}
2025-03-01 15:49:15,866 p=659398 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-03-01 15:49:18,489 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "dest": "/var/lib/postgresql/15/ssl/", "src": "/run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/../../certs/"}
2025-03-01 15:49:18,490 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "dest": "/var/lib/postgresql/15/ssl/", "src": "/run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/../../certs/"}
2025-03-01 15:49:18,524 p=659398 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-03-01 15:49:20,839 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "enabled": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 12:38:06 MSK", "ActiveEnterTimestampMonotonic": "492151231", "ActiveExitTimestamp": "Sat 2025-03-01 12:37:33 MSK", "ActiveExitTimestampMonotonic": "459413399", "ActiveState": "active", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 12:38:06 MSK", "AssertTimestampMonotonic": "492145311", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "61086664000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 12:38:06 MSK", "ConditionTimestampMonotonic": "492145271", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "6103", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 12:38:06 MSK", "ExecMainHandoffTimestampMonotonic": "492172472", "ExecMainPID": "1547", "ExecMainStartTimestamp": "Sat 2025-03-01 12:38:06 MSK", "ExecMainStartTimestampMonotonic": "492147461", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 12:38:06 MSK] ; stop_time=[n/a] ; pid=1547 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 12:38:06 MSK] ; stop_time=[n/a] ; pid=1547 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "111", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 12:37:34 MSK", "InactiveEnterTimestampMonotonic": "459721037", "InactiveExitTimestamp": "Sat 2025-03-01 12:38:06 MSK", "InactiveExitTimestampMonotonic": "492151231", "InvocationID": "6588a716d9084ef8a2f96eef922991cc", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "1547", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1663258624", "MemoryCurrent": "182558720", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "186281984", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 12:38:06 MSK", "StateChangeTimestampMonotonic": "492151231", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "14", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:49:34,223 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "enabled": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 12:29:34 MSK", "ActiveEnterTimestampMonotonic": "21521800", "ActiveExitTimestampMonotonic": "0", "ActiveState": "active", "After": "sysinit.target system.slice systemd-journald.socket network.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 12:29:34 MSK", "AssertTimestampMonotonic": "21518965", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "65204723000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 12:29:34 MSK", "ConditionTimestampMonotonic": "21462534", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "2024", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 12:29:34 MSK", "ExecMainHandoffTimestampMonotonic": "21557584", "ExecMainPID": "573", "ExecMainStartTimestamp": "Sat 2025-03-01 12:29:34 MSK", "ExecMainStartTimestampMonotonic": "21520779", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "110", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestamp": "Sat 2025-03-01 12:29:34 MSK", "InactiveExitTimestampMonotonic": "21521800", "InvocationID": "6cd100da19de4ffd88fed81c6157b6f2", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "573", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1584427008", "MemoryCurrent": "160305152", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "294887424", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 12:29:34 MSK", "StateChangeTimestampMonotonic": "21521800", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "17", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "102", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:49:34,224 p=659398 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 15:49:34,587 p=659398 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 15:49:34,805 p=659398 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 15:51:35,508 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "delta": 120, "echo": true, "rc": 0, "start": "2025-03-01 15:49:34.586909", "stderr": "", "stdout": "Paused for 2.02 minutes", "stop": "2025-03-01 15:51:35.506597", "user_input": ""}
2025-03-01 15:51:35,511 p=659398 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 15:51:37,944 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": "0:00:00.716156", "end": "2025-03-01 15:51:37.907255", "msg": "", "rc": 0, "start": "2025-03-01 15:51:37.191099", "stderr": "", "stderr_lines": [], "stdout": "+ Cluster: clusterdb (7476458571512684081) --------+----+-----------+\n| Member   | Host              | Role    | State   | TL | Lag in MB |\n+----------+-------------------+---------+---------+----+-----------+\n| masterdb | 192.168.2.16:5050 | Replica | running | 11 |         0 |\n| slavedb  | 192.168.2.17:5050 | Leader  | running | 12 |           |\n+----------+-------------------+---------+---------+----+-----------+", "stdout_lines": ["+ Cluster: clusterdb (7476458571512684081) --------+----+-----------+", "| Member   | Host              | Role    | State   | TL | Lag in MB |", "+----------+-------------------+---------+---------+----+-----------+", "| masterdb | 192.168.2.16:5050 | Replica | running | 11 |         0 |", "| slavedb  | 192.168.2.17:5050 | Leader  | running | 12 |           |", "+----------+-------------------+---------+---------+----+-----------+"]}
2025-03-01 15:51:38,147 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": "0:00:00.922540", "end": "2025-03-01 15:51:38.112405", "msg": "", "rc": 0, "start": "2025-03-01 15:51:37.189865", "stderr": "", "stderr_lines": [], "stdout": "+ Cluster: clusterdb (7476458571512684081) --------+----+-----------+\n| Member   | Host              | Role    | State   | TL | Lag in MB |\n+----------+-------------------+---------+---------+----+-----------+\n| masterdb | 192.168.2.16:5050 | Replica | running | 11 |         0 |\n| slavedb  | 192.168.2.17:5050 | Leader  | running | 12 |           |\n+----------+-------------------+---------+---------+----+-----------+", "stdout_lines": ["+ Cluster: clusterdb (7476458571512684081) --------+----+-----------+", "| Member   | Host              | Role    | State   | TL | Lag in MB |", "+----------+-------------------+---------+---------+----+-----------+", "| masterdb | 192.168.2.16:5050 | Replica | running | 11 |         0 |", "| slavedb  | 192.168.2.17:5050 | Leader  | running | 12 |           |", "+----------+-------------------+---------+---------+----+-----------+"]}
2025-03-01 15:51:38,148 p=659398 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:38,207 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb (7476458571512684081) --------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | running | 11 |         0 |",
        "| slavedb  | 192.168.2.17:5050 | Leader  | running | 12 |           |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 15:51:38,229 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb (7476458571512684081) --------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | running | 11 |         0 |",
        "| slavedb  | 192.168.2.17:5050 | Leader  | running | 12 |           |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 15:51:38,263 p=659398 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:38,305 p=659398 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:43,120 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "patroni", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ActiveEnterTimestampMonotonic": "12020658033", "ActiveExitTimestamp": "Sat 2025-03-01 15:49:19 MSK", "ActiveExitTimestampMonotonic": "12006205956", "ActiveState": "active", "After": "sysinit.target system.slice systemd-journald.socket network.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:49:34 MSK", "AssertTimestampMonotonic": "12020655979", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "6724988000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ConditionTimestampMonotonic": "12020655970", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "3955", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ExecMainHandoffTimestampMonotonic": "12020684540", "ExecMainPID": "26719", "ExecMainStartTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ExecMainStartTimestampMonotonic": "12020656966", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:49:34 MSK] ; stop_time=[n/a] ; pid=26719 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:49:34 MSK] ; stop_time=[n/a] ; pid=26719 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "110", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:49:34 MSK", "InactiveEnterTimestampMonotonic": "12020654321", "InactiveExitTimestamp": "Sat 2025-03-01 15:49:34 MSK", "InactiveExitTimestampMonotonic": "12020658033", "InvocationID": "bb2f11fd9c554974961585c6ea7136dd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "26719", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1572028416", "MemoryCurrent": "74915840", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "79446016", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:49:34 MSK", "StateChangeTimestampMonotonic": "12020658033", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "13", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "102", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:50,270 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "patroni", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ActiveEnterTimestampMonotonic": "11966232527", "ActiveExitTimestamp": "Sat 2025-03-01 15:49:19 MSK", "ActiveExitTimestampMonotonic": "11965146463", "ActiveState": "active", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:49:20 MSK", "AssertTimestampMonotonic": "11966230771", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "3017776000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ConditionTimestampMonotonic": "11966230760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "122895", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ExecMainHandoffTimestampMonotonic": "11966248667", "ExecMainPID": "30829", "ExecMainStartTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ExecMainStartTimestampMonotonic": "11966231690", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:49:20 MSK] ; stop_time=[n/a] ; pid=30829 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:49:20 MSK] ; stop_time=[n/a] ; pid=30829 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "111", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:49:20 MSK", "InactiveEnterTimestampMonotonic": "11966229270", "InactiveExitTimestamp": "Sat 2025-03-01 15:49:20 MSK", "InactiveExitTimestampMonotonic": "11966232527", "InvocationID": "f63f93b3c11a4dd89f890d8a38176ae7", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "30829", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1672011776", "MemoryCurrent": "84959232", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "92217344", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:49:20 MSK", "StateChangeTimestampMonotonic": "11966232527", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "16", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:50,271 p=659398 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 15:51:50,389 p=659398 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 15:51:51,104 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:00.254892", "end": "2025-03-01 15:51:51.054415", "msg": "", "rc": 0, "start": "2025-03-01 15:51:50.799523", "stderr": "", "stderr_lines": [], "stdout": "6", "stdout_lines": ["6"]}
2025-03-01 15:51:51,292 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:00.383501", "end": "2025-03-01 15:51:51.192620", "msg": "", "rc": 0, "start": "2025-03-01 15:51:50.809119", "stderr": "", "stderr_lines": [], "stdout": "0", "stdout_lines": ["0"]}
2025-03-01 15:51:52,310 p=659398 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:00.233187", "end": "2025-03-01 15:51:52.260912", "msg": "", "rc": 0, "start": "2025-03-01 15:51:52.027725", "stderr": "", "stderr_lines": [], "stdout": "0", "stdout_lines": ["0"]}
2025-03-01 15:51:52,310 p=659398 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:53,773 p=659398 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:49:08 MSK", "ActiveEnterTimestampMonotonic": "323949218914", "ActiveExitTimestamp": "Sat 2025-03-01 15:49:01 MSK", "ActiveExitTimestampMonotonic": "323941444069", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:49:03 MSK", "AssertTimestampMonotonic": "323943518875", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "2231842000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:49:03 MSK", "ConditionTimestampMonotonic": "323943518870", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "103969", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "29278", "ExecMainStartTimestamp": "Sat 2025-03-01 15:49:03 MSK", "ExecMainStartTimestampMonotonic": "323943532444", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:49:03 MSK] ; stop_time=[n/a] ; pid=29278 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:49:03 MSK] ; stop_time=[n/a] ; pid=29278 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:49:03 MSK", "InactiveEnterTimestampMonotonic": "323943517416", "InactiveExitTimestamp": "Sat 2025-03-01 15:49:03 MSK", "InactiveExitTimestampMonotonic": "323943532984", "InvocationID": "c3ecb84ce54a471c9f248c2b9c93f88d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "29278", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "54632448", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:49:08 MSK", "StateChangeTimestampMonotonic": "323949218914", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:55,028 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:48:20 MSK", "ActiveEnterTimestampMonotonic": "11947251243", "ActiveExitTimestamp": "Sat 2025-03-01 15:48:17 MSK", "ActiveExitTimestampMonotonic": "11943885878", "ActiveState": "active", "After": "systemd-journald.socket sysinit.target system.slice network.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:48:19 MSK", "AssertTimestampMonotonic": "11946172333", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "4486069000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:48:19 MSK", "ConditionTimestampMonotonic": "11946172293", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "3912", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:48:19 MSK", "ExecMainHandoffTimestampMonotonic": "11946208881", "ExecMainPID": "26116", "ExecMainStartTimestamp": "Sat 2025-03-01 15:48:19 MSK", "ExecMainStartTimestampMonotonic": "11946174742", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:48:19 MSK] ; stop_time=[n/a] ; pid=26116 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:48:19 MSK] ; stop_time=[n/a] ; pid=26116 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:48:19 MSK", "InactiveEnterTimestampMonotonic": "11946169642", "InactiveExitTimestamp": "Sat 2025-03-01 15:48:19 MSK", "InactiveExitTimestampMonotonic": "11946176240", "InvocationID": "644baea069b84ef3958adf910cde0898", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "26116", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1637896192", "MemoryCurrent": "50831360", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "53440512", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:48:20 MSK", "StateChangeTimestampMonotonic": "11947251243", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:55,164 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:48:29 MSK", "ActiveEnterTimestampMonotonic": "11914792289", "ActiveExitTimestamp": "Sat 2025-03-01 15:48:25 MSK", "ActiveExitTimestampMonotonic": "11911031668", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:48:26 MSK", "AssertTimestampMonotonic": "11912154545", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "3740531000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:48:26 MSK", "ConditionTimestampMonotonic": "11912154513", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "122336", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:48:26 MSK", "ExecMainHandoffTimestampMonotonic": "11912184667", "ExecMainPID": "30194", "ExecMainStartTimestamp": "Sat 2025-03-01 15:48:26 MSK", "ExecMainStartTimestampMonotonic": "11912156716", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:48:26 MSK] ; stop_time=[n/a] ; pid=30194 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:48:26 MSK] ; stop_time=[n/a] ; pid=30194 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:48:26 MSK", "InactiveEnterTimestampMonotonic": "11912152290", "InactiveExitTimestamp": "Sat 2025-03-01 15:48:26 MSK", "InactiveExitTimestampMonotonic": "11912158549", "InvocationID": "25d7e73817004b6c8ad1607fa726df67", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "30194", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1735856128", "MemoryCurrent": "46333952", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "46866432", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:48:29 MSK", "StateChangeTimestampMonotonic": "11914792289", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:55,165 p=659398 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:58,498 p=659398 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:49:08 MSK", "ActiveEnterTimestampMonotonic": "323949218914", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "324113636288", "ActiveState": "inactive", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:49:03 MSK", "AssertTimestampMonotonic": "323943518875", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "2241282000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:49:03 MSK", "ConditionTimestampMonotonic": "323943518870", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "103969", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "2", "ExecMainExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ExecMainExitTimestampMonotonic": "324113951965", "ExecMainPID": "29278", "ExecMainStartTimestamp": "Sat 2025-03-01 15:49:03 MSK", "ExecMainStartTimestampMonotonic": "323943532444", "ExecMainStatus": "15", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:49:03 MSK] ; stop_time=[Sat 2025-03-01 15:51:53 MSK] ; pid=29278 ; code=killed ; status=15/TERM }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:49:03 MSK] ; stop_time=[Sat 2025-03-01 15:51:53 MSK] ; pid=29278 ; code=killed ; status=15/TERM }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:53 MSK", "InactiveEnterTimestampMonotonic": "324113952374", "InactiveExitTimestamp": "Sat 2025-03-01 15:49:03 MSK", "InactiveExitTimestampMonotonic": "323943532984", "InvocationID": "c3ecb84ce54a471c9f248c2b9c93f88d", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:51:53 MSK", "StateChangeTimestampMonotonic": "324113952374", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:58,502 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:48:20 MSK", "ActiveEnterTimestampMonotonic": "11947251243", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12159973348", "ActiveState": "inactive", "After": "systemd-journald.socket sysinit.target system.slice network.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:48:19 MSK", "AssertTimestampMonotonic": "11946172333", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "4503065000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:48:19 MSK", "ConditionTimestampMonotonic": "11946172293", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "3912", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "2", "ExecMainExitTimestamp": "Sat 2025-03-01 15:51:54 MSK", "ExecMainExitTimestampMonotonic": "12161443562", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:48:19 MSK", "ExecMainHandoffTimestampMonotonic": "11946208881", "ExecMainPID": "26116", "ExecMainStartTimestamp": "Sat 2025-03-01 15:48:19 MSK", "ExecMainStartTimestampMonotonic": "11946174742", "ExecMainStatus": "15", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:48:19 MSK] ; stop_time=[Sat 2025-03-01 15:51:54 MSK] ; pid=26116 ; code=killed ; status=15/TERM }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:48:19 MSK] ; stop_time=[Sat 2025-03-01 15:51:54 MSK] ; pid=26116 ; code=killed ; status=15/TERM }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:54 MSK", "InactiveEnterTimestampMonotonic": "12161444043", "InactiveExitTimestamp": "Sat 2025-03-01 15:48:19 MSK", "InactiveExitTimestampMonotonic": "11946176240", "InvocationID": "644baea069b84ef3958adf910cde0898", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1675329536", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "53440512", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:54 MSK", "StateChangeTimestampMonotonic": "12161444043", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:58,622 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:48:29 MSK", "ActiveEnterTimestampMonotonic": "11914792289", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12118925011", "ActiveState": "inactive", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:48:26 MSK", "AssertTimestampMonotonic": "11912154545", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "3758748000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:48:26 MSK", "ConditionTimestampMonotonic": "11912154513", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "122336", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "2", "ExecMainExitTimestamp": "Sat 2025-03-01 15:51:55 MSK", "ExecMainExitTimestampMonotonic": "12120510515", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:48:26 MSK", "ExecMainHandoffTimestampMonotonic": "11912184667", "ExecMainPID": "30194", "ExecMainStartTimestamp": "Sat 2025-03-01 15:48:26 MSK", "ExecMainStartTimestampMonotonic": "11912156716", "ExecMainStatus": "15", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:48:26 MSK] ; stop_time=[Sat 2025-03-01 15:51:55 MSK] ; pid=30194 ; code=killed ; status=15/TERM }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:48:26 MSK] ; stop_time=[Sat 2025-03-01 15:51:55 MSK] ; pid=30194 ; code=killed ; status=15/TERM }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:55 MSK", "InactiveEnterTimestampMonotonic": "12120510940", "InactiveExitTimestamp": "Sat 2025-03-01 15:48:26 MSK", "InactiveExitTimestampMonotonic": "11912158549", "InvocationID": "25d7e73817004b6c8ad1607fa726df67", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1778913280", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "48721920", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:55 MSK", "StateChangeTimestampMonotonic": "12120510940", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:51:58,662 p=659398 u=digitd n=ansible INFO| PLAY [Delete Patroni files] **********************************************************************************************************************************************************************************************************************
2025-03-01 15:51:58,771 p=659398 u=digitd n=ansible INFO| TASK [Remove files] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:59,377 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "cmd": ["trash-put", "/var/lib/postgresql/15/data"], "delta": "0:00:00.166220", "end": "2025-03-01 15:51:59.327772", "msg": "", "rc": 0, "start": "2025-03-01 15:51:59.161552", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 15:51:59,625 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "cmd": ["trash-put", "/var/lib/postgresql/15/data"], "delta": "0:00:00.414876", "end": "2025-03-01 15:51:59.578894", "msg": "", "rc": 0, "start": "2025-03-01 15:51:59.164018", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 15:51:59,626 p=659398 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:51:59,729 p=659398 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 15:52:00,977 p=659398 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ActiveEnterTimestampMonotonic": "11966232527", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12104847788", "ActiveState": "inactive", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:49:20 MSK", "AssertTimestampMonotonic": "11966230771", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "3440775000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ConditionTimestampMonotonic": "11966230760", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "122895", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sat 2025-03-01 15:51:50 MSK", "ExecMainExitTimestampMonotonic": "12115669279", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ExecMainHandoffTimestampMonotonic": "11966248667", "ExecMainPID": "30829", "ExecMainStartTimestamp": "Sat 2025-03-01 15:49:20 MSK", "ExecMainStartTimestampMonotonic": "11966231690", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:49:20 MSK] ; stop_time=[Sat 2025-03-01 15:51:50 MSK] ; pid=30829 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:49:20 MSK] ; stop_time=[Sat 2025-03-01 15:51:50 MSK] ; pid=30829 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:50 MSK", "InactiveEnterTimestampMonotonic": "12115669410", "InactiveExitTimestamp": "Sat 2025-03-01 15:49:20 MSK", "InactiveExitTimestampMonotonic": "11966232527", "InvocationID": "f63f93b3c11a4dd89f890d8a38176ae7", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1720147968", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "95715328", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:50 MSK", "StateChangeTimestampMonotonic": "12115669410", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:52:00,990 p=659398 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ActiveEnterTimestampMonotonic": "12020658033", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12145865686", "ActiveState": "inactive", "After": "sysinit.target system.slice systemd-journald.socket network.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:49:34 MSK", "AssertTimestampMonotonic": "12020655979", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "6837900000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ConditionTimestampMonotonic": "12020655970", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "3955", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sat 2025-03-01 15:51:43 MSK", "ExecMainExitTimestampMonotonic": "12149564571", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ExecMainHandoffTimestampMonotonic": "12020684540", "ExecMainPID": "26719", "ExecMainStartTimestamp": "Sat 2025-03-01 15:49:34 MSK", "ExecMainStartTimestampMonotonic": "12020656966", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:49:34 MSK] ; stop_time=[Sat 2025-03-01 15:51:43 MSK] ; pid=26719 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:49:34 MSK] ; stop_time=[Sat 2025-03-01 15:51:43 MSK] ; pid=26719 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:43 MSK", "InactiveEnterTimestampMonotonic": "12149564853", "InactiveExitTimestamp": "Sat 2025-03-01 15:49:34 MSK", "InactiveExitTimestampMonotonic": "12020658033", "InvocationID": "bb2f11fd9c554974961585c6ea7136dd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1666371584", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "79446016", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:43 MSK", "StateChangeTimestampMonotonic": "12149564853", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:52:01,011 p=659398 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 15:52:02,591 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": "0:00:01.113323", "end": "2025-03-01 15:52:02.546012", "msg": "", "rc": 0, "start": "2025-03-01 15:52:01.432689", "stderr": "", "stderr_lines": [], "stdout": "+ Cluster: clusterdb (uninitialized) ---+---------+----+-----------+\n| Member  | Host              | Role    | State   | TL | Lag in MB |\n+---------+-------------------+---------+---------+----+-----------+\n| slavedb | 192.168.2.17:5050 | Replica | stopped |    |   unknown |\n+---------+-------------------+---------+---------+----+-----------+", "stdout_lines": ["+ Cluster: clusterdb (uninitialized) ---+---------+----+-----------+", "| Member  | Host              | Role    | State   | TL | Lag in MB |", "+---------+-------------------+---------+---------+----+-----------+", "| slavedb | 192.168.2.17:5050 | Replica | stopped |    |   unknown |", "+---------+-------------------+---------+---------+----+-----------+"]}
2025-03-01 15:52:03,628 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": "0:00:02.108476", "end": "2025-03-01 15:52:03.589263", "msg": "", "rc": 0, "start": "2025-03-01 15:52:01.480787", "stderr": "", "stderr_lines": [], "stdout": "+ Cluster: clusterdb (initializing) -----+---------+----+-----------+\n| Member   | Host              | Role    | State   | TL | Lag in MB |\n+----------+-------------------+---------+---------+----+-----------+\n| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |\n| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |\n+----------+-------------------+---------+---------+----+-----------+", "stdout_lines": ["+ Cluster: clusterdb (initializing) -----+---------+----+-----------+", "| Member   | Host              | Role    | State   | TL | Lag in MB |", "+----------+-------------------+---------+---------+----+-----------+", "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |", "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |", "+----------+-------------------+---------+---------+----+-----------+"]}
2025-03-01 15:52:03,630 p=659398 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 15:52:03,768 p=659398 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 15:52:03,818 p=659398 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 15:54:03,921 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "delta": 120, "echo": true, "rc": 0, "start": "2025-03-01 15:52:03.767726", "stderr": "", "stdout": "Paused for 2.0 minutes", "stop": "2025-03-01 15:54:03.920030", "user_input": ""}
2025-03-01 15:54:03,924 p=659398 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 15:54:03,962 p=659398 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb (initializing) -----+---------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Replica | stopped |    |   unknown |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 15:54:03,984 p=659398 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb (uninitialized) ---+---------+----+-----------+",
        "| Member  | Host              | Role    | State   | TL | Lag in MB |",
        "+---------+-------------------+---------+---------+----+-----------+",
        "| slavedb | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+---------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 15:54:04,060 p=659398 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-03-01 15:54:04,094 p=659398 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-03-01 15:54:23,241 p=659398 u=digitd n=ansible INFO| ok: [db.test.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740833648, "cache_updated": true, "changed": false}
2025-03-01 15:54:23,242 p=659398 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-03-01 15:54:25,310 p=659398 u=digitd n=ansible INFO| ok: [db.test.lan] => {"changed": false, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ActiveEnterTimestampMonotonic": "424591796727", "ActiveExitTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ActiveExitTimestampMonotonic": "424591690587", "ActiveState": "active", "After": "sysinit.target systemd-journald.socket network-online.target rsyslog.service basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Fri 2025-02-28 16:20:04 MSK", "AssertTimestampMonotonic": "424591697269", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "61771459000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ConditionTimestampMonotonic": "424591697266", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "11350", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "12656", "ExecMainStartTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ExecMainStartTimestampMonotonic": "424591704227", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Fri 2025-02-28 16:20:04 MSK] ; stop_time=[n/a] ; pid=12656 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Fri 2025-02-28 16:20:04 MSK] ; stop_time=[n/a] ; pid=12656 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2025-02-28 16:20:04 MSK", "InactiveEnterTimestampMonotonic": "424591691310", "InactiveExitTimestamp": "Fri 2025-02-28 16:20:04 MSK", "InactiveExitTimestampMonotonic": "424591704597", "InvocationID": "4c9da49cb29f4093956d43b45a6bef3b", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "12656", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "42156032", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2025-02-28 16:20:04 MSK", "StateChangeTimestampMonotonic": "424591796727", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:54:25,311 p=659398 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-03-01 15:54:25,409 p=659398 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-03-01 15:54:26,106 p=659398 u=digitd n=ansible INFO| ok: [db.test.lan] => {"changed": false, "checksum": "81dc5834c94a75fd36d7fd78e0e93a8898b82b23", "dest": "/etc/haproxy/haproxy.cfg", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/haproxy/haproxy.cfg", "size": 2381, "state": "file", "uid": 0}
2025-03-01 15:54:27,292 p=659398 u=digitd n=ansible INFO| ok: [db.test1.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "checksum": "81dc5834c94a75fd36d7fd78e0e93a8898b82b23", "dest": "/etc/haproxy/haproxy.cfg", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/haproxy/haproxy.cfg", "size": 2381, "state": "file", "uid": 0}
2025-03-01 15:54:27,293 p=659398 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-03-01 15:54:28,430 p=659398 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ActiveEnterTimestampMonotonic": "424585216567", "ActiveExitTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ActiveExitTimestampMonotonic": "424585119700", "ActiveState": "active", "After": "network-online.target rsyslog.service system.slice systemd-journald.socket sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Fri 2025-02-28 16:20:04 MSK", "AssertTimestampMonotonic": "424585125204", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "62245339000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ConditionTimestampMonotonic": "424585125202", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "10695", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "10483", "ExecMainStartTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ExecMainStartTimestampMonotonic": "424585132175", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Fri 2025-02-28 16:20:04 MSK] ; stop_time=[n/a] ; pid=10483 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Fri 2025-02-28 16:20:04 MSK] ; stop_time=[n/a] ; pid=10483 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2025-02-28 16:20:04 MSK", "InactiveEnterTimestampMonotonic": "424585124444", "InactiveExitTimestamp": "Fri 2025-02-28 16:20:04 MSK", "InactiveExitTimestampMonotonic": "424585132457", "InvocationID": "60bf8062d99140e4906d6781c341c142", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "10483", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "45891584", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2025-02-28 16:20:04 MSK", "StateChangeTimestampMonotonic": "424585216567", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:54:29,061 p=659398 u=digitd n=ansible INFO| changed: [db.test.lan] => {"changed": true, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ActiveEnterTimestampMonotonic": "424591796727", "ActiveExitTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ActiveExitTimestampMonotonic": "424591690587", "ActiveState": "active", "After": "sysinit.target systemd-journald.socket network-online.target rsyslog.service basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Fri 2025-02-28 16:20:04 MSK", "AssertTimestampMonotonic": "424591697269", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "61773117000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ConditionTimestampMonotonic": "424591697266", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "11350", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "12656", "ExecMainStartTimestamp": "Fri 2025-02-28 16:20:04 MSK", "ExecMainStartTimestampMonotonic": "424591704227", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Fri 2025-02-28 16:20:04 MSK] ; stop_time=[n/a] ; pid=12656 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Fri 2025-02-28 16:20:04 MSK] ; stop_time=[n/a] ; pid=12656 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2025-02-28 16:20:04 MSK", "InactiveEnterTimestampMonotonic": "424591691310", "InactiveExitTimestamp": "Fri 2025-02-28 16:20:04 MSK", "InactiveExitTimestampMonotonic": "424591704597", "InvocationID": "4c9da49cb29f4093956d43b45a6bef3b", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "12656", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "42156032", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2025-02-28 16:20:04 MSK", "StateChangeTimestampMonotonic": "424591796727", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:54:29,063 p=659398 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 15:54:29,092 p=659398 u=digitd n=ansible INFO| TASK [Copy conf on MASTER HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 15:54:30,217 p=659398 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "checksum": "677c26d3f87945325221597e7a31ef65a2c85fe4", "dest": "/etc/keepalived/keepalived.conf", "gid": 0, "group": "root", "md5sum": "01456f23cdb34829851274794461a3c4", "mode": "0644", "owner": "root", "size": 265, "src": "/root/.ansible/tmp/ansible-tmp-1740833669.5718048-671428-166238443083830/.source.conf", "state": "file", "uid": 0}
2025-03-01 15:54:30,218 p=659398 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-03-01 15:54:32,375 p=659398 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "keepalived", "state": "started", "status": {"ActiveEnterTimestamp": "Fri 2025-02-28 16:20:10 MSK", "ActiveEnterTimestampMonotonic": "424591477704", "ActiveExitTimestamp": "Fri 2025-02-28 16:20:09 MSK", "ActiveExitTimestampMonotonic": "424590433675", "ActiveState": "active", "After": "systemd-journald.socket network-online.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Fri 2025-02-28 16:20:10 MSK", "AssertTimestampMonotonic": "424591449510", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "9294062000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Fri 2025-02-28 16:20:10 MSK", "ConditionTimestampMonotonic": "424591449492", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/keepalived.service", "ControlGroupId": "10773", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Keepalive Daemon (LVS and VRRP)", "DevicePolicy": "auto", "Documentation": "\"man:keepalived(8)\" \"man:keepalived.conf(5)\" \"man:genhash(1)\" https://keepalived.org", "DynamicUser": "no", "EnvironmentFiles": "/etc/default/keepalived (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "10684", "ExecMainStartTimestamp": "Fri 2025-02-28 16:20:10 MSK", "ExecMainStartTimestampMonotonic": "424591456422", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; ignore_errors=no ; start_time=[Fri 2025-02-28 16:20:10 MSK] ; stop_time=[n/a] ; pid=10684 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; flags= ; start_time=[Fri 2025-02-28 16:20:10 MSK] ; stop_time=[n/a] ; pid=10684 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/keepalived.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "keepalived.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Fri 2025-02-28 16:20:10 MSK", "InactiveEnterTimestampMonotonic": "424591448405", "InactiveExitTimestamp": "Fri 2025-02-28 16:20:10 MSK", "InactiveExitTimestampMonotonic": "424591460407", "InvocationID": "bf408a35bad848a4a7219bd3c7c76655", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "10684", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "2048000", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "keepalived.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Fri 2025-02-28 16:20:10 MSK", "StateChangeTimestampMonotonic": "424591477704", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:54:32,376 p=659398 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 15:54:32,417 p=659398 u=digitd n=ansible INFO| TASK [Copy conf on BACKUP HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 15:54:33,184 p=659398 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "checksum": "525508afcada704b949ed1aaa9e0840d11bd6a64", "dest": "/etc/keepalived/keepalived.conf", "gid": 0, "group": "root", "md5sum": "fa6638d71b40284902d93f9d508df66a", "mode": "0644", "owner": "root", "size": 264, "src": "/root/.ansible/tmp/ansible-tmp-1740833672.5804942-671512-102888181532216/.source.conf", "state": "file", "uid": 0}
2025-03-01 15:54:33,185 p=659398 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-03-01 15:54:35,326 p=659398 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "keepalived", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:54:32 MSK", "ActiveEnterTimestampMonotonic": "509453079430", "ActiveExitTimestamp": "Sat 2025-03-01 15:54:31 MSK", "ActiveExitTimestampMonotonic": "509452033286", "ActiveState": "active", "After": "systemd-journald.socket network-online.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:54:32 MSK", "AssertTimestampMonotonic": "509453049745", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "18321000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:54:32 MSK", "ConditionTimestampMonotonic": "509453049728", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/keepalived.service", "ControlGroupId": "12118", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Keepalive Daemon (LVS and VRRP)", "DevicePolicy": "auto", "Documentation": "\"man:keepalived(8)\" \"man:keepalived.conf(5)\" \"man:genhash(1)\" https://keepalived.org", "DynamicUser": "no", "EnvironmentFiles": "/etc/default/keepalived (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "11866", "ExecMainStartTimestamp": "Sat 2025-03-01 15:54:32 MSK", "ExecMainStartTimestampMonotonic": "509453056456", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:54:32 MSK] ; stop_time=[n/a] ; pid=11866 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:54:32 MSK] ; stop_time=[n/a] ; pid=11866 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/keepalived.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "keepalived.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:54:32 MSK", "InactiveEnterTimestampMonotonic": "509453048690", "InactiveExitTimestamp": "Sat 2025-03-01 15:54:32 MSK", "InactiveExitTimestampMonotonic": "509453060427", "InvocationID": "25cc77d91a6f4e8e83538601ca8f2d9e", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "11866", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "2068480", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "keepalived.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:54:32 MSK", "StateChangeTimestampMonotonic": "509453079430", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 15:54:35,327 p=659398 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 15:54:35,373 p=659398 u=digitd n=ansible INFO| db.etcd.lan                : ok=11   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 15:54:35,406 p=659398 u=digitd n=ansible INFO| db.master.lan              : ok=26   changed=8    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 15:54:35,440 p=659398 u=digitd n=ansible INFO| db.slave.lan               : ok=23   changed=8    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 15:54:35,531 p=659398 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 15:54:35,573 p=659398 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 16:22:23,538 p=722802 u=digitd n=ansible INFO| Using /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg as config file
2025-03-01 16:22:23,683 p=722802 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-03-01 16:22:23,686 p=722802 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:26,234 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740833281, "cache_updated": true, "changed": false}
2025-03-01 16:22:26,906 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740830385, "cache_updated": true, "changed": false}
2025-03-01 16:22:26,907 p=722802 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:28,303 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "enabled": false, "name": "postgresql", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "systemd-journald.socket basic.target system.slice sysinit.target postgresql@15-main.service", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ConsistsOf": "postgresql@15-main.service", "ControlGroupId": "0", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "PostgreSQL RDBMS", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/postgresql.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "postgresql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1573597184", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "[not set]", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "[not set]", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "postgresql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "PropagatesReloadTo": "postgresql@15-main.service", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "yes", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "no", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "oneshot", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "UtmpMode": "init", "Wants": "postgresql@15-main.service", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity"}}
2025-03-01 16:22:28,362 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "enabled": false, "name": "postgresql", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "system.slice sysinit.target systemd-journald.socket postgresql@15-main.service basic.target", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ConsistsOf": "postgresql@15-main.service", "ControlGroupId": "0", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "PostgreSQL RDBMS", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/postgresql.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "postgresql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1641684992", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "[not set]", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "[not set]", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "postgresql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "PropagatesReloadTo": "postgresql@15-main.service", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "yes", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "no", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "oneshot", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "UtmpMode": "init", "Wants": "postgresql@15-main.service", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity"}}
2025-03-01 16:22:28,364 p=722802 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-03-01 16:22:28,402 p=722802 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:29,259 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "checksum": "e2fedb4e1237da20f4c73b66ef8b9893cbaebc0f", "dest": "/etc/default/etcd", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/default/etcd", "size": 1666, "state": "file", "uid": 0}
2025-03-01 16:22:29,260 p=722802 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 16:22:29,744 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 111, "group": "etcd", "mode": "0770", "owner": "etcd", "path": "/var/lib/etcd", "size": 4096, "state": "directory", "uid": 103}
2025-03-01 16:22:29,745 p=722802 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:30,829 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"cache_update_time": 1740830385, "cache_updated": true, "changed": false}
2025-03-01 16:22:30,830 p=722802 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 16:22:31,298 p=722802 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:22:31,299 p=722802 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 16:22:32,501 p=722802 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "12164933138", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12159973348", "ActiveState": "active", "After": "network.target basic.target sysinit.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "12162865300", "Before": "etcd-discovery.service multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "30684507000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "12162865297", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "4046", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainHandoffTimestampMonotonic": "12162888420", "ExecMainPID": "27249", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "12162866116", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:54 MSK", "InactiveEnterTimestampMonotonic": "12161444043", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "12162868286", "InvocationID": "73a98ce84ef847b09be317ca589e91fd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "27249", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1549586432", "MemoryCurrent": "42790912", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "48541696", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "12164933138", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:22:32,503 p=722802 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-03-01 16:22:32,535 p=722802 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:33,220 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "checksum": "4fb16fe2a7b6f713b4a92c9446a9dc1c39660a21", "dest": "/etc/default/etcd", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/default/etcd", "size": 1584, "state": "file", "uid": 0}
2025-03-01 16:22:33,221 p=722802 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:34,253 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"cache_update_time": 1740833281, "cache_updated": true, "changed": false}
2025-03-01 16:22:34,254 p=722802 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 16:22:34,618 p=722802 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:22:34,619 p=722802 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 16:22:35,667 p=722802 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "12123931550", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12118925011", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "12121804488", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "31450191000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "12121804485", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "124577", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainHandoffTimestampMonotonic": "12121844640", "ExecMainPID": "31534", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "12121805324", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=31534 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=31534 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:55 MSK", "InactiveEnterTimestampMonotonic": "12120510940", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "12121806233", "InvocationID": "f4ef8ef1faf541c7a9d150bdd7132f74", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "31534", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1662193664", "MemoryCurrent": "42532864", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "46735360", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "12123931550", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:22:35,668 p=722802 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-03-01 16:22:35,701 p=722802 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:42,600 p=722802 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "checksum": "60484e138bba76cd1caa22bfb1cb13542ef696b1", "dest": "/etc/default/etcd", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/default/etcd", "size": 1570, "state": "file", "uid": 0}
2025-03-01 16:22:42,600 p=722802 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:45,216 p=722802 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"cache_update_time": 1740833322, "cache_updated": true, "changed": false}
2025-03-01 16:22:45,216 p=722802 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 16:22:50,430 p=722802 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:22:50,431 p=722802 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 16:22:51,413 p=722802 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "324118665358", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "324113636288", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "324116509880", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "26435924000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "324116509877", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "105323", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "29593", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "324116516173", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=29593 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=29593 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:53 MSK", "InactiveEnterTimestampMonotonic": "324113952374", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "324116516664", "InvocationID": "161bec33d7c64193ba80264b47eaf7fd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "29593", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "57950208", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "324118665358", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:22:51,414 p=722802 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:51,745 p=722802 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "--cluster=true", "endpoint", "status", "--write-out=table"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:22:51,746 p=722802 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:51,792 p=722802 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": []
}
2025-03-01 16:22:51,865 p=722802 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:52,198 p=722802 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "member", "list", "--write-out=table"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:22:52,199 p=722802 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:52,242 p=722802 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": []
}
2025-03-01 16:22:52,324 p=722802 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-03-01 16:22:52,358 p=722802 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:52,774 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/patroni", "size": 4096, "state": "directory", "uid": 0}
2025-03-01 16:22:52,775 p=722802 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-03-01 16:22:53,621 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "checksum": "d539f05dee13bd527e251e234f60249b97932999", "dest": "/etc/patroni/config.yml", "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/etc/patroni/config.yml", "size": 3575, "state": "file", "uid": 102}
2025-03-01 16:22:53,622 p=722802 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-03-01 16:22:53,666 p=722802 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:54,130 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/patroni", "size": 4096, "state": "directory", "uid": 0}
2025-03-01 16:22:54,131 p=722802 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-03-01 16:22:54,895 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "checksum": "ad9f4bcdc347e99b30b1da7dee192a0e2903636c", "dest": "/etc/patroni/config.yml", "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/etc/patroni/config.yml", "size": 3370, "state": "file", "uid": 103}
2025-03-01 16:22:54,896 p=722802 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-03-01 16:22:54,941 p=722802 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-03-01 16:22:56,056 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"cache_update_time": 1740833281, "cache_updated": true, "changed": false}
2025-03-01 16:22:56,212 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"cache_update_time": 1740830385, "cache_updated": true, "changed": false}
2025-03-01 16:22:56,213 p=722802 u=digitd n=ansible INFO| TASK [Create necessary directory for certs] ******************************************************************************************************************************************************************************************************
2025-03-01 16:22:56,662 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/ssl", "size": 4096, "state": "directory", "uid": 103}
2025-03-01 16:22:56,672 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/ssl", "size": 4096, "state": "directory", "uid": 102}
2025-03-01 16:22:56,698 p=722802 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-03-01 16:22:57,078 p=722802 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "gid": 111, "group": "postgres", "mode": "0700", "owner": "postgres", "path": "/var/lib/postgresql/15/data", "size": 4096, "state": "directory", "uid": 103}
2025-03-01 16:22:57,197 p=722802 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "gid": 110, "group": "postgres", "mode": "0700", "owner": "postgres", "path": "/var/lib/postgresql/15/data", "size": 4096, "state": "directory", "uid": 102}
2025-03-01 16:22:57,199 p=722802 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-03-01 16:22:59,486 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "dest": "/var/lib/postgresql/15/ssl/", "src": "/run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/../../certs/"}
2025-03-01 16:22:59,790 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "dest": "/var/lib/postgresql/15/ssl/", "src": "/run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/../../certs/"}
2025-03-01 16:22:59,791 p=722802 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:00,930 p=722802 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "enabled": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ActiveEnterTimestampMonotonic": "12167436425", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12145865686", "ActiveState": "active", "After": "system.slice network.target systemd-journald.socket basic.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:52:00 MSK", "AssertTimestampMonotonic": "12167434015", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "14638821000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ConditionTimestampMonotonic": "12167434006", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "4089", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainHandoffTimestampMonotonic": "12167460380", "ExecMainPID": "27341", "ExecMainStartTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainStartTimestampMonotonic": "12167434818", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "110", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:43 MSK", "InactiveEnterTimestampMonotonic": "12149564853", "InactiveExitTimestamp": "Sat 2025-03-01 15:52:00 MSK", "InactiveExitTimestampMonotonic": "12167436425", "InvocationID": "f9d0ea532c8c4a11a24c158cecbcb28a", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "27341", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1583865856", "MemoryCurrent": "98926592", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "218927104", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:52:00 MSK", "StateChangeTimestampMonotonic": "12167436425", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "17", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "102", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:00,990 p=722802 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "enabled": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ActiveEnterTimestampMonotonic": "12126368340", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12104847788", "ActiveState": "active", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:52:00 MSK", "AssertTimestampMonotonic": "12126366539", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "16446250000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ConditionTimestampMonotonic": "12126366525", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "124663", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainHandoffTimestampMonotonic": "12126388669", "ExecMainPID": "31632", "ExecMainStartTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainStartTimestampMonotonic": "12126367519", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:52:00 MSK] ; stop_time=[n/a] ; pid=31632 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:52:00 MSK] ; stop_time=[n/a] ; pid=31632 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "111", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:50 MSK", "InactiveEnterTimestampMonotonic": "12115669410", "InactiveExitTimestamp": "Sat 2025-03-01 15:52:00 MSK", "InactiveExitTimestampMonotonic": "12126368340", "InvocationID": "330d9c604d7e4ae4b45fac8ac31f9cc2", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "31632", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1654407168", "MemoryCurrent": "240046080", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "240635904", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:52:00 MSK", "StateChangeTimestampMonotonic": "12126368340", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "14", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:00,991 p=722802 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 16:23:01,087 p=722802 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 16:23:01,113 p=722802 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 16:23:05,312 p=722802 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 16:23:06,263 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "delta": 5, "echo": true, "rc": 0, "start": "2025-03-01 16:23:01.087418", "stderr": "", "stdout": "Paused for 0.09 minutes", "stop": "2025-03-01 16:23:06.262118", "user_input": ""}
2025-03-01 16:23:06,523 p=722802 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 16:23:08,627 p=722802 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:09,066 p=722802 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:09,847 p=722802 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:11,444 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 16:23:11,521 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": []
}
2025-03-01 16:23:11,697 p=722802 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:11,765 p=722802 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:12,933 p=722802 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "patroni", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ActiveEnterTimestampMonotonic": "12126368340", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12104847788", "ActiveState": "active", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:52:00 MSK", "AssertTimestampMonotonic": "12126366539", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "16504337000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ConditionTimestampMonotonic": "12126366525", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "124663", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainHandoffTimestampMonotonic": "12126388669", "ExecMainPID": "31632", "ExecMainStartTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainStartTimestampMonotonic": "12126367519", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:52:00 MSK] ; stop_time=[n/a] ; pid=31632 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:52:00 MSK] ; stop_time=[n/a] ; pid=31632 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "111", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:50 MSK", "InactiveEnterTimestampMonotonic": "12115669410", "InactiveExitTimestamp": "Sat 2025-03-01 15:52:00 MSK", "InactiveExitTimestampMonotonic": "12126368340", "InvocationID": "330d9c604d7e4ae4b45fac8ac31f9cc2", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "31632", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1659424768", "MemoryCurrent": "240046080", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "240635904", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:52:00 MSK", "StateChangeTimestampMonotonic": "12126368340", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "14", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:13,031 p=722802 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "patroni", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ActiveEnterTimestampMonotonic": "12167436425", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12145865686", "ActiveState": "active", "After": "system.slice network.target systemd-journald.socket basic.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:52:00 MSK", "AssertTimestampMonotonic": "12167434015", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "14692881000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ConditionTimestampMonotonic": "12167434006", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "4089", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainHandoffTimestampMonotonic": "12167460380", "ExecMainPID": "27341", "ExecMainStartTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainStartTimestampMonotonic": "12167434818", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "110", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:43 MSK", "InactiveEnterTimestampMonotonic": "12149564853", "InactiveExitTimestamp": "Sat 2025-03-01 15:52:00 MSK", "InactiveExitTimestampMonotonic": "12167436425", "InvocationID": "f9d0ea532c8c4a11a24c158cecbcb28a", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "27341", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1589592064", "MemoryCurrent": "98926592", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "218927104", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:52:00 MSK", "StateChangeTimestampMonotonic": "12167436425", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "17", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "102", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:13,032 p=722802 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 16:23:13,064 p=722802 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 16:23:13,457 p=722802 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:13,461 p=722802 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:13,496 p=722802 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:13,538 p=722802 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:15,047 p=722802 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "324118665358", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "324113636288", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "324116509880", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "26767046000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "324116509877", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "105323", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "29593", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "324116516173", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=29593 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=29593 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:53 MSK", "InactiveEnterTimestampMonotonic": "324113952374", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "324116516664", "InvocationID": "161bec33d7c64193ba80264b47eaf7fd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "29593", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "57950208", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "324118665358", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:15,607 p=722802 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "12123931550", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12118925011", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "12121804488", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "32079964000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "12121804485", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "124577", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainHandoffTimestampMonotonic": "12121844640", "ExecMainPID": "31534", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "12121805324", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=31534 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=31534 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:55 MSK", "InactiveEnterTimestampMonotonic": "12120510940", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "12121806233", "InvocationID": "f4ef8ef1faf541c7a9d150bdd7132f74", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "31534", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1669267456", "MemoryCurrent": "42536960", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "46735360", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "12123931550", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:15,608 p=722802 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "12164933138", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12159973348", "ActiveState": "active", "After": "network.target basic.target sysinit.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "12162865300", "Before": "etcd-discovery.service multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "31364656000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "12162865297", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "4046", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainHandoffTimestampMonotonic": "12162888420", "ExecMainPID": "27249", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "12162866116", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:54 MSK", "InactiveEnterTimestampMonotonic": "12161444043", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "12162868286", "InvocationID": "73a98ce84ef847b09be317ca589e91fd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "27249", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1587978240", "MemoryCurrent": "42790912", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "48541696", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "12164933138", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:16,455 p=722802 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:18,087 p=722802 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"changed": false, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "324118665358", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "324113636288", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "324116509880", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "26812867000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "324116509877", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "105323", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "29593", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "324116516173", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=29593 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=29593 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:53 MSK", "InactiveEnterTimestampMonotonic": "324113952374", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "324116516664", "InvocationID": "161bec33d7c64193ba80264b47eaf7fd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "29593", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "57950208", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "324118665358", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:18,152 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "12164933138", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12159973348", "ActiveState": "active", "After": "network.target basic.target sysinit.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "12162865300", "Before": "etcd-discovery.service multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "31412624000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "12162865297", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "4046", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainHandoffTimestampMonotonic": "12162888420", "ExecMainPID": "27249", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "12162866116", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:54 MSK", "InactiveEnterTimestampMonotonic": "12161444043", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "12162868286", "InvocationID": "73a98ce84ef847b09be317ca589e91fd", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "27249", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1586233344", "MemoryCurrent": "42790912", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "48541696", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "12164933138", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:18,214 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:51:58 MSK", "ActiveEnterTimestampMonotonic": "12123931550", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:53 MSK", "ActiveExitTimestampMonotonic": "12118925011", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:51:56 MSK", "AssertTimestampMonotonic": "12121804488", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "32127173000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ConditionTimestampMonotonic": "12121804485", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "124577", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainHandoffTimestampMonotonic": "12121844640", "ExecMainPID": "31534", "ExecMainStartTimestamp": "Sat 2025-03-01 15:51:56 MSK", "ExecMainStartTimestampMonotonic": "12121805324", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=31534 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:51:56 MSK] ; stop_time=[n/a] ; pid=31534 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:55 MSK", "InactiveEnterTimestampMonotonic": "12120510940", "InactiveExitTimestamp": "Sat 2025-03-01 15:51:56 MSK", "InactiveExitTimestampMonotonic": "12121806233", "InvocationID": "f4ef8ef1faf541c7a9d150bdd7132f74", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "31534", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1657884672", "MemoryCurrent": "42536960", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "46735360", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:51:58 MSK", "StateChangeTimestampMonotonic": "12123931550", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:18,216 p=722802 u=digitd n=ansible INFO| PLAY [Delete Patroni files] **********************************************************************************************************************************************************************************************************************
2025-03-01 16:23:18,306 p=722802 u=digitd n=ansible INFO| TASK [Remove files] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:18,683 p=722802 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["trash-put", "/var/lib/postgresql/15/data"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:18,788 p=722802 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["trash-put", "/var/lib/postgresql/15/data"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:18,789 p=722802 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:18,822 p=722802 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:19,938 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ActiveEnterTimestampMonotonic": "12126368340", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12104847788", "ActiveState": "active", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:52:00 MSK", "AssertTimestampMonotonic": "12126366539", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "16535936000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ConditionTimestampMonotonic": "12126366525", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "124663", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainHandoffTimestampMonotonic": "12126388669", "ExecMainPID": "31632", "ExecMainStartTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainStartTimestampMonotonic": "12126367519", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:52:00 MSK] ; stop_time=[n/a] ; pid=31632 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 15:52:00 MSK] ; stop_time=[n/a] ; pid=31632 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "111", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:50 MSK", "InactiveEnterTimestampMonotonic": "12115669410", "InactiveExitTimestamp": "Sat 2025-03-01 15:52:00 MSK", "InactiveExitTimestampMonotonic": "12126368340", "InvocationID": "330d9c604d7e4ae4b45fac8ac31f9cc2", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "31632", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1665802240", "MemoryCurrent": "240046080", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "240635904", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:52:00 MSK", "StateChangeTimestampMonotonic": "12126368340", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "14", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:19,954 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ActiveEnterTimestampMonotonic": "12167436425", "ActiveExitTimestamp": "Sat 2025-03-01 15:51:39 MSK", "ActiveExitTimestampMonotonic": "12145865686", "ActiveState": "active", "After": "system.slice network.target systemd-journald.socket basic.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:52:00 MSK", "AssertTimestampMonotonic": "12167434015", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "14728325000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ConditionTimestampMonotonic": "12167434006", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/patroni.service", "ControlGroupId": "4089", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainHandoffTimestampMonotonic": "12167460380", "ExecMainPID": "27341", "ExecMainStartTimestamp": "Sat 2025-03-01 15:52:00 MSK", "ExecMainStartTimestampMonotonic": "12167434818", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "110", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:51:43 MSK", "InactiveEnterTimestampMonotonic": "12149564853", "InactiveExitTimestamp": "Sat 2025-03-01 15:52:00 MSK", "InactiveExitTimestampMonotonic": "12167436425", "InvocationID": "f9d0ea532c8c4a11a24c158cecbcb28a", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "27341", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1591160832", "MemoryCurrent": "98926592", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "218927104", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sat 2025-03-01 15:52:00 MSK", "StateChangeTimestampMonotonic": "12167436425", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "17", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "102", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:20,063 p=722802 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 16:23:20,532 p=722802 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:20,546 p=722802 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-01 16:23:20,688 p=722802 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 16:23:23,351 p=722802 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 16:23:24,578 p=722802 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 16:23:27,756 p=722802 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 16:23:28,244 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "delta": 4, "echo": true, "rc": 0, "start": "2025-03-01 16:23:23.350923", "stderr": "", "stdout": "Paused for 0.08 minutes", "stop": "2025-03-01 16:23:28.243067", "user_input": ""}
2025-03-01 16:23:28,245 p=722802 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:28,338 p=722802 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 16:23:28,411 p=722802 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": []
}
2025-03-01 16:23:28,504 p=722802 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-03-01 16:23:28,546 p=722802 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:30,667 p=722802 u=digitd n=ansible INFO| ok: [db.test.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740833648, "cache_updated": true, "changed": false}
2025-03-01 16:23:30,668 p=722802 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-03-01 16:23:31,648 p=722802 u=digitd n=ansible INFO| ok: [db.test.lan] => {"changed": false, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:54:29 MSK", "ActiveEnterTimestampMonotonic": "509456316784", "ActiveExitTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ActiveExitTimestampMonotonic": "509455640712", "ActiveState": "active", "After": "sysinit.target systemd-journald.socket network-online.target rsyslog.service basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:54:28 MSK", "AssertTimestampMonotonic": "509455956986", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1627716000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ConditionTimestampMonotonic": "509455956982", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "12656", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "24417", "ExecMainStartTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ExecMainStartTimestampMonotonic": "509455966592", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:54:28 MSK] ; stop_time=[n/a] ; pid=24417 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Sat 2025-03-01 15:54:28 MSK] ; stop_time=[n/a] ; pid=24417 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:54:28 MSK", "InactiveEnterTimestampMonotonic": "509455956142", "InactiveExitTimestamp": "Sat 2025-03-01 15:54:28 MSK", "InactiveExitTimestampMonotonic": "509455967094", "InvocationID": "13b23a7c2a3d40e1a7cef8074820451b", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "24417", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "46821376", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:54:29 MSK", "StateChangeTimestampMonotonic": "509456316784", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:31,649 p=722802 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-03-01 16:23:31,688 p=722802 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-03-01 16:23:32,367 p=722802 u=digitd n=ansible INFO| ok: [db.test.lan] => {"changed": false, "checksum": "81dc5834c94a75fd36d7fd78e0e93a8898b82b23", "dest": "/etc/haproxy/haproxy.cfg", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/haproxy/haproxy.cfg", "size": 2381, "state": "file", "uid": 0}
2025-03-01 16:23:33,656 p=722802 u=digitd n=ansible INFO| ok: [db.test1.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "checksum": "81dc5834c94a75fd36d7fd78e0e93a8898b82b23", "dest": "/etc/haproxy/haproxy.cfg", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/haproxy/haproxy.cfg", "size": 2381, "state": "file", "uid": 0}
2025-03-01 16:23:33,657 p=722802 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-03-01 16:23:34,608 p=722802 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ActiveEnterTimestampMonotonic": "509449141256", "ActiveExitTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ActiveExitTimestampMonotonic": "509449043270", "ActiveState": "active", "After": "network-online.target rsyslog.service system.slice systemd-journald.socket sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:54:28 MSK", "AssertTimestampMonotonic": "509449045022", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1568993000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ConditionTimestampMonotonic": "509449045020", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "12079", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "11763", "ExecMainStartTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ExecMainStartTimestampMonotonic": "509449052168", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:54:28 MSK] ; stop_time=[n/a] ; pid=11763 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Sat 2025-03-01 15:54:28 MSK] ; stop_time=[n/a] ; pid=11763 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:54:28 MSK", "InactiveEnterTimestampMonotonic": "509449043866", "InactiveExitTimestamp": "Sat 2025-03-01 15:54:28 MSK", "InactiveExitTimestampMonotonic": "509449052450", "InvocationID": "a24149ed0ee545a6aae5a3e5c6a6b802", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "11763", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "45887488", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:54:28 MSK", "StateChangeTimestampMonotonic": "509449141256", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:34,690 p=722802 u=digitd n=ansible INFO| changed: [db.test.lan] => {"changed": true, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:54:29 MSK", "ActiveEnterTimestampMonotonic": "509456316784", "ActiveExitTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ActiveExitTimestampMonotonic": "509455640712", "ActiveState": "active", "After": "sysinit.target systemd-journald.socket network-online.target rsyslog.service basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:54:28 MSK", "AssertTimestampMonotonic": "509455956986", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1629509000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ConditionTimestampMonotonic": "509455956982", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "12656", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "24417", "ExecMainStartTimestamp": "Sat 2025-03-01 15:54:28 MSK", "ExecMainStartTimestampMonotonic": "509455966592", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:54:28 MSK] ; stop_time=[n/a] ; pid=24417 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Sat 2025-03-01 15:54:28 MSK] ; stop_time=[n/a] ; pid=24417 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:54:28 MSK", "InactiveEnterTimestampMonotonic": "509455956142", "InactiveExitTimestamp": "Sat 2025-03-01 15:54:28 MSK", "InactiveExitTimestampMonotonic": "509455967094", "InvocationID": "13b23a7c2a3d40e1a7cef8074820451b", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "24417", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "46821376", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:54:29 MSK", "StateChangeTimestampMonotonic": "509456316784", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:34,691 p=722802 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 16:23:34,729 p=722802 u=digitd n=ansible INFO| TASK [Copy conf on MASTER HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 16:23:35,145 p=722802 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true}
2025-03-01 16:23:35,146 p=722802 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-03-01 16:23:36,093 p=722802 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "keepalived", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:54:35 MSK", "ActiveEnterTimestampMonotonic": "509456031015", "ActiveExitTimestamp": "Sat 2025-03-01 15:54:34 MSK", "ActiveExitTimestampMonotonic": "509454986227", "ActiveState": "active", "After": "systemd-journald.socket network-online.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:54:35 MSK", "AssertTimestampMonotonic": "509456001553", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "216965000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:54:35 MSK", "ConditionTimestampMonotonic": "509456001535", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/keepalived.service", "ControlGroupId": "12157", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Keepalive Daemon (LVS and VRRP)", "DevicePolicy": "auto", "Documentation": "\"man:keepalived(8)\" \"man:keepalived.conf(5)\" \"man:genhash(1)\" https://keepalived.org", "DynamicUser": "no", "EnvironmentFiles": "/etc/default/keepalived (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "11965", "ExecMainStartTimestamp": "Sat 2025-03-01 15:54:35 MSK", "ExecMainStartTimestampMonotonic": "509456008442", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:54:35 MSK] ; stop_time=[n/a] ; pid=11965 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:54:35 MSK] ; stop_time=[n/a] ; pid=11965 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/keepalived.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "keepalived.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:54:35 MSK", "InactiveEnterTimestampMonotonic": "509456000450", "InactiveExitTimestamp": "Sat 2025-03-01 15:54:35 MSK", "InactiveExitTimestampMonotonic": "509456012438", "InvocationID": "dd322d850f344341a1e74d8577b134ae", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "11965", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "2060288", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "keepalived.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:54:35 MSK", "StateChangeTimestampMonotonic": "509456031015", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:36,094 p=722802 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 16:23:36,137 p=722802 u=digitd n=ansible INFO| TASK [Copy conf on BACKUP HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 16:23:36,752 p=722802 u=digitd n=ansible INFO| ok: [db.test1.lan] => {"changed": false, "checksum": "525508afcada704b949ed1aaa9e0840d11bd6a64", "dest": "/etc/keepalived/keepalived.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/keepalived/keepalived.conf", "size": 264, "state": "file", "uid": 0}
2025-03-01 16:23:36,753 p=722802 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-03-01 16:23:37,787 p=722802 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "keepalived", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 15:54:35 MSK", "ActiveEnterTimestampMonotonic": "509456031015", "ActiveExitTimestamp": "Sat 2025-03-01 15:54:34 MSK", "ActiveExitTimestampMonotonic": "509454986227", "ActiveState": "active", "After": "systemd-journald.socket network-online.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 15:54:35 MSK", "AssertTimestampMonotonic": "509456001553", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "217144000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 15:54:35 MSK", "ConditionTimestampMonotonic": "509456001535", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/keepalived.service", "ControlGroupId": "12157", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Keepalive Daemon (LVS and VRRP)", "DevicePolicy": "auto", "Documentation": "\"man:keepalived(8)\" \"man:keepalived.conf(5)\" \"man:genhash(1)\" https://keepalived.org", "DynamicUser": "no", "EnvironmentFiles": "/etc/default/keepalived (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "11965", "ExecMainStartTimestamp": "Sat 2025-03-01 15:54:35 MSK", "ExecMainStartTimestampMonotonic": "509456008442", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 15:54:35 MSK] ; stop_time=[n/a] ; pid=11965 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 15:54:35 MSK] ; stop_time=[n/a] ; pid=11965 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/keepalived.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "keepalived.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 15:54:35 MSK", "InactiveEnterTimestampMonotonic": "509456000450", "InactiveExitTimestamp": "Sat 2025-03-01 15:54:35 MSK", "InactiveExitTimestampMonotonic": "509456012438", "InvocationID": "dd322d850f344341a1e74d8577b134ae", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "11965", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "2060288", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "keepalived.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 15:54:35 MSK", "StateChangeTimestampMonotonic": "509456031015", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-01 16:23:37,787 p=722802 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 16:23:37,810 p=722802 u=digitd n=ansible INFO| db.etcd.lan                : ok=7    changed=2    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2025-03-01 16:23:37,960 p=722802 u=digitd n=ansible INFO| db.master.lan              : ok=21   changed=5    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
2025-03-01 16:23:38,035 p=722802 u=digitd n=ansible INFO| db.slave.lan               : ok=18   changed=5    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
2025-03-01 16:23:38,152 p=722802 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 16:23:38,193 p=722802 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 18:51:16,607 p=20125 u=digitd n=ansible INFO| db.master.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-03-01 18:51:16,752 p=20125 u=digitd n=ansible INFO| db.test1.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-03-01 18:51:16,754 p=20125 u=digitd n=ansible INFO| db.test.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-03-01 18:51:16,846 p=20125 u=digitd n=ansible INFO| db.slave.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-03-01 18:51:17,142 p=20125 u=digitd n=ansible INFO| db.etcd.lan | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python3.11"
    },
    "changed": false,
    "ping": "pong"
}
2025-03-01 21:05:25,773 p=245951 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-03-01 21:05:25,779 p=245951 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:05:28,508 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:05:35,515 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:05:35,516 p=245951 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-03-01 21:05:44,246 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:05:44,918 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:05:44,920 p=245951 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-03-01 21:05:45,351 p=245951 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:05:46,768 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:05:46,769 p=245951 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:05:47,714 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:05:47,715 p=245951 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:05:52,792 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:05:52,793 p=245951 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:05:55,699 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:05:55,701 p=245951 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:05:57,750 p=245951 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:05:57,751 p=245951 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-03-01 21:05:58,709 p=245951 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:00,173 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:06:00,174 p=245951 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:01,893 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:06:01,894 p=245951 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:06:03,408 p=245951 u=digitd n=ansible INFO| skipping: [db.slave.lan]
2025-03-01 21:06:03,409 p=245951 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:06:05,810 p=245951 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:06:05,811 p=245951 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-03-01 21:06:06,532 p=245951 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:11,270 p=245951 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:06:11,271 p=245951 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:22,674 p=245951 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:06:22,675 p=245951 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:06:30,973 p=245951 u=digitd n=ansible INFO| skipping: [db.etcd.lan]
2025-03-01 21:06:30,974 p=245951 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:06:38,599 p=245951 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:06:38,600 p=245951 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:39,876 p=245951 u=digitd n=ansible INFO| skipping: [db.etcd.lan]
2025-03-01 21:06:39,877 p=245951 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:40,563 p=245951 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": []
}
2025-03-01 21:06:41,139 p=245951 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:43,272 p=245951 u=digitd n=ansible INFO| skipping: [db.etcd.lan]
2025-03-01 21:06:43,273 p=245951 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:43,929 p=245951 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": []
}
2025-03-01 21:06:45,085 p=245951 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-03-01 21:06:45,683 p=245951 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:48,340 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:06:48,341 p=245951 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-03-01 21:06:52,324 p=245951 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:06:52,325 p=245951 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-03-01 21:06:53,097 p=245951 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:54,753 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:06:54,754 p=245951 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-03-01 21:06:55,887 p=245951 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:06:55,888 p=245951 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:06:56,744 p=245951 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-03-01 21:07:00,226 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:07:09,542 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:07:09,543 p=245951 u=digitd n=ansible INFO| TASK [Create necessary directory for certs] ******************************************************************************************************************************************************************************************************
2025-03-01 21:07:14,894 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:07:14,902 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:07:17,359 p=245951 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-03-01 21:07:19,728 p=245951 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:07:19,734 p=245951 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:07:20,642 p=245951 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-03-01 21:07:26,456 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:07:29,260 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:07:29,261 p=245951 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:07:37,557 p=245951 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:07:37,566 p=245951 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:07:41,730 p=245951 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 21:07:43,050 p=245951 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 21:07:49,401 p=245951 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 21:07:52,054 p=245951 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 21:07:53,018 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:07:53,019 p=245951 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:07:53,987 p=245951 u=digitd n=ansible INFO| skipping: [db.slave.lan]
2025-03-01 21:07:53,997 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:07:54,173 p=245951 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:07:54,667 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 21:07:55,806 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": []
}
2025-03-01 21:07:56,787 p=245951 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:07:57,460 p=245951 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:07:59,288 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:07:59,664 p=245951 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:07:59,665 p=245951 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:07:59,970 p=245951 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:08:01,058 p=245951 u=digitd n=ansible INFO| skipping: [db.slave.lan]
2025-03-01 21:08:01,059 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:08:02,557 p=245951 u=digitd n=ansible INFO| skipping: [db.etcd.lan]
2025-03-01 21:08:02,558 p=245951 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:04,636 p=245951 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:08:04,845 p=245951 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:08:04,848 p=245951 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:08:05,439 p=245951 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:07,785 p=245951 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:08:08,286 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:08:08,287 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:08:08,964 p=245951 u=digitd n=ansible INFO| PLAY [Delete Patroni files] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:08:09,522 p=245951 u=digitd n=ansible INFO| TASK [Remove files] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:11,018 p=245951 u=digitd n=ansible INFO| skipping: [db.slave.lan]
2025-03-01 21:08:11,028 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:08:13,425 p=245951 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:17,126 p=245951 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:31,715 p=245951 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:08:32,772 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:08:32,773 p=245951 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:08:33,828 p=245951 u=digitd n=ansible INFO| skipping: [db.slave.lan]
2025-03-01 21:08:33,840 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:08:34,086 p=245951 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 21:08:34,514 p=245951 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 21:08:34,960 p=245951 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 21:08:36,440 p=245951 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 21:08:36,754 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:08:37,067 p=245951 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:37,535 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 21:08:37,727 p=245951 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": []
}
2025-03-01 21:08:38,107 p=245951 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-03-01 21:08:38,553 p=245951 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:40,477 p=245951 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-03-01 21:08:40,478 p=245951 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:08:41,936 p=245951 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-03-01 21:08:41,938 p=245951 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-03-01 21:08:42,211 p=245951 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-03-01 21:08:43,095 p=245951 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-03-01 21:08:43,425 p=245951 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-03-01 21:08:43,426 p=245951 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-03-01 21:08:44,977 p=245951 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:08:45,377 p=245951 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-03-01 21:08:45,378 p=245951 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 21:08:45,669 p=245951 u=digitd n=ansible INFO| TASK [Copy conf on MASTER HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 21:08:46,551 p=245951 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:08:46,552 p=245951 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-03-01 21:08:48,901 p=245951 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:08:48,902 p=245951 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 21:08:49,585 p=245951 u=digitd n=ansible INFO| TASK [Copy conf on BACKUP HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 21:08:50,811 p=245951 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-03-01 21:08:50,812 p=245951 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-03-01 21:08:55,563 p=245951 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:08:55,564 p=245951 u=digitd n=ansible INFO| PLAY [Create user \cluster\ for database] ********************************************************************************************************************************************************************************************************
2025-03-01 21:08:55,852 p=245951 u=digitd n=ansible INFO| TASK [User creation] *****************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:56,560 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:08:56,561 p=245951 u=digitd n=ansible INFO| TASK [Debug] *************************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:56,700 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 21:08:56,776 p=245951 u=digitd n=ansible INFO| TASK [Change password] ***************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:58,106 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:08:58,107 p=245951 u=digitd n=ansible INFO| TASK [Debug] *************************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:58,293 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 21:08:58,509 p=245951 u=digitd n=ansible INFO| TASK [Create database] ***************************************************************************************************************************************************************************************************************************
2025-03-01 21:08:59,417 p=245951 u=digitd n=ansible INFO| skipping: [db.master.lan]
2025-03-01 21:08:59,418 p=245951 u=digitd n=ansible INFO| TASK [Debug] *************************************************************************************************************************************************************************************************************************************
2025-03-01 21:09:00,084 p=245951 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-01 21:09:00,458 p=245951 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:09:00,716 p=245951 u=digitd n=ansible INFO| db.etcd.lan                : ok=7    changed=2    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2025-03-01 21:09:00,883 p=245951 u=digitd n=ansible INFO| db.master.lan              : ok=24   changed=6    unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2025-03-01 21:09:01,108 p=245951 u=digitd n=ansible INFO| db.slave.lan               : ok=18   changed=6    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
2025-03-01 21:09:01,640 p=245951 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 21:09:01,916 p=245951 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 21:09:16,632 p=245951 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-03-01 21:10:23,014 p=256017 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-03-01 21:10:23,018 p=256017 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:10:36,551 p=256017 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:11:32,394 p=256017 u=digitd n=ansible ERROR|  [ERROR]: User interrupted execution

2025-03-01 21:11:45,605 p=258600 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-03-01 21:11:45,609 p=258600 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:11:49,090 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:11:56,108 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:11:56,109 p=258600 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-03-01 21:12:04,642 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:12:04,649 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:12:07,190 p=258600 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-03-01 21:12:08,903 p=258600 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:12:20,909 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:12:20,910 p=258600 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:12:21,962 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:12:21,962 p=258600 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:12:25,506 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:12:25,507 p=258600 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:12:26,954 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:12:26,955 p=258600 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:13:09,083 p=258600 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:13:09,084 p=258600 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-03-01 21:13:09,589 p=258600 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:13:11,414 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:13:11,415 p=258600 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:13:14,160 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:13:14,161 p=258600 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:13:17,336 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:13:17,337 p=258600 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:13:48,488 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:13:48,489 p=258600 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-03-01 21:13:48,951 p=258600 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:13:51,467 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:13:51,467 p=258600 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:15:07,464 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:15:07,465 p=258600 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:15:15,408 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:15:15,409 p=258600 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:15:52,094 p=258600 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:15:52,095 p=258600 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:15:53,339 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:15:53,340 p=258600 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:15:55,033 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "|         ENDPOINT         |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+",
        "| http://192.168.2.16:2379 | 81cab37376d1dc8e |  3.5.16 |  172 kB |     false |      false |      2758 |      34414 |              34414 |        |",
        "| http://192.168.2.18:2379 | ac75029e92c4132b |  3.4.23 |  172 kB |     false |      false |      2758 |      34414 |              34414 |        |",
        "| http://192.168.2.17:2379 | c0cf9bdfef3320b4 |  3.5.16 |  172 kB |      true |      false |      2758 |      34414 |              34414 |        |",
        "+--------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+"
    ]
}
2025-03-01 21:15:55,800 p=258600 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-03-01 21:15:57,062 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:15:57,063 p=258600 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:15:57,507 p=258600 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": [
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "|        ID        | STATUS  |   NAME   |        PEER ADDRS        |       CLIENT ADDRS       | IS LEARNER |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+",
        "| 81cab37376d1dc8e | started | masterpg | http://192.168.2.16:2380 | http://192.168.2.16:2379 |      false |",
        "| ac75029e92c4132b | started |   etcdpg | http://192.168.2.18:2380 | http://192.168.2.18:2379 |      false |",
        "| c0cf9bdfef3320b4 | started |  slavepg | http://192.168.2.17:2380 | http://192.168.2.17:2379 |      false |",
        "+------------------+---------+----------+--------------------------+--------------------------+------------+"
    ]
}
2025-03-01 21:15:58,124 p=258600 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-03-01 21:15:58,483 p=258600 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 21:16:04,736 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:16:04,737 p=258600 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-03-01 21:16:06,631 p=258600 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:16:06,632 p=258600 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-03-01 21:16:07,640 p=258600 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-01 21:16:09,427 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:16:09,428 p=258600 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-03-01 21:16:13,743 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:16:13,744 p=258600 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:16:20,365 p=258600 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-03-01 21:16:23,047 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:16:24,089 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:16:24,090 p=258600 u=digitd n=ansible INFO| TASK [Create necessary directory for certs] ******************************************************************************************************************************************************************************************************
2025-03-01 21:16:25,148 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:16:25,152 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:16:26,099 p=258600 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-03-01 21:16:31,338 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:16:31,346 p=258600 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:16:39,327 p=258600 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-03-01 21:16:47,771 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:16:48,594 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:16:48,596 p=258600 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-03-01 21:16:51,097 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:17:21,292 p=258600 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:17:21,293 p=258600 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 21:17:21,789 p=258600 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 21:17:22,111 p=258600 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 21:17:25,659 p=258600 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 21:17:40,372 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:17:40,372 p=258600 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:17:47,697 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:18:02,857 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:18:02,858 p=258600 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:03,881 p=258600 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb (7476880094356841293) --------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Leader  | running |  1 |           |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 21:18:04,888 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb (7476880094356841293) --------+----+-----------+",
        "| Member   | Host              | Role    | State   | TL | Lag in MB |",
        "+----------+-------------------+---------+---------+----+-----------+",
        "| masterdb | 192.168.2.16:5050 | Leader  | running |  1 |           |",
        "| slavedb  | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+----------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 21:18:05,722 p=258600 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:06,252 p=258600 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:08,590 p=258600 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:18:09,256 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:18:09,258 p=258600 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:18:10,989 p=258600 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:18:20,896 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:18:22,512 p=258600 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.405644", "end": "2025-03-01 21:18:22.243449", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:18:16.837805", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:18:21.861580+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00041e000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:18:21.861580+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00041e000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:18:23,260 p=258600 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.811888", "end": "2025-03-01 21:18:22.478913", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:18:16.667025", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:18:21.687+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-b946f81f-0dde-4643-b870-3724ccf52eba/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:18:21.687+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-b946f81f-0dde-4643-b870-3724ccf52eba/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = context deadline exceeded\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:18:23,261 p=258600 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:31,590 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:18:31,591 p=258600 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:35,081 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:18:35,082 p=258600 u=digitd n=ansible INFO| PLAY [Delete Patroni files] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:18:35,246 p=258600 u=digitd n=ansible INFO| TASK [Remove files] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:36,017 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:18:36,018 p=258600 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:36,286 p=258600 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:18:37,615 p=258600 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:18:37,616 p=258600 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:18:40,847 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:18:40,848 p=258600 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 21:18:41,205 p=258600 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 21:18:41,293 p=258600 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 21:19:14,884 p=258600 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 21:19:15,180 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:19:15,181 p=258600 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 21:19:15,375 p=258600 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb (initializing) ----+---------+----+-----------+",
        "| Member  | Host              | Role    | State   | TL | Lag in MB |",
        "+---------+-------------------+---------+---------+----+-----------+",
        "| slavedb | 192.168.2.17:5050 | Replica | stopped |    |   unknown |",
        "+---------+-------------------+---------+---------+----+-----------+"
    ]
}
2025-03-01 21:19:15,491 p=258600 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-03-01 21:19:15,617 p=258600 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-03-01 21:19:42,188 p=258600 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-03-01 21:19:42,189 p=258600 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-03-01 21:19:47,987 p=258600 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-03-01 21:19:47,989 p=258600 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-03-01 21:19:48,047 p=258600 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-03-01 21:19:49,151 p=258600 u=digitd n=ansible INFO| ok: [db.test.lan]
2025-03-01 21:19:49,816 p=258600 u=digitd n=ansible INFO| ok: [db.test1.lan]
2025-03-01 21:19:49,817 p=258600 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-03-01 21:19:51,034 p=258600 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxyvip (Sat 2025-03-01 21:19:51 MSK):    haproxy[13299]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxyvip (Sat 2025-03-01 21:19:51 MSK):    haproxy[13299]: backend master_back has no server available!

2025-03-01 21:19:51,052 p=258600 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxydeb (Sat 2025-03-01 21:19:51 MSK):    haproxy[25946]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxydeb (Sat 2025-03-01 21:19:51 MSK):    haproxy[25946]: backend master_back has no server available!

2025-03-01 21:19:51,177 p=258600 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:19:51,279 p=258600 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-03-01 21:19:51,614 p=258600 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 21:19:51,689 p=258600 u=digitd n=ansible INFO| TASK [Copy conf on MASTER HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 21:19:52,579 p=258600 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:19:52,580 p=258600 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-03-01 21:19:58,056 p=258600 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:19:58,057 p=258600 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-03-01 21:19:58,188 p=258600 u=digitd n=ansible INFO| TASK [Copy conf on BACKUP HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-01 21:19:59,405 p=258600 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:19:59,406 p=258600 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-03-01 21:20:01,964 p=258600 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 21:20:01,965 p=258600 u=digitd n=ansible INFO| PLAY [Create user \cluster\ and new database \testdb\] *******************************************************************************************************************************************************************************************
2025-03-01 21:20:02,421 p=258600 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:20:02,998 p=258600 u=digitd n=ansible INFO| db.etcd.lan                : ok=8    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:20:03,495 p=258600 u=digitd n=ansible INFO| db.master.lan              : ok=18   changed=5    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:20:04,080 p=258600 u=digitd n=ansible INFO| db.slave.lan               : ok=24   changed=9    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 21:20:04,612 p=258600 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 21:20:16,642 p=258600 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=5    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 21:30:31,126 p=293601 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:30:31,130 p=293601 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:30:34,071 p=293601 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:30:44,331 p=293601 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:30:44,333 p=293601 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:30:45,060 p=293601 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:30:51,307 p=293601 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.025506", "end": "2025-03-01 21:30:51.259687", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:30:46.234181", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:30:51.257390+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc000420000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:30:51.257390+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc000420000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:30:53,333 p=293601 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.016304", "end": "2025-03-01 21:30:51.460563", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:30:46.444259", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:30:51.458+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-e0832ef3-5e6d-4903-b7f4-28f404070e7c/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:30:51.458+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-e0832ef3-5e6d-4903-b7f4-28f404070e7c/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:30:53,333 p=293601 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.471614", "end": "2025-03-01 21:30:51.689465", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:30:46.217851", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:30:51.241978+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0003ee000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:30:51.241978+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0003ee000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:30:54,366 p=293601 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:30:54,927 p=293601 u=digitd n=ansible INFO| db.etcd.lan                : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:30:55,908 p=293601 u=digitd n=ansible INFO| db.master.lan              : ok=1    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:30:56,899 p=293601 u=digitd n=ansible INFO| db.slave.lan               : ok=1    changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:31:35,004 p=295462 u=digitd n=ansible ERROR| ERROR! Empty playbook, nothing to do: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/rebase_etcd_and_patroni.yml
2025-03-01 21:31:54,413 p=296395 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:31:54,418 p=296395 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:31:56,490 p=296395 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:31:56,553 p=296395 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:31:56,555 p=296395 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:31:56,704 p=296395 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:32:02,192 p=296395 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.018346", "end": "2025-03-01 21:32:02.145957", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:31:57.127611", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:32:02.143614+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0002ec5a0/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:32:02.143614+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0002ec5a0/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:32:02,244 p=296395 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.022394", "end": "2025-03-01 21:32:02.164312", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:31:57.141918", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:32:02.162247+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00041a000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:32:02.162247+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00041a000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:32:02,415 p=296395 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.014696", "end": "2025-03-01 21:32:02.369985", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:31:57.355289", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:32:02.368+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-a1be22e5-c009-4863-b0ec-b28933bbb1e6/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:32:02.368+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-a1be22e5-c009-4863-b0ec-b28933bbb1e6/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:32:02,416 p=296395 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:32:02,452 p=296395 u=digitd n=ansible INFO| db.etcd.lan                : ok=0    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:32:02,493 p=296395 u=digitd n=ansible INFO| db.master.lan              : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:32:02,535 p=296395 u=digitd n=ansible INFO| db.slave.lan               : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-03-01 21:34:06,679 p=300359 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:34:06,683 p=300359 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:34:09,455 p=300359 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:34:09,659 p=300359 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:34:09,660 p=300359 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:34:10,001 p=300359 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:34:15,898 p=300359 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.026207", "end": "2025-03-01 21:34:15.848739", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:34:10.822532", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:34:15.846507+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00041e000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:34:15.846507+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00041e000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:34:15,898 p=300359 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:34:15,913 p=300359 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.024081", "end": "2025-03-01 21:34:15.860250", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:34:10.836169", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:34:15.857565+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0000fe000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:34:15.857565+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0000fe000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:34:16,165 p=300359 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:34:16,440 p=300359 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.014923", "end": "2025-03-01 21:34:16.050773", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:34:11.035850", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:34:16.048+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-5f683dc8-be0a-4ef5-aea7-09d190260bd8/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:34:16.048+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-5f683dc8-be0a-4ef5-aea7-09d190260bd8/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:34:16,665 p=300359 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:34:17,174 p=300359 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:34:19,346 p=300359 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:34:19,351 p=300359 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:34:19,559 p=300359 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:34:19,791 p=300359 u=digitd n=ansible INFO| TASK [Delete etcd files] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:34:20,617 p=300359 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:34:20,866 p=300359 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:34:21,283 p=300359 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:34:21,284 p=300359 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:34:21,767 p=300359 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:34:22,015 p=300359 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:34:22,015 p=300359 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:34:22,463 p=300359 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:34:45,575 p=300359 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Unable to start service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-03-01 21:34:45,979 p=300359 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": false, "msg": "Unable to start service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-03-01 21:34:46,229 p=300359 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Unable to start service etcd: Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.\n"}
2025-03-01 21:34:46,230 p=300359 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:34:46,279 p=300359 u=digitd n=ansible INFO| db.etcd.lan                : ok=4    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:34:46,388 p=300359 u=digitd n=ansible INFO| db.master.lan              : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:34:46,438 p=300359 u=digitd n=ansible INFO| db.slave.lan               : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:48:15,157 p=326269 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:48:15,161 p=326269 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:48:17,751 p=326269 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:48:17,763 p=326269 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:48:17,829 p=326269 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:48:17,905 p=326269 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:48:23,710 p=326269 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.028247", "end": "2025-03-01 21:48:23.658425", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:48:18.630178", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:48:23.656044+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0002565a0/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:48:23.656044+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0002565a0/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:48:23,710 p=326269 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:48:24,187 p=326269 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.014508", "end": "2025-03-01 21:48:23.873072", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:48:18.858564", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:48:23.870+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-12d2b51c-b3db-4c8e-9f28-d5e73a4feeaf/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:48:23.870+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-12d2b51c-b3db-4c8e-9f28-d5e73a4feeaf/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:48:24,187 p=326269 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:48:24,188 p=326269 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.029909", "end": "2025-03-01 21:48:23.678842", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:48:18.648933", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:48:23.676103+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00035c000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:48:23.676103+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc00035c000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:48:24,436 p=326269 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:48:24,578 p=326269 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:48:25,933 p=326269 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:48:26,153 p=326269 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:48:26,154 p=326269 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:48:26,278 p=326269 u=digitd n=ansible INFO| TASK [Delete etcd files] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:48:27,030 p=326269 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:48:27,036 p=326269 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:48:27,152 p=326269 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:48:27,236 p=326269 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:48:27,898 p=326269 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:48:27,899 p=326269 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:48:27,977 p=326269 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:48:28,095 p=326269 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:48:29,413 p=326269 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (ansible.legacy.systemd) module: environment. Supported parameters include: daemon_reexec, daemon_reload, enabled, force, masked, name, no_block, scope, state (daemon-reexec, daemon-reload, service, unit)."}
2025-03-01 21:48:29,741 p=326269 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (ansible.legacy.systemd) module: environment. Supported parameters include: daemon_reexec, daemon_reload, enabled, force, masked, name, no_block, scope, state (daemon-reexec, daemon-reload, service, unit)."}
2025-03-01 21:48:29,744 p=326269 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": false, "msg": "Unsupported parameters for (ansible.legacy.systemd) module: environment. Supported parameters include: daemon_reexec, daemon_reload, enabled, force, masked, name, no_block, scope, state (daemon-reexec, daemon-reload, service, unit)."}
2025-03-01 21:48:29,886 p=326269 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:48:30,002 p=326269 u=digitd n=ansible INFO| db.etcd.lan                : ok=4    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:48:30,267 p=326269 u=digitd n=ansible INFO| db.master.lan              : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:48:30,452 p=326269 u=digitd n=ansible INFO| db.slave.lan               : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:51:40,798 p=332746 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:51:40,802 p=332746 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 21:51:43,468 p=332746 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:51:46,113 p=332746 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:51:46,114 p=332746 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:51:48,050 p=332746 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 21:51:54,583 p=332746 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.024557", "end": "2025-03-01 21:51:54.531628", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:51:49.507071", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:51:54.529435+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0002ec5a0/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:51:54.529435+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc0002ec5a0/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:51:54,583 p=332746 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:51:54,595 p=332746 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.028725", "end": "2025-03-01 21:51:54.545938", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:51:49.517213", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:51:54.543461+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc000426000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:51:54.543461+0300\",\"logger\":\"etcd-client\",\"caller\":\"v3/retry_interceptor.go:63\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"etcd-endpoints://0xc000426000/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: last connection error: connection error: desc = \\\"transport: Error while dialing: dial tcp 127.0.0.1:2379: connect: connection refused\\\"\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:51:55,411 p=332746 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:51:55,677 p=332746 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": true, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": "0:00:05.015343", "end": "2025-03-01 21:51:54.741439", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:51:49.726096", "stderr": "{\"level\":\"warn\",\"ts\":\"2025-03-01T21:51:54.739+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-3b4392e6-2ddb-48b3-9da9-97e935c98b86/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}\nError: context deadline exceeded", "stderr_lines": ["{\"level\":\"warn\",\"ts\":\"2025-03-01T21:51:54.739+0300\",\"caller\":\"clientv3/retry_interceptor.go:62\",\"msg\":\"retrying of unary invoker failed\",\"target\":\"endpoint://client-3b4392e6-2ddb-48b3-9da9-97e935c98b86/127.0.0.1:2379\",\"attempt\":0,\"error\":\"rpc error: code = DeadlineExceeded desc = latest balancer error: all SubConns are in TransientFailure\"}", "Error: context deadline exceeded"], "stdout": "", "stdout_lines": []}
2025-03-01 21:51:56,118 p=332746 u=digitd n=ansible INFO| ...ignoring
2025-03-01 21:51:56,412 p=332746 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:51:57,885 p=332746 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 21:51:57,914 p=332746 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 21:52:03,435 p=332746 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 21:52:04,191 p=332746 u=digitd n=ansible INFO| TASK [Delete etcd files] *************************************************************************************************************************************************************************************************************************
2025-03-01 21:52:06,018 p=332746 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:52:06,022 p=332746 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:52:06,702 p=332746 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:52:07,043 p=332746 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 21:52:08,010 p=332746 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 21:52:08,013 p=332746 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 21:52:08,302 p=332746 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 21:52:08,568 p=332746 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 21:52:34,867 p=332746 u=digitd n=ansible INFO| fatal: [db.master.lan]: FAILED! => {"changed": true, "cmd": "ETCD_INITIAL_CLUSTER_STATE=\"new\" systemctl start etcd", "delta": "0:00:23.688624", "end": "2025-03-01 21:52:34.821753", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:52:11.133129", "stderr": "Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.", "stderr_lines": ["Job for etcd.service failed because the control process exited with error code.", "See \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details."], "stdout": "", "stdout_lines": []}
2025-03-01 21:52:35,834 p=332746 u=digitd n=ansible INFO| fatal: [db.etcd.lan]: FAILED! => {"changed": true, "cmd": "ETCD_INITIAL_CLUSTER_STATE=\"new\" systemctl start etcd", "delta": "0:00:24.221436", "end": "2025-03-01 21:52:35.298493", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:52:11.077057", "stderr": "Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.", "stderr_lines": ["Job for etcd.service failed because the control process exited with error code.", "See \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details."], "stdout": "", "stdout_lines": []}
2025-03-01 21:52:37,333 p=332746 u=digitd n=ansible INFO| fatal: [db.slave.lan]: FAILED! => {"changed": true, "cmd": "ETCD_INITIAL_CLUSTER_STATE=\"new\" systemctl start etcd", "delta": "0:00:24.763333", "end": "2025-03-01 21:52:35.840185", "msg": "non-zero return code", "rc": 1, "start": "2025-03-01 21:52:11.076852", "stderr": "Job for etcd.service failed because the control process exited with error code.\nSee \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details.", "stderr_lines": ["Job for etcd.service failed because the control process exited with error code.", "See \"systemctl status etcd.service\" and \"journalctl -xeu etcd.service\" for details."], "stdout": "", "stdout_lines": []}
2025-03-01 21:52:37,333 p=332746 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 21:52:38,240 p=332746 u=digitd n=ansible INFO| db.etcd.lan                : ok=4    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:52:45,971 p=332746 u=digitd n=ansible INFO| db.master.lan              : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 21:52:46,787 p=332746 u=digitd n=ansible INFO| db.slave.lan               : ok=5    changed=3    unreachable=0    failed=1    skipped=0    rescued=0    ignored=1   
2025-03-01 22:04:08,917 p=356194 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-01 22:04:08,921 p=356194 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-01 22:04:11,272 p=356194 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 22:04:13,243 p=356194 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 22:04:13,244 p=356194 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-01 22:04:14,754 p=356194 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 22:04:18,750 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:04:18,753 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:04:20,074 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:04:20,075 p=356194 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-01 22:04:26,128 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:04:26,810 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:04:27,098 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:04:28,374 p=356194 u=digitd n=ansible INFO| TASK [Delete etcd files] *************************************************************************************************************************************************************************************************************************
2025-03-01 22:04:30,717 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:04:30,724 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:04:32,298 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:04:33,342 p=356194 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-01 22:04:34,514 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:04:34,517 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:04:35,056 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:04:35,605 p=356194 u=digitd n=ansible INFO| TASK [Replace value of variable ETCD_INITIAL_CLUSTER_STATE on 'new'] *****************************************************************************************************************************************************************************
2025-03-01 22:04:37,113 p=356194 u=digitd n=ansible INFO| ok: [db.etcd.lan]
2025-03-01 22:04:37,848 p=356194 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 22:04:37,849 p=356194 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 22:04:38,498 p=356194 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-01 22:05:17,677 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:05:21,128 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:05:38,350 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:05:38,351 p=356194 u=digitd n=ansible INFO| TASK [Change value of variable ETCD_INITIAL_CLUSTER_STATE on old 'existing'] *********************************************************************************************************************************************************************
2025-03-01 22:05:39,766 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:05:39,777 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:05:40,700 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:05:41,468 p=356194 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-01 22:05:44,769 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:05:46,009 p=356194 u=digitd n=ansible INFO| changed: [db.etcd.lan]
2025-03-01 22:05:46,609 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:05:46,611 p=356194 u=digitd n=ansible INFO| PLAY [Delete Patroni files] **********************************************************************************************************************************************************************************************************************
2025-03-01 22:05:46,971 p=356194 u=digitd n=ansible INFO| TASK [Remove files] ******************************************************************************************************************************************************************************************************************************
2025-03-01 22:05:47,989 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:05:47,994 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:05:48,492 p=356194 u=digitd n=ansible INFO| PLAY [Start Patroni] *****************************************************************************************************************************************************************************************************************************
2025-03-01 22:05:48,943 p=356194 u=digitd n=ansible INFO| TASK [Start service] *****************************************************************************************************************************************************************************************************************************
2025-03-01 22:05:51,223 p=356194 u=digitd n=ansible INFO| changed: [db.slave.lan]
2025-03-01 22:05:51,709 p=356194 u=digitd n=ansible INFO| changed: [db.master.lan]
2025-03-01 22:05:51,710 p=356194 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-01 22:05:53,694 p=356194 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 22:05:53,696 p=356194 u=digitd n=ansible INFO| ok: [db.slave.lan]
2025-03-01 22:05:55,134 p=356194 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-01 22:05:55,988 p=356194 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-01 22:05:56,499 p=356194 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-01 22:06:19,909 p=356194 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-01 22:06:20,152 p=356194 u=digitd n=ansible INFO| ok: [db.master.lan]
2025-03-01 22:06:20,517 p=356194 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-01 22:06:21,989 p=356194 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": [
        "+ Cluster: clusterdb (uninitialized) -----------+",
        "| Member | Host | Role | State | TL | Lag in MB |",
        "+--------+------+------+-------+----+-----------+",
        "+--------+------+------+-------+----+-----------+"
    ]
}
2025-03-01 22:06:22,921 p=356194 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": [
        "+ Cluster: clusterdb (uninitialized) -----------+",
        "| Member | Host | Role | State | TL | Lag in MB |",
        "+--------+------+------+-------+----+-----------+",
        "+--------+------+------+-------+----+-----------+"
    ]
}
2025-03-01 22:06:23,906 p=356194 u=digitd n=ansible INFO| PLAY [Restart haproxy] ***************************************************************************************************************************************************************************************************************************
2025-03-01 22:06:25,065 p=356194 u=digitd n=ansible INFO| TASK [Restart service] ***************************************************************************************************************************************************************************************************************************
2025-03-01 22:06:29,025 p=356194 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxydeb (Sat 2025-03-01 22:06:29 MSK):    haproxy[26058]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxydeb (Sat 2025-03-01 22:06:29 MSK):    haproxy[26058]: backend master_back has no server available!

2025-03-01 22:06:29,048 p=356194 u=digitd n=ansible WARNING| [WARNING]: Module invocation had junk after the JSON data:   Broadcast message from systemd-journald@haproxyvip (Sat 2025-03-01 22:06:29 MSK):    haproxy[13608]: backend master_back has no server available!      Broadcast message from
systemd-journald@haproxyvip (Sat 2025-03-01 22:06:29 MSK):    haproxy[13608]: backend master_back has no server available!

2025-03-01 22:06:31,133 p=356194 u=digitd n=ansible INFO| changed: [db.test.lan]
2025-03-01 22:06:32,681 p=356194 u=digitd n=ansible INFO| changed: [db.test1.lan]
2025-03-01 22:06:33,355 p=356194 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-01 22:06:34,838 p=356194 u=digitd n=ansible INFO| db.etcd.lan                : ok=8    changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 22:06:35,707 p=356194 u=digitd n=ansible INFO| db.master.lan              : ok=14   changed=9    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 22:06:36,097 p=356194 u=digitd n=ansible INFO| db.slave.lan               : ok=13   changed=9    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 22:06:36,946 p=356194 u=digitd n=ansible INFO| db.test.lan                : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-01 22:06:37,604 p=356194 u=digitd n=ansible INFO| db.test1.lan               : ok=1    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-02 17:11:28,786 p=807758 u=digitd n=ansible INFO| ansible [core 2.18.3]
  config file = /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg
  configured module search path = ['/home/digitd/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.13/site-packages/ansible
  ansible collection location = /home/digitd/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.13.2 (main, Feb  5 2025, 08:05:21) [GCC 14.2.1 20250128] (/usr/bin/python)
  jinja version = 3.1.5
  libyaml = True
2025-03-02 17:11:28,786 p=807758 u=digitd n=ansible INFO| Using /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg as config file
2025-03-02 17:11:28,860 p=807758 u=digitd n=ansible WARNING| [WARNING]: Could not match supplied host pattern, ignoring: ./start-services.yml

2025-03-02 17:11:28,860 p=807758 u=digitd n=ansible WARNING| [WARNING]: No hosts matched, nothing to do

2025-03-02 17:11:28,906 p=807758 u=digitd n=ansible ERROR| ERROR! No argument passed to command module (did you mean to run ansible-playbook?)
2025-03-02 17:11:41,430 p=808095 u=digitd n=ansible INFO| ansible-playbook [core 2.18.3]
  config file = /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg
  configured module search path = ['/home/digitd/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.13/site-packages/ansible
  ansible collection location = /home/digitd/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible-playbook
  python version = 3.13.2 (main, Feb  5 2025, 08:05:21) [GCC 14.2.1 20250128] (/usr/bin/python)
  jinja version = 3.1.5
  libyaml = True
2025-03-02 17:11:41,430 p=808095 u=digitd n=ansible INFO| Using /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg as config file
2025-03-02 17:11:41,432 p=808095 u=digitd n=ansible ERROR| ERROR! the playbook: ./start-services.yml could not be found
2025-03-02 17:12:12,168 p=809108 u=digitd n=ansible INFO| ansible-playbook [core 2.18.3]
  config file = /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg
  configured module search path = ['/home/digitd/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.13/site-packages/ansible
  ansible collection location = /home/digitd/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible-playbook
  python version = 3.13.2 (main, Feb  5 2025, 08:05:21) [GCC 14.2.1 20250128] (/usr/bin/python)
  jinja version = 3.1.5
  libyaml = True
2025-03-02 17:12:12,168 p=809108 u=digitd n=ansible INFO| Using /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/ansible.cfg as config file
2025-03-02 17:12:12,315 p=809108 u=digitd n=ansible INFO| Skipping callback 'default', as we already have a stdout callback.
2025-03-02 17:12:12,315 p=809108 u=digitd n=ansible INFO| Skipping callback 'minimal', as we already have a stdout callback.
2025-03-02 17:12:12,315 p=809108 u=digitd n=ansible INFO| Skipping callback 'oneline', as we already have a stdout callback.
2025-03-02 17:12:12,350 p=809108 u=digitd n=ansible INFO| PLAYBOOK: start_services.yml *********************************************************************************************************************************************************************************************************************
2025-03-02 17:12:12,442 p=809108 u=digitd n=ansible INFO| 16 plays in ./start_services.yml
2025-03-02 17:12:12,476 p=809108 u=digitd n=ansible INFO| PLAY [Install PostgreSQL and check status] *******************************************************************************************************************************************************************************************************
2025-03-02 17:12:12,524 p=809108 u=digitd n=ansible INFO| TASK [Install PostgreSQL] ************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:12,550 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:7
2025-03-02 17:12:33,555 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740852661, "cache_updated": true, "changed": false}
2025-03-02 17:12:34,290 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740852627, "cache_updated": true, "changed": false}
2025-03-02 17:12:34,292 p=809108 u=digitd n=ansible INFO| TASK [Check service] *****************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:34,331 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:14
2025-03-02 17:12:40,207 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "enabled": false, "name": "postgresql", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "systemd-journald.socket basic.target postgresql@15-main.service sysinit.target system.slice", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ConsistsOf": "postgresql@15-main.service", "ControlGroupId": "0", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "PostgreSQL RDBMS", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/postgresql.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "postgresql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1484091392", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "[not set]", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "[not set]", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "postgresql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "PropagatesReloadTo": "postgresql@15-main.service", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "yes", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "no", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "oneshot", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "UtmpMode": "init", "Wants": "postgresql@15-main.service", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity"}}
2025-03-02 17:12:40,808 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "enabled": false, "name": "postgresql", "state": "stopped", "status": {"ActiveEnterTimestampMonotonic": "0", "ActiveExitTimestampMonotonic": "0", "ActiveState": "inactive", "After": "system.slice sysinit.target postgresql@15-main.service systemd-journald.socket basic.target", "AllowIsolate": "no", "AssertResult": "no", "AssertTimestampMonotonic": "0", "Before": "shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "[not set]", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "no", "ConditionTimestampMonotonic": "0", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ConsistsOf": "postgresql@15-main.service", "ControlGroupId": "0", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "PostgreSQL RDBMS", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestampMonotonic": "0", "ExecMainPID": "0", "ExecMainStartTimestampMonotonic": "0", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/bin/true ; argv[]=/bin/true ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/bin/true ; argv[]=/bin/true ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/postgresql.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "postgresql.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestampMonotonic": "0", "InactiveExitTimestampMonotonic": "0", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1510449152", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "[not set]", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "[not set]", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "postgresql.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "PropagatesReloadTo": "postgresql@15-main.service", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "yes", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "no", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "no", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestampMonotonic": "0", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "infinity", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "oneshot", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "disabled", "UtmpMode": "init", "Wants": "postgresql@15-main.service", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "infinity"}}
2025-03-02 17:12:40,809 p=809108 u=digitd n=ansible INFO| PLAY [Configure etcd on the MASTER database machine] *********************************************************************************************************************************************************************************************
2025-03-02 17:12:40,891 p=809108 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:40,931 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:50
2025-03-02 17:12:41,740 p=809108 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true}
2025-03-02 17:12:41,741 p=809108 u=digitd n=ansible INFO| TASK [Create data directory] *********************************************************************************************************************************************************************************************************************
2025-03-02 17:12:41,772 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:59
2025-03-02 17:12:42,250 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 111, "group": "etcd", "mode": "0770", "owner": "etcd", "path": "/var/lib/etcd", "size": 4096, "state": "directory", "uid": 103}
2025-03-02 17:12:42,251 p=809108 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:42,522 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:68
2025-03-02 17:12:44,195 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"cache_update_time": 1740852661, "cache_updated": true, "changed": false}
2025-03-02 17:12:44,196 p=809108 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-02 17:12:44,230 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:78
2025-03-02 17:12:44,799 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:12:44,800 p=809108 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-02 17:12:44,847 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:82
2025-03-02 17:12:46,132 p=809108 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:04 MSK", "ActiveEnterTimestampMonotonic": "101931404522", "ActiveExitTimestamp": "Sun 2025-03-02 16:47:04 MSK", "ActiveExitTimestampMonotonic": "101870870578", "ActiveState": "active", "After": "network.target basic.target sysinit.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:48:03 MSK", "AssertTimestampMonotonic": "101929735716", "Before": "etcd-discovery.service multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "37647634000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ConditionTimestampMonotonic": "101929735711", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "33322", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ExecMainHandoffTimestampMonotonic": "101929776893", "ExecMainPID": "207688", "ExecMainStartTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ExecMainStartTimestampMonotonic": "101929738066", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:48:03 MSK] ; stop_time=[n/a] ; pid=207688 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:48:03 MSK] ; stop_time=[n/a] ; pid=207688 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:47:09 MSK", "InactiveEnterTimestampMonotonic": "101875836684", "InactiveExitTimestamp": "Sun 2025-03-02 16:48:03 MSK", "InactiveExitTimestampMonotonic": "101929740577", "InvocationID": "58c9de88767c40f2aa77cf474326ccc1", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "207688", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1497387008", "MemoryCurrent": "34381824", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "34910208", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 16:48:04 MSK", "StateChangeTimestampMonotonic": "101931404522", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:12:46,134 p=809108 u=digitd n=ansible INFO| PLAY [Configure etcd on the SLAVE database machine] **********************************************************************************************************************************************************************************************
2025-03-02 17:12:46,174 p=809108 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:46,214 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:93
2025-03-02 17:12:50,779 p=809108 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true}
2025-03-02 17:12:50,780 p=809108 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:50,822 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:101
2025-03-02 17:12:51,927 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"cache_update_time": 1740852627, "cache_updated": true, "changed": false}
2025-03-02 17:12:51,929 p=809108 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-02 17:12:51,963 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:110
2025-03-02 17:12:52,492 p=809108 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:12:52,493 p=809108 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-02 17:12:52,588 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:114
2025-03-02 17:12:53,831 p=809108 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:08 MSK", "ActiveEnterTimestampMonotonic": "101894135277", "ActiveExitTimestamp": "Sun 2025-03-02 16:47:22 MSK", "ActiveExitTimestampMonotonic": "101848254315", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:48:07 MSK", "AssertTimestampMonotonic": "101892766647", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "35903382000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ConditionTimestampMonotonic": "101892766641", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "1062674", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ExecMainHandoffTimestampMonotonic": "101892800836", "ExecMainPID": "306910", "ExecMainStartTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ExecMainStartTimestampMonotonic": "101892768524", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:48:07 MSK] ; stop_time=[n/a] ; pid=306910 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:48:07 MSK] ; stop_time=[n/a] ; pid=306910 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:47:22 MSK", "InactiveEnterTimestampMonotonic": "101848416957", "InactiveExitTimestamp": "Sun 2025-03-02 16:48:07 MSK", "InactiveExitTimestampMonotonic": "101892769954", "InvocationID": "bec3e56d46c9483b87114c8a72330544", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "306910", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1522114560", "MemoryCurrent": "32202752", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "32735232", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 16:48:08 MSK", "StateChangeTimestampMonotonic": "101894135277", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:12:53,833 p=809108 u=digitd n=ansible INFO| PLAY [Configure etcd on the another ETCD machine] ************************************************************************************************************************************************************************************************
2025-03-02 17:12:53,873 p=809108 u=digitd n=ansible INFO| TASK [Copy etcd file] ****************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:53,913 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:126
2025-03-02 17:12:59,104 p=809108 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true}
2025-03-02 17:12:59,105 p=809108 u=digitd n=ansible INFO| TASK [Install etcd] ******************************************************************************************************************************************************************************************************************************
2025-03-02 17:12:59,154 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:134
2025-03-02 17:13:02,579 p=809108 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740852846, "cache_updated": true, "changed": false}
2025-03-02 17:13:02,581 p=809108 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-02 17:13:02,762 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:143
2025-03-02 17:13:05,554 p=809108 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:13:05,555 p=809108 u=digitd n=ansible INFO| TASK [Restart etcd service] **********************************************************************************************************************************************************************************************************************
2025-03-02 17:13:06,589 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:147
2025-03-02 17:13:10,214 p=809108 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "enabled": true, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:04 MSK", "ActiveEnterTimestampMonotonic": "413885134534", "ActiveExitTimestamp": "Sun 2025-03-02 16:46:56 MSK", "ActiveExitTimestampMonotonic": "413816977257", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:47:59 MSK", "AssertTimestampMonotonic": "413879638030", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "33789935000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:47:59 MSK", "ConditionTimestampMonotonic": "413879638026", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "166041", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "64216", "ExecMainStartTimestamp": "Sun 2025-03-02 16:47:59 MSK", "ExecMainStartTimestampMonotonic": "413879652292", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:47:59 MSK] ; stop_time=[n/a] ; pid=64216 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:47:59 MSK] ; stop_time=[n/a] ; pid=64216 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:46:57 MSK", "InactiveEnterTimestampMonotonic": "413817636533", "InactiveExitTimestamp": "Sun 2025-03-02 16:47:59 MSK", "InactiveExitTimestampMonotonic": "413879652739", "InvocationID": "2f39813a8b944df4bf83ca7bfddfb622", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "64216", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "61493248", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-03-02 16:48:04 MSK", "StateChangeTimestampMonotonic": "413885134534", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:13:10,215 p=809108 u=digitd n=ansible INFO| TASK [Get status of etcd] ************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:10,253 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:153
2025-03-02 17:13:10,590 p=809108 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "--cluster=true", "endpoint", "status", "--write-out=table"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:13:10,591 p=809108 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:10,728 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:158
2025-03-02 17:13:10,871 p=809108 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": []
}
2025-03-02 17:13:10,896 p=809108 u=digitd n=ansible INFO| TASK [Get etcd members] **************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:10,928 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:162
2025-03-02 17:13:11,353 p=809108 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "member", "list", "--write-out=table"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:13:11,354 p=809108 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:11,970 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:167
2025-03-02 17:13:12,045 p=809108 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {
    "msg": []
}
2025-03-02 17:13:12,154 p=809108 u=digitd n=ansible INFO| PLAY [Copy patroni config (MASTER)] **************************************************************************************************************************************************************************************************************
2025-03-02 17:13:12,196 p=809108 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:12,236 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:176
2025-03-02 17:13:12,701 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/patroni", "size": 4096, "state": "directory", "uid": 0}
2025-03-02 17:13:12,702 p=809108 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the MASTER] *****************************************************************************************************************************************************************************************
2025-03-02 17:13:12,745 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:184
2025-03-02 17:13:13,587 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "checksum": "22b76a7f80f0c44e0eda748812913cb79f149764", "dest": "/etc/patroni/config.yml", "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/etc/patroni/config.yml", "size": 3348, "state": "file", "uid": 102}
2025-03-02 17:13:13,588 p=809108 u=digitd n=ansible INFO| PLAY [Copy patroni config (SLAVE)] ***************************************************************************************************************************************************************************************************************
2025-03-02 17:13:13,621 p=809108 u=digitd n=ansible INFO| TASK [Create directory] **************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:13,703 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:197
2025-03-02 17:13:14,125 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "gid": 0, "group": "root", "mode": "0755", "owner": "root", "path": "/etc/patroni", "size": 4096, "state": "directory", "uid": 0}
2025-03-02 17:13:14,126 p=809108 u=digitd n=ansible INFO| TASK [Copy the patroni configuration file to the REPLICA] ****************************************************************************************************************************************************************************************
2025-03-02 17:13:14,170 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:205
2025-03-02 17:13:17,376 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "checksum": "bb3ebe4d4ca70f47dd81d95d916165ad9fa4c5d1", "dest": "/etc/patroni/config.yml", "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/etc/patroni/config.yml", "size": 3149, "state": "file", "uid": 103}
2025-03-02 17:13:17,377 p=809108 u=digitd n=ansible INFO| PLAY [Configure Patroni] *************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:17,438 p=809108 u=digitd n=ansible INFO| TASK [Install patroni package] *******************************************************************************************************************************************************************************************************************
2025-03-02 17:13:17,528 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:218
2025-03-02 17:13:18,609 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"cache_update_time": 1740852627, "cache_updated": true, "changed": false}
2025-03-02 17:13:18,669 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"cache_update_time": 1740852661, "cache_updated": true, "changed": false}
2025-03-02 17:13:18,669 p=809108 u=digitd n=ansible INFO| TASK [Create necessary directory for certs] ******************************************************************************************************************************************************************************************************
2025-03-02 17:13:18,752 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:224
2025-03-02 17:13:19,126 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "gid": 110, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/ssl", "size": 4096, "state": "directory", "uid": 102}
2025-03-02 17:13:19,175 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "gid": 111, "group": "postgres", "mode": "0750", "owner": "postgres", "path": "/var/lib/postgresql/15/ssl", "size": 4096, "state": "directory", "uid": 103}
2025-03-02 17:13:19,176 p=809108 u=digitd n=ansible INFO| TASK [Create data directory for database] ********************************************************************************************************************************************************************************************************
2025-03-02 17:13:19,219 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:232
2025-03-02 17:13:19,691 p=809108 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "gid": 111, "group": "postgres", "mode": "0700", "owner": "postgres", "path": "/var/lib/postgresql/15/data", "size": 4096, "state": "directory", "uid": 103}
2025-03-02 17:13:19,692 p=809108 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "gid": 110, "group": "postgres", "mode": "0700", "owner": "postgres", "path": "/var/lib/postgresql/15/data", "size": 4096, "state": "directory", "uid": 102}
2025-03-02 17:13:19,737 p=809108 u=digitd n=ansible INFO| TASK [Copy certificates on the machines] *********************************************************************************************************************************************************************************************************
2025-03-02 17:13:19,777 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:241
2025-03-02 17:13:22,311 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "dest": "/var/lib/postgresql/15/ssl/", "src": "/run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/../../certs/psql/"}
2025-03-02 17:13:22,861 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "dest": "/var/lib/postgresql/15/ssl/", "src": "/run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/../../certs/psql/"}
2025-03-02 17:13:22,862 p=809108 u=digitd n=ansible INFO| TASK [Start services] ****************************************************************************************************************************************************************************************************************************
2025-03-02 17:13:22,986 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:251
2025-03-02 17:13:24,169 p=809108 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "enabled": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ActiveEnterTimestampMonotonic": "35229878667", "ActiveExitTimestamp": "Sun 2025-03-02 14:49:38 MSK", "ActiveExitTimestampMonotonic": "94825487862", "ActiveState": "inactive", "After": "system.slice network.target systemd-journald.socket basic.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:16:23 MSK", "AssertTimestampMonotonic": "35229874992", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1895335987000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ConditionTimestampMonotonic": "35229874975", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "6898", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sun 2025-03-02 14:49:40 MSK", "ExecMainExitTimestampMonotonic": "94827367161", "ExecMainHandoffTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ExecMainHandoffTimestampMonotonic": "35229912634", "ExecMainPID": "75772", "ExecMainStartTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ExecMainStartTimestampMonotonic": "35229877308", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:16:23 MSK] ; stop_time=[Sun 2025-03-02 14:49:40 MSK] ; pid=75772 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 22:16:23 MSK] ; stop_time=[Sun 2025-03-02 14:49:40 MSK] ; pid=75772 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 14:49:40 MSK", "InactiveEnterTimestampMonotonic": "94827367501", "InactiveExitTimestamp": "Sat 2025-03-01 22:16:23 MSK", "InactiveExitTimestampMonotonic": "35229878667", "InvocationID": "5a76ced4a3f2406f8c2cd2cc0d793c4e", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1475182592", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "210776064", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "11087872", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 14:49:40 MSK", "StateChangeTimestampMonotonic": "94827367501", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:13:24,320 p=809108 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "enabled": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ActiveEnterTimestampMonotonic": "35239655939", "ActiveExitTimestamp": "Sun 2025-03-02 14:49:45 MSK", "ActiveExitTimestampMonotonic": "94791198970", "ActiveState": "inactive", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:17:14 MSK", "AssertTimestampMonotonic": "35239653536", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1903619457000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ConditionTimestampMonotonic": "35239653505", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "361387", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sun 2025-03-02 14:49:47 MSK", "ExecMainExitTimestampMonotonic": "94793344402", "ExecMainHandoffTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ExecMainHandoffTimestampMonotonic": "35239684448", "ExecMainPID": "84146", "ExecMainStartTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ExecMainStartTimestampMonotonic": "35239655013", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:17:14 MSK] ; stop_time=[Sun 2025-03-02 14:49:47 MSK] ; pid=84146 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 22:17:14 MSK] ; stop_time=[Sun 2025-03-02 14:49:47 MSK] ; pid=84146 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 14:49:47 MSK", "InactiveEnterTimestampMonotonic": "94793344644", "InactiveExitTimestamp": "Sat 2025-03-01 22:17:14 MSK", "InactiveExitTimestampMonotonic": "35239655939", "InvocationID": "332cbbf7d30c47629441db02c0b1bddc", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1531265024", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "218685440", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "20267008", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 14:49:47 MSK", "StateChangeTimestampMonotonic": "94793344644", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:13:24,321 p=809108 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-02 17:13:24,427 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:257
2025-03-02 17:13:24,475 p=809108 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-02 17:13:24,510 p=809108 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-02 17:14:22,646 p=809108 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-02 17:14:29,431 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "delta": 64, "echo": true, "rc": 0, "start": "2025-03-02 17:13:24.475303", "stderr": "", "stdout": "Paused for 1.08 minutes", "stop": "2025-03-02 17:14:29.430652", "user_input": ""}
2025-03-02 17:14:29,432 p=809108 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-02 17:14:30,333 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:261
2025-03-02 17:14:32,582 p=809108 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:32,664 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:32,665 p=809108 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:32,705 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:266
2025-03-02 17:14:32,746 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-02 17:14:32,821 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": []
}
2025-03-02 17:14:32,856 p=809108 u=digitd n=ansible INFO| PLAY [Stop Patroni] ******************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:32,898 p=809108 u=digitd n=ansible INFO| TASK [Stop service] ******************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:32,938 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:276
2025-03-02 17:14:34,267 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "name": "patroni", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ActiveEnterTimestampMonotonic": "35229878667", "ActiveExitTimestamp": "Sun 2025-03-02 14:49:38 MSK", "ActiveExitTimestampMonotonic": "94825487862", "ActiveState": "inactive", "After": "system.slice network.target systemd-journald.socket basic.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:16:23 MSK", "AssertTimestampMonotonic": "35229874992", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1895335987000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ConditionTimestampMonotonic": "35229874975", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "6898", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sun 2025-03-02 14:49:40 MSK", "ExecMainExitTimestampMonotonic": "94827367161", "ExecMainHandoffTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ExecMainHandoffTimestampMonotonic": "35229912634", "ExecMainPID": "75772", "ExecMainStartTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ExecMainStartTimestampMonotonic": "35229877308", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:16:23 MSK] ; stop_time=[Sun 2025-03-02 14:49:40 MSK] ; pid=75772 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 22:16:23 MSK] ; stop_time=[Sun 2025-03-02 14:49:40 MSK] ; pid=75772 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 14:49:40 MSK", "InactiveEnterTimestampMonotonic": "94827367501", "InactiveExitTimestamp": "Sat 2025-03-01 22:16:23 MSK", "InactiveExitTimestampMonotonic": "35229878667", "InvocationID": "5a76ced4a3f2406f8c2cd2cc0d793c4e", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1483800576", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "210776064", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "11087872", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 14:49:40 MSK", "StateChangeTimestampMonotonic": "94827367501", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:34,319 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "name": "patroni", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ActiveEnterTimestampMonotonic": "35239655939", "ActiveExitTimestamp": "Sun 2025-03-02 14:49:45 MSK", "ActiveExitTimestampMonotonic": "94791198970", "ActiveState": "inactive", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:17:14 MSK", "AssertTimestampMonotonic": "35239653536", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1903619457000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ConditionTimestampMonotonic": "35239653505", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "361387", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sun 2025-03-02 14:49:47 MSK", "ExecMainExitTimestampMonotonic": "94793344402", "ExecMainHandoffTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ExecMainHandoffTimestampMonotonic": "35239684448", "ExecMainPID": "84146", "ExecMainStartTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ExecMainStartTimestampMonotonic": "35239655013", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:17:14 MSK] ; stop_time=[Sun 2025-03-02 14:49:47 MSK] ; pid=84146 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 22:17:14 MSK] ; stop_time=[Sun 2025-03-02 14:49:47 MSK] ; pid=84146 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 14:49:47 MSK", "InactiveEnterTimestampMonotonic": "94793344644", "InactiveExitTimestamp": "Sat 2025-03-01 22:17:14 MSK", "InactiveExitTimestampMonotonic": "35239655939", "InvocationID": "332cbbf7d30c47629441db02c0b1bddc", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1523060736", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "218685440", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "20267008", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 14:49:47 MSK", "StateChangeTimestampMonotonic": "94793344644", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:34,320 p=809108 u=digitd n=ansible INFO| PLAY [Clear values from WAL] *********************************************************************************************************************************************************************************************************************
2025-03-02 17:14:34,364 p=809108 u=digitd n=ansible INFO| TASK [Clear old values of the cluster in base] ***************************************************************************************************************************************************************************************************
2025-03-02 17:14:34,404 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:286
2025-03-02 17:14:35,085 p=809108 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:35,089 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:39,316 p=809108 u=digitd n=ansible INFO| skipping: [db.etcd.lan] => {"changed": false, "cmd": ["etcdctl", "del", "", "--prefix"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:39,317 p=809108 u=digitd n=ansible INFO| TASK [Stop etcd service] *************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:39,413 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:290
2025-03-02 17:14:40,575 p=809108 u=digitd n=ansible INFO| changed: [db.etcd.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:04 MSK", "ActiveEnterTimestampMonotonic": "413885134534", "ActiveExitTimestamp": "Sun 2025-03-02 16:46:56 MSK", "ActiveExitTimestampMonotonic": "413816977257", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:47:59 MSK", "AssertTimestampMonotonic": "413879638030", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "35701119000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:47:59 MSK", "ConditionTimestampMonotonic": "413879638026", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "166041", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "64216", "ExecMainStartTimestamp": "Sun 2025-03-02 16:47:59 MSK", "ExecMainStartTimestampMonotonic": "413879652292", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:47:59 MSK] ; stop_time=[n/a] ; pid=64216 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:47:59 MSK] ; stop_time=[n/a] ; pid=64216 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:46:57 MSK", "InactiveEnterTimestampMonotonic": "413817636533", "InactiveExitTimestamp": "Sun 2025-03-02 16:47:59 MSK", "InactiveExitTimestampMonotonic": "413879652739", "InvocationID": "2f39813a8b944df4bf83ca7bfddfb622", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "64216", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "61820928", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-03-02 16:48:04 MSK", "StateChangeTimestampMonotonic": "413885134534", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:40,670 p=809108 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:08 MSK", "ActiveEnterTimestampMonotonic": "101894135277", "ActiveExitTimestamp": "Sun 2025-03-02 16:47:22 MSK", "ActiveExitTimestampMonotonic": "101848254315", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:48:07 MSK", "AssertTimestampMonotonic": "101892766647", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "38472573000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ConditionTimestampMonotonic": "101892766641", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "1062674", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ExecMainHandoffTimestampMonotonic": "101892800836", "ExecMainPID": "306910", "ExecMainStartTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ExecMainStartTimestampMonotonic": "101892768524", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:48:07 MSK] ; stop_time=[n/a] ; pid=306910 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:48:07 MSK] ; stop_time=[n/a] ; pid=306910 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:47:22 MSK", "InactiveEnterTimestampMonotonic": "101848416957", "InactiveExitTimestamp": "Sun 2025-03-02 16:48:07 MSK", "InactiveExitTimestampMonotonic": "101892769954", "InvocationID": "bec3e56d46c9483b87114c8a72330544", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "306910", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1518694400", "MemoryCurrent": "32227328", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "32751616", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 16:48:08 MSK", "StateChangeTimestampMonotonic": "101894135277", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:40,673 p=809108 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "etcd", "state": "stopped", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:04 MSK", "ActiveEnterTimestampMonotonic": "101931404522", "ActiveExitTimestamp": "Sun 2025-03-02 16:47:04 MSK", "ActiveExitTimestampMonotonic": "101870870578", "ActiveState": "active", "After": "network.target basic.target sysinit.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:48:03 MSK", "AssertTimestampMonotonic": "101929735716", "Before": "etcd-discovery.service multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "40467724000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ConditionTimestampMonotonic": "101929735711", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "33322", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ExecMainHandoffTimestampMonotonic": "101929776893", "ExecMainPID": "207688", "ExecMainStartTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ExecMainStartTimestampMonotonic": "101929738066", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:48:03 MSK] ; stop_time=[n/a] ; pid=207688 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:48:03 MSK] ; stop_time=[n/a] ; pid=207688 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:47:09 MSK", "InactiveEnterTimestampMonotonic": "101875836684", "InactiveExitTimestamp": "Sun 2025-03-02 16:48:03 MSK", "InactiveExitTimestampMonotonic": "101929740577", "InvocationID": "58c9de88767c40f2aa77cf474326ccc1", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "207688", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1484951552", "MemoryCurrent": "34406400", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "34934784", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 16:48:04 MSK", "StateChangeTimestampMonotonic": "101931404522", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:40,771 p=809108 u=digitd n=ansible INFO| TASK [Start etcd service] ************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:40,871 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:295
2025-03-02 17:14:41,954 p=809108 u=digitd n=ansible INFO| ok: [db.etcd.lan] => {"changed": false, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:04 MSK", "ActiveEnterTimestampMonotonic": "413885134534", "ActiveExitTimestamp": "Sun 2025-03-02 16:46:56 MSK", "ActiveExitTimestampMonotonic": "413816977257", "ActiveState": "active", "After": "systemd-journald.socket system.slice basic.target network.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:47:59 MSK", "AssertTimestampMonotonic": "413879638030", "Before": "multi-user.target etcd-discovery.service shutdown.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "35722115000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:47:59 MSK", "ConditionTimestampMonotonic": "413879638026", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "166041", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveCPUs": "0", "EffectiveMemoryNodes": "0", "Environment": "DAEMON_ARGS= ETCD_NAME=etcd ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "64216", "ExecMainStartTimestamp": "Sun 2025-03-02 16:47:59 MSK", "ExecMainStartTimestampMonotonic": "413879652292", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:47:59 MSK] ; stop_time=[n/a] ; pid=64216 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:47:59 MSK] ; stop_time=[n/a] ; pid=64216 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:46:57 MSK", "InactiveEnterTimestampMonotonic": "413817636533", "InactiveExitTimestamp": "Sun 2025-03-02 16:47:59 MSK", "InactiveExitTimestampMonotonic": "413879652739", "InvocationID": "2f39813a8b944df4bf83ca7bfddfb622", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "64216", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "61820928", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sun 2025-03-02 16:48:04 MSK", "StateChangeTimestampMonotonic": "413885134534", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:42,110 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {"changed": false, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:08 MSK", "ActiveEnterTimestampMonotonic": "101894135277", "ActiveExitTimestamp": "Sun 2025-03-02 16:47:22 MSK", "ActiveExitTimestampMonotonic": "101848254315", "ActiveState": "active", "After": "network.target sysinit.target basic.target systemd-journald.socket system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:48:07 MSK", "AssertTimestampMonotonic": "101892766647", "Before": "shutdown.target etcd-discovery.service multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "38499236000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ConditionTimestampMonotonic": "101892766641", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "1062674", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=slavedb ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ExecMainHandoffTimestampMonotonic": "101892800836", "ExecMainPID": "306910", "ExecMainStartTimestamp": "Sun 2025-03-02 16:48:07 MSK", "ExecMainStartTimestampMonotonic": "101892768524", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:48:07 MSK] ; stop_time=[n/a] ; pid=306910 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:48:07 MSK] ; stop_time=[n/a] ; pid=306910 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "112", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:47:22 MSK", "InactiveEnterTimestampMonotonic": "101848416957", "InactiveExitTimestamp": "Sun 2025-03-02 16:48:07 MSK", "InactiveExitTimestampMonotonic": "101892769954", "InvocationID": "bec3e56d46c9483b87114c8a72330544", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "306910", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1518428160", "MemoryCurrent": "32227328", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "32751616", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 16:48:08 MSK", "StateChangeTimestampMonotonic": "101894135277", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "9", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "104", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "etcd-discovery.service multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:42,115 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "name": "etcd", "state": "started", "status": {"ActiveEnterTimestamp": "Sun 2025-03-02 16:48:04 MSK", "ActiveEnterTimestampMonotonic": "101931404522", "ActiveExitTimestamp": "Sun 2025-03-02 16:47:04 MSK", "ActiveExitTimestampMonotonic": "101870870578", "ActiveState": "active", "After": "network.target basic.target sysinit.target system.slice systemd-journald.socket", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sun 2025-03-02 16:48:03 MSK", "AssertTimestampMonotonic": "101929735716", "Before": "etcd-discovery.service multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "40495458000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "no", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ConditionTimestampMonotonic": "101929735711", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/etcd.service", "ControlGroupId": "33322", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "etcd - highly-available key value store", "DevicePolicy": "auto", "Documentation": "https://etcd.io/docs man:etcd", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "Environment": "DAEMON_ARGS= ETCD_NAME=dbmaster ETCD_DATA_DIR=/var/lib/etcd/default", "EnvironmentFiles": "/etc/default/etcd (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainHandoffTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ExecMainHandoffTimestampMonotonic": "101929776893", "ExecMainPID": "207688", "ExecMainStartTimestamp": "Sun 2025-03-02 16:48:03 MSK", "ExecMainStartTimestampMonotonic": "101929738066", "ExecMainStatus": "0", "ExecStart": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sun 2025-03-02 16:48:03 MSK] ; stop_time=[n/a] ; pid=207688 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/bin/etcd ; argv[]=/usr/bin/etcd $DAEMON_ARGS ; flags= ; start_time=[Sun 2025-03-02 16:48:03 MSK] ; stop_time=[n/a] ; pid=207688 ; code=(null) ; status=0/0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/etcd.service", "FreezerState": "running", "GID": "111", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "etcd.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 16:47:09 MSK", "InactiveEnterTimestampMonotonic": "101875836684", "InactiveExitTimestamp": "Sun 2025-03-02 16:48:03 MSK", "InactiveExitTimestampMonotonic": "101929740577", "InvocationID": "58c9de88767c40f2aa77cf474326ccc1", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "65536", "LimitNOFILESoft": "65536", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "207688", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1475313664", "MemoryCurrent": "34398208", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "34934784", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "0", "MemorySwapMax": "infinity", "MemorySwapPeak": "0", "MemoryZSwapCurrent": "0", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "etcd.service etcd2.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-abnormal", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 16:48:04 MSK", "StateChangeTimestampMonotonic": "101931404522", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "8", "TasksMax": "2305", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "103", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "etcd", "UtmpMode": "init", "WantedBy": "multi-user.target etcd-discovery.service", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:42,147 p=809108 u=digitd n=ansible INFO| PLAY [Delete Patroni files] **********************************************************************************************************************************************************************************************************************
2025-03-02 17:14:42,189 p=809108 u=digitd n=ansible INFO| TASK [Remove files] ******************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:42,279 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:305
2025-03-02 17:14:42,647 p=809108 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["trash-put", "/var/lib/postgresql/15/data"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:42,696 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["trash-put", "/var/lib/postgresql/15/data"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:42,697 p=809108 u=digitd n=ansible INFO| PLAY [Start Patroni] *****************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:42,781 p=809108 u=digitd n=ansible INFO| TASK [Start service] *****************************************************************************************************************************************************************************************************************************
2025-03-02 17:14:42,812 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:314
2025-03-02 17:14:43,956 p=809108 u=digitd n=ansible INFO| changed: [db.master.lan] => {"changed": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ActiveEnterTimestampMonotonic": "35229878667", "ActiveExitTimestamp": "Sun 2025-03-02 14:49:38 MSK", "ActiveExitTimestampMonotonic": "94825487862", "ActiveState": "inactive", "After": "system.slice network.target systemd-journald.socket basic.target sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:16:23 MSK", "AssertTimestampMonotonic": "35229874992", "Before": "multi-user.target shutdown.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1895335987000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ConditionTimestampMonotonic": "35229874975", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "6898", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sun 2025-03-02 14:49:40 MSK", "ExecMainExitTimestampMonotonic": "94827367161", "ExecMainHandoffTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ExecMainHandoffTimestampMonotonic": "35229912634", "ExecMainPID": "75772", "ExecMainStartTimestamp": "Sat 2025-03-01 22:16:23 MSK", "ExecMainStartTimestampMonotonic": "35229877308", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:16:23 MSK] ; stop_time=[Sun 2025-03-02 14:49:40 MSK] ; pid=75772 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 22:16:23 MSK] ; stop_time=[Sun 2025-03-02 14:49:40 MSK] ; pid=75772 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 14:49:40 MSK", "InactiveEnterTimestampMonotonic": "94827367501", "InactiveExitTimestamp": "Sat 2025-03-01 22:16:23 MSK", "InactiveExitTimestampMonotonic": "35229878667", "InvocationID": "5a76ced4a3f2406f8c2cd2cc0d793c4e", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7685", "LimitNPROCSoft": "7685", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7685", "LimitSIGPENDINGSoft": "7685", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1472704512", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "210776064", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "11087872", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 14:49:40 MSK", "StateChangeTimestampMonotonic": "94827367501", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:44,256 p=809108 u=digitd n=ansible INFO| changed: [db.slave.lan] => {"changed": true, "name": "patroni", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ActiveEnterTimestampMonotonic": "35239655939", "ActiveExitTimestamp": "Sun 2025-03-02 14:49:45 MSK", "ActiveExitTimestampMonotonic": "94791198970", "ActiveState": "inactive", "After": "network.target basic.target system.slice systemd-journald.socket sysinit.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:17:14 MSK", "AssertTimestampMonotonic": "35239653536", "Before": "shutdown.target multi-user.target", "BindLogSockets": "no", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "1903619457000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanLiveMount": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ConditionTimestampMonotonic": "35239653505", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroupId": "361387", "ControlPID": "0", "CoredumpFilter": "0x33", "CoredumpReceive": "no", "DebugInvocation": "no", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "DefaultStartupMemoryLow": "0", "Delegate": "no", "Description": "Runners to orchestrate a high-availability PostgreSQL", "DevicePolicy": "auto", "DynamicUser": "no", "EffectiveMemoryHigh": "2069450752", "EffectiveMemoryMax": "2069450752", "EffectiveTasksMax": "2305", "EnvironmentFiles": "/etc/patroni_env.conf (ignore_errors=yes)", "ExecMainCode": "1", "ExecMainExitTimestamp": "Sun 2025-03-02 14:49:47 MSK", "ExecMainExitTimestampMonotonic": "94793344402", "ExecMainHandoffTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ExecMainHandoffTimestampMonotonic": "35239684448", "ExecMainPID": "84146", "ExecMainStartTimestamp": "Sat 2025-03-01 22:17:14 MSK", "ExecMainStartTimestampMonotonic": "35239655013", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:17:14 MSK] ; stop_time=[Sun 2025-03-02 14:49:47 MSK] ; pid=84146 ; code=exited ; status=0 }", "ExecStartEx": "{ path=/usr/bin/patroni ; argv[]=/usr/bin/patroni /etc/patroni/config.yml ; flags= ; start_time=[Sat 2025-03-01 22:17:14 MSK] ; stop_time=[Sun 2025-03-02 14:49:47 MSK] ; pid=84146 ; code=exited ; status=0 }", "ExitType": "main", "ExtensionImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FileDescriptorStorePreserve": "restart", "FinalKillSignal": "9", "FragmentPath": "/usr/lib/systemd/system/patroni.service", "FreezerState": "running", "GID": "[not set]", "Group": "postgres", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "[not set]", "IOReadOperations": "[not set]", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "[not set]", "IOWriteOperations": "[not set]", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "patroni.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sun 2025-03-02 14:49:47 MSK", "InactiveEnterTimestampMonotonic": "94793344644", "InactiveExitTimestamp": "Sat 2025-03-01 22:17:14 MSK", "InactiveExitTimestampMonotonic": "35239655939", "InvocationID": "332cbbf7d30c47629441db02c0b1bddc", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "process", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "7686", "LimitNPROCSoft": "7686", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "7686", "LimitSIGPENDINGSoft": "7686", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LiveMountResult": "success", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "0", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureDurationUSec": "[not set]", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "1517539328", "MemoryCurrent": "[not set]", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryKSM": "no", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemoryPeak": "218685440", "MemoryPressureThresholdUSec": "200ms", "MemoryPressureWatch": "auto", "MemorySwapCurrent": "[not set]", "MemorySwapMax": "infinity", "MemorySwapPeak": "20267008", "MemoryZSwapCurrent": "[not set]", "MemoryZSwapMax": "infinity", "MemoryZSwapWriteback": "yes", "MountAPIVFS": "no", "MountImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "patroni.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "none", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivatePIDs": "no", "PrivateTmp": "no", "PrivateTmpEx": "no", "PrivateUsers": "no", "PrivateUsersEx": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectControlGroupsEx": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "ReloadSignal": "1", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "system.slice sysinit.target", "Restart": "on-failure", "RestartKillSignal": "15", "RestartMaxDelayUSec": "infinity", "RestartMode": "normal", "RestartSteps": "0", "RestartUSec": "100ms", "RestartUSecNext": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RootEphemeral": "no", "RootImagePolicy": "root=verity+signed+encrypted+unprotected+absent:usr=verity+signed+encrypted+unprotected+absent:home=encrypted+unprotected+absent:srv=encrypted+unprotected+absent:tmp=encrypted+unprotected+absent:var=encrypted+unprotected+absent", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "SetLoginEnvironment": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StartupMemoryHigh": "infinity", "StartupMemoryLow": "0", "StartupMemoryMax": "infinity", "StartupMemorySwapMax": "infinity", "StartupMemoryZSwapMax": "infinity", "StateChangeTimestamp": "Sun 2025-03-02 14:49:47 MSK", "StateChangeTimestampMonotonic": "94793344644", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "dead", "SuccessAction": "none", "SurviveFinalKillSignal": "no", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "[not set]", "TasksMax": "2305", "TimeoutAbortUSec": "30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "simple", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "User": "postgres", "UtmpMode": "init", "WantedBy": "multi-user.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:14:44,257 p=809108 u=digitd n=ansible INFO| TASK [Get patronictl status] *********************************************************************************************************************************************************************************************************************
2025-03-02 17:14:44,445 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:319
2025-03-02 17:14:44,937 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:44,939 p=809108 u=digitd n=ansible INFO| skipping: [db.slave.lan] => {"changed": false, "cmd": ["patronictl", "-c", "/etc/patroni/config.yml", "list"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:14:45,580 p=809108 u=digitd n=ansible INFO| TASK [Get time for Pantroni initializing] ********************************************************************************************************************************************************************************************************
2025-03-02 17:14:45,870 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:324
2025-03-02 17:14:45,977 p=809108 u=digitd n=ansible INFO| Pausing for 120 seconds
2025-03-02 17:14:46,037 p=809108 u=digitd n=ansible INFO| (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-03-02 17:16:03,341 p=809108 u=digitd n=ansible INFO| Press 'C' to continue the play or 'A' to abort 
2025-03-02 17:17:08,763 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {"changed": false, "delta": 142, "echo": true, "rc": 0, "start": "2025-03-02 17:14:45.976967", "stderr": "", "stdout": "Paused for 2.38 minutes", "stop": "2025-03-02 17:17:08.762665", "user_input": "\u0003"}
2025-03-02 17:17:08,766 p=809108 u=digitd n=ansible INFO| TASK [Print it] **********************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:08,800 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:328
2025-03-02 17:17:08,842 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-02 17:17:08,933 p=809108 u=digitd n=ansible INFO| ok: [db.slave.lan] => {
    "msg": []
}
2025-03-02 17:17:08,985 p=809108 u=digitd n=ansible INFO| PLAY [Install haproxy and run service] ***********************************************************************************************************************************************************************************************************
2025-03-02 17:17:09,127 p=809108 u=digitd n=ansible INFO| TASK [Install HAProxy] ***************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:09,192 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:337
2025-03-02 17:17:11,523 p=809108 u=digitd n=ansible INFO| ok: [db.test.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "cache_update_time": 1740853157, "cache_updated": true, "changed": false}
2025-03-02 17:17:11,523 p=809108 u=digitd n=ansible INFO| TASK [Check service status] **********************************************************************************************************************************************************************************************************************
2025-03-02 17:17:11,558 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:344
2025-03-02 17:17:12,472 p=809108 u=digitd n=ansible INFO| ok: [db.test.lan] => {"changed": false, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ActiveEnterTimestampMonotonic": "531776289193", "ActiveExitTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ActiveExitTimestampMonotonic": "531776193179", "ActiveState": "active", "After": "sysinit.target systemd-journald.socket network-online.target rsyslog.service basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:06:28 MSK", "AssertTimestampMonotonic": "531776196502", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "50408960000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ConditionTimestampMonotonic": "531776196500", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "14585", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "26055", "ExecMainStartTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ExecMainStartTimestampMonotonic": "531776204175", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:06:28 MSK] ; stop_time=[n/a] ; pid=26055 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Sat 2025-03-01 22:06:28 MSK] ; stop_time=[n/a] ; pid=26055 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 22:06:28 MSK", "InactiveEnterTimestampMonotonic": "531776193804", "InactiveExitTimestamp": "Sat 2025-03-01 22:06:28 MSK", "InactiveExitTimestampMonotonic": "531776204533", "InvocationID": "d2e4a3dcb72d44a4bd2110b552afff77", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "26055", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "48001024", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 22:06:28 MSK", "StateChangeTimestampMonotonic": "531776289193", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:17:12,473 p=809108 u=digitd n=ansible INFO| PLAY [Change haproxy.cfg and start load balance to the nodes (copy file from the project directory)] *********************************************************************************************************************************************
2025-03-02 17:17:12,518 p=809108 u=digitd n=ansible INFO| TASK [Edit or ensure config file for haproxy] ****************************************************************************************************************************************************************************************************
2025-03-02 17:17:12,550 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:355
2025-03-02 17:17:13,573 p=809108 u=digitd n=ansible INFO| ok: [db.test.lan] => {"changed": false, "checksum": "81dc5834c94a75fd36d7fd78e0e93a8898b82b23", "dest": "/etc/haproxy/haproxy.cfg", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/haproxy/haproxy.cfg", "size": 2381, "state": "file", "uid": 0}
2025-03-02 17:17:14,660 p=809108 u=digitd n=ansible INFO| ok: [db.test1.lan] => {"ansible_facts": {"discovered_interpreter_python": "/usr/bin/python3.11"}, "changed": false, "checksum": "81dc5834c94a75fd36d7fd78e0e93a8898b82b23", "dest": "/etc/haproxy/haproxy.cfg", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/haproxy/haproxy.cfg", "size": 2381, "state": "file", "uid": 0}
2025-03-02 17:17:14,661 p=809108 u=digitd n=ansible INFO| TASK [Restart haproxy service] *******************************************************************************************************************************************************************************************************************
2025-03-02 17:17:14,699 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:363
2025-03-02 17:17:15,759 p=809108 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:06:29 MSK", "ActiveEnterTimestampMonotonic": "531769768871", "ActiveExitTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ActiveExitTimestampMonotonic": "531769666348", "ActiveState": "active", "After": "network-online.target rsyslog.service system.slice systemd-journald.socket sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:06:28 MSK", "AssertTimestampMonotonic": "531769672959", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "50211815000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ConditionTimestampMonotonic": "531769672957", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "14125", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13606", "ExecMainStartTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ExecMainStartTimestampMonotonic": "531769680154", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:06:28 MSK] ; stop_time=[n/a] ; pid=13606 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Sat 2025-03-01 22:06:28 MSK] ; stop_time=[n/a] ; pid=13606 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 22:06:28 MSK", "InactiveEnterTimestampMonotonic": "531769667007", "InactiveExitTimestamp": "Sat 2025-03-01 22:06:28 MSK", "InactiveExitTimestampMonotonic": "531769680457", "InvocationID": "ff7ab3d427b6446ebca335c5c48399c5", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13606", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "43864064", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 22:06:29 MSK", "StateChangeTimestampMonotonic": "531769768871", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:17:15,898 p=809108 u=digitd n=ansible INFO| changed: [db.test.lan] => {"changed": true, "enabled": true, "name": "haproxy", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ActiveEnterTimestampMonotonic": "531776289193", "ActiveExitTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ActiveExitTimestampMonotonic": "531776193179", "ActiveState": "active", "After": "sysinit.target systemd-journald.socket network-online.target rsyslog.service basic.target system.slice", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 22:06:28 MSK", "AssertTimestampMonotonic": "531776196502", "Before": "shutdown.target multi-user.target", "BindReadOnlyPaths": "/dev/log:/var/lib/haproxy/dev/log:rbind", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "50409894000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ConditionTimestampMonotonic": "531776196500", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/haproxy.service", "ControlGroupId": "14585", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "HAProxy Load Balancer", "DevicePolicy": "auto", "Documentation": "\"man:haproxy(1)\" file:/usr/share/doc/haproxy/configuration.txt.gz", "DynamicUser": "no", "Environment": "CONFIG=/etc/haproxy/haproxy.cfg PIDFILE=/run/haproxy.pid \"EXTRAOPTS=-S /run/haproxy-master.sock\"", "EnvironmentFiles": "/etc/sysconfig/haproxy (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "26055", "ExecMainStartTimestamp": "Sat 2025-03-01 22:06:28 MSK", "ExecMainStartTimestampMonotonic": "531776204175", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -USR2 $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; ignore_errors=no ; start_time=[Sat 2025-03-01 22:06:28 MSK] ; stop_time=[n/a] ; pid=26055 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/haproxy ; argv[]=/usr/sbin/haproxy -Ws -f $CONFIG -p $PIDFILE $EXTRAOPTS ; flags= ; start_time=[Sat 2025-03-01 22:06:28 MSK] ; stop_time=[n/a] ; pid=26055 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/haproxy.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "haproxy.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 22:06:28 MSK", "InactiveEnterTimestampMonotonic": "531776193804", "InactiveExitTimestamp": "Sat 2025-03-01 22:06:28 MSK", "InactiveExitTimestampMonotonic": "531776204533", "InvocationID": "d2e4a3dcb72d44a4bd2110b552afff77", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "mixed", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "26055", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "48001024", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "haproxy.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "always", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 22:06:28 MSK", "StateChangeTimestampMonotonic": "531776289193", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SuccessExitStatus": "143", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:17:15,899 p=809108 u=digitd n=ansible INFO| PLAY [Run keepalived services for MASTER Haproxy] ************************************************************************************************************************************************************************************************
2025-03-02 17:17:16,084 p=809108 u=digitd n=ansible INFO| TASK [Copy conf on MASTER HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-02 17:17:16,116 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:374
2025-03-02 17:17:16,530 p=809108 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true}
2025-03-02 17:17:16,531 p=809108 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for Master] ***********************************************************************************************************************************************************************************************
2025-03-02 17:17:16,574 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:382
2025-03-02 17:17:17,469 p=809108 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "keepalived", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 21:20:01 MSK", "ActiveEnterTimestampMonotonic": "528982665374", "ActiveExitTimestamp": "Sat 2025-03-01 21:20:00 MSK", "ActiveExitTimestampMonotonic": "528981621423", "ActiveState": "active", "After": "systemd-journald.socket network-online.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 21:20:01 MSK", "AssertTimestampMonotonic": "528982637565", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "8493059000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 21:20:01 MSK", "ConditionTimestampMonotonic": "528982637547", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/keepalived.service", "ControlGroupId": "13694", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Keepalive Daemon (LVS and VRRP)", "DevicePolicy": "auto", "Documentation": "\"man:keepalived(8)\" \"man:keepalived.conf(5)\" \"man:genhash(1)\" https://keepalived.org", "DynamicUser": "no", "EnvironmentFiles": "/etc/default/keepalived (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13497", "ExecMainStartTimestamp": "Sat 2025-03-01 21:20:01 MSK", "ExecMainStartTimestampMonotonic": "528982644503", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 21:20:01 MSK] ; stop_time=[n/a] ; pid=13497 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 21:20:01 MSK] ; stop_time=[n/a] ; pid=13497 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/keepalived.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "keepalived.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 21:20:01 MSK", "InactiveEnterTimestampMonotonic": "528982636433", "InactiveExitTimestamp": "Sat 2025-03-01 21:20:01 MSK", "InactiveExitTimestampMonotonic": "528982648396", "InvocationID": "38d2c585e34f48feb2a1569148dc18ab", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13497", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "2064384", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "keepalived.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 21:20:01 MSK", "StateChangeTimestampMonotonic": "528982665374", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:17:17,470 p=809108 u=digitd n=ansible INFO| PLAY [Run keepalived services for BACKUP Haproxy] ************************************************************************************************************************************************************************************************
2025-03-02 17:17:17,509 p=809108 u=digitd n=ansible INFO| TASK [Copy conf on BACKUP HAProxy node] **********************************************************************************************************************************************************************************************************
2025-03-02 17:17:17,549 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:393
2025-03-02 17:17:18,456 p=809108 u=digitd n=ansible INFO| ok: [db.test1.lan] => {"changed": false, "checksum": "525508afcada704b949ed1aaa9e0840d11bd6a64", "dest": "/etc/keepalived/keepalived.conf", "gid": 0, "group": "root", "mode": "0644", "owner": "root", "path": "/etc/keepalived/keepalived.conf", "size": 264, "state": "file", "uid": 0}
2025-03-02 17:17:18,457 p=809108 u=digitd n=ansible INFO| TASK [Ensure or run keepalived service for BACKUP] ***********************************************************************************************************************************************************************************************
2025-03-02 17:17:18,744 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:401
2025-03-02 17:17:19,809 p=809108 u=digitd n=ansible INFO| changed: [db.test1.lan] => {"changed": true, "enabled": true, "name": "keepalived", "state": "started", "status": {"ActiveEnterTimestamp": "Sat 2025-03-01 21:20:01 MSK", "ActiveEnterTimestampMonotonic": "528982665374", "ActiveExitTimestamp": "Sat 2025-03-01 21:20:00 MSK", "ActiveExitTimestampMonotonic": "528981621423", "ActiveState": "active", "After": "systemd-journald.socket network-online.target system.slice sysinit.target basic.target", "AllowIsolate": "no", "AssertResult": "yes", "AssertTimestamp": "Sat 2025-03-01 21:20:01 MSK", "AssertTimestampMonotonic": "528982637565", "Before": "shutdown.target multi-user.target", "BlockIOAccounting": "no", "BlockIOWeight": "[not set]", "CPUAccounting": "yes", "CPUAffinityFromNUMA": "no", "CPUQuotaPerSecUSec": "infinity", "CPUQuotaPeriodUSec": "infinity", "CPUSchedulingPolicy": "0", "CPUSchedulingPriority": "0", "CPUSchedulingResetOnFork": "no", "CPUShares": "[not set]", "CPUUsageNSec": "8493250000", "CPUWeight": "[not set]", "CacheDirectoryMode": "0755", "CanFreeze": "yes", "CanIsolate": "no", "CanReload": "yes", "CanStart": "yes", "CanStop": "yes", "CapabilityBoundingSet": "cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore", "CleanResult": "success", "CollectMode": "inactive", "ConditionResult": "yes", "ConditionTimestamp": "Sat 2025-03-01 21:20:01 MSK", "ConditionTimestampMonotonic": "528982637547", "ConfigurationDirectoryMode": "0755", "Conflicts": "shutdown.target", "ControlGroup": "/system.slice/keepalived.service", "ControlGroupId": "13694", "ControlPID": "0", "CoredumpFilter": "0x33", "DefaultDependencies": "yes", "DefaultMemoryLow": "0", "DefaultMemoryMin": "0", "Delegate": "no", "Description": "Keepalive Daemon (LVS and VRRP)", "DevicePolicy": "auto", "Documentation": "\"man:keepalived(8)\" \"man:keepalived.conf(5)\" \"man:genhash(1)\" https://keepalived.org", "DynamicUser": "no", "EnvironmentFiles": "/etc/default/keepalived (ignore_errors=yes)", "ExecMainCode": "0", "ExecMainExitTimestampMonotonic": "0", "ExecMainPID": "13497", "ExecMainStartTimestamp": "Sat 2025-03-01 21:20:01 MSK", "ExecMainStartTimestampMonotonic": "528982644503", "ExecMainStatus": "0", "ExecReload": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecReloadEx": "{ path=/bin/kill ; argv[]=/bin/kill -HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }", "ExecStart": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; ignore_errors=no ; start_time=[Sat 2025-03-01 21:20:01 MSK] ; stop_time=[n/a] ; pid=13497 ; code=(null) ; status=0/0 }", "ExecStartEx": "{ path=/usr/sbin/keepalived ; argv[]=/usr/sbin/keepalived --dont-fork $DAEMON_ARGS ; flags= ; start_time=[Sat 2025-03-01 21:20:01 MSK] ; stop_time=[n/a] ; pid=13497 ; code=(null) ; status=0/0 }", "ExitType": "main", "FailureAction": "none", "FileDescriptorStoreMax": "0", "FinalKillSignal": "9", "FragmentPath": "/lib/systemd/system/keepalived.service", "FreezerState": "running", "GID": "[not set]", "GuessMainPID": "yes", "IOAccounting": "no", "IOReadBytes": "18446744073709551615", "IOReadOperations": "18446744073709551615", "IOSchedulingClass": "2", "IOSchedulingPriority": "4", "IOWeight": "[not set]", "IOWriteBytes": "18446744073709551615", "IOWriteOperations": "18446744073709551615", "IPAccounting": "no", "IPEgressBytes": "[no data]", "IPEgressPackets": "[no data]", "IPIngressBytes": "[no data]", "IPIngressPackets": "[no data]", "Id": "keepalived.service", "IgnoreOnIsolate": "no", "IgnoreSIGPIPE": "yes", "InactiveEnterTimestamp": "Sat 2025-03-01 21:20:01 MSK", "InactiveEnterTimestampMonotonic": "528982636433", "InactiveExitTimestamp": "Sat 2025-03-01 21:20:01 MSK", "InactiveExitTimestampMonotonic": "528982648396", "InvocationID": "38d2c585e34f48feb2a1569148dc18ab", "JobRunningTimeoutUSec": "infinity", "JobTimeoutAction": "none", "JobTimeoutUSec": "infinity", "KeyringMode": "private", "KillMode": "control-group", "KillSignal": "15", "LimitAS": "infinity", "LimitASSoft": "infinity", "LimitCORE": "infinity", "LimitCORESoft": "0", "LimitCPU": "infinity", "LimitCPUSoft": "infinity", "LimitDATA": "infinity", "LimitDATASoft": "infinity", "LimitFSIZE": "infinity", "LimitFSIZESoft": "infinity", "LimitLOCKS": "infinity", "LimitLOCKSSoft": "infinity", "LimitMEMLOCK": "8388608", "LimitMEMLOCKSoft": "8388608", "LimitMSGQUEUE": "819200", "LimitMSGQUEUESoft": "819200", "LimitNICE": "0", "LimitNICESoft": "0", "LimitNOFILE": "524288", "LimitNOFILESoft": "1024", "LimitNPROC": "3661", "LimitNPROCSoft": "3661", "LimitRSS": "infinity", "LimitRSSSoft": "infinity", "LimitRTPRIO": "0", "LimitRTPRIOSoft": "0", "LimitRTTIME": "infinity", "LimitRTTIMESoft": "infinity", "LimitSIGPENDING": "3661", "LimitSIGPENDINGSoft": "3661", "LimitSTACK": "infinity", "LimitSTACKSoft": "8388608", "LoadState": "loaded", "LockPersonality": "no", "LogLevelMax": "-1", "LogRateLimitBurst": "0", "LogRateLimitIntervalUSec": "0", "LogsDirectoryMode": "0755", "MainPID": "13497", "ManagedOOMMemoryPressure": "auto", "ManagedOOMMemoryPressureLimit": "0", "ManagedOOMPreference": "none", "ManagedOOMSwap": "auto", "MemoryAccounting": "yes", "MemoryAvailable": "infinity", "MemoryCurrent": "2064384", "MemoryDenyWriteExecute": "no", "MemoryHigh": "infinity", "MemoryLimit": "infinity", "MemoryLow": "0", "MemoryMax": "infinity", "MemoryMin": "0", "MemorySwapMax": "infinity", "MountAPIVFS": "no", "NFileDescriptorStore": "0", "NRestarts": "0", "NUMAPolicy": "n/a", "Names": "keepalived.service", "NeedDaemonReload": "no", "Nice": "0", "NoNewPrivileges": "no", "NonBlocking": "no", "NotifyAccess": "main", "OOMPolicy": "stop", "OOMScoreAdjust": "0", "OnFailureJobMode": "replace", "OnSuccessJobMode": "fail", "Perpetual": "no", "PrivateDevices": "no", "PrivateIPC": "no", "PrivateMounts": "no", "PrivateNetwork": "no", "PrivateTmp": "no", "PrivateUsers": "no", "ProcSubset": "all", "ProtectClock": "no", "ProtectControlGroups": "no", "ProtectHome": "no", "ProtectHostname": "no", "ProtectKernelLogs": "no", "ProtectKernelModules": "no", "ProtectKernelTunables": "no", "ProtectProc": "default", "ProtectSystem": "no", "RefuseManualStart": "no", "RefuseManualStop": "no", "ReloadResult": "success", "RemainAfterExit": "no", "RemoveIPC": "no", "Requires": "sysinit.target system.slice", "Restart": "no", "RestartKillSignal": "15", "RestartUSec": "100ms", "RestrictNamespaces": "no", "RestrictRealtime": "no", "RestrictSUIDSGID": "no", "Result": "success", "RootDirectoryStartOnly": "no", "RuntimeDirectoryMode": "0755", "RuntimeDirectoryPreserve": "no", "RuntimeMaxUSec": "infinity", "RuntimeRandomizedExtraUSec": "0", "SameProcessGroup": "no", "SecureBits": "0", "SendSIGHUP": "no", "SendSIGKILL": "yes", "Slice": "system.slice", "StandardError": "inherit", "StandardInput": "null", "StandardOutput": "journal", "StartLimitAction": "none", "StartLimitBurst": "5", "StartLimitIntervalUSec": "10s", "StartupBlockIOWeight": "[not set]", "StartupCPUShares": "[not set]", "StartupCPUWeight": "[not set]", "StartupIOWeight": "[not set]", "StateChangeTimestamp": "Sat 2025-03-01 21:20:01 MSK", "StateChangeTimestampMonotonic": "528982665374", "StateDirectoryMode": "0755", "StatusErrno": "0", "StopWhenUnneeded": "no", "SubState": "running", "SuccessAction": "none", "SyslogFacility": "3", "SyslogLevel": "6", "SyslogLevelPrefix": "yes", "SyslogPriority": "30", "SystemCallErrorNumber": "2147483646", "TTYReset": "no", "TTYVHangup": "no", "TTYVTDisallocate": "no", "TasksAccounting": "yes", "TasksCurrent": "2", "TasksMax": "1098", "TimeoutAbortUSec": "1min 30s", "TimeoutCleanUSec": "infinity", "TimeoutStartFailureMode": "terminate", "TimeoutStartUSec": "1min 30s", "TimeoutStopFailureMode": "terminate", "TimeoutStopUSec": "1min 30s", "TimerSlackNSec": "50000", "Transient": "no", "Type": "notify", "UID": "[not set]", "UMask": "0022", "UnitFilePreset": "enabled", "UnitFileState": "enabled", "UtmpMode": "init", "WantedBy": "multi-user.target", "Wants": "network-online.target", "WatchdogSignal": "6", "WatchdogTimestampMonotonic": "0", "WatchdogUSec": "0"}}
2025-03-02 17:17:19,810 p=809108 u=digitd n=ansible INFO| PLAY [Create user \cluster\ and new database \testdb\] *******************************************************************************************************************************************************************************************
2025-03-02 17:17:19,892 p=809108 u=digitd n=ansible INFO| TASK [User creation] *****************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:19,932 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:412
2025-03-02 17:17:21,581 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["sudo", "-u", "postgres", "createuser", "cluster", "--createdb", "--createrole", "--superuser", "--port=5050"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:17:21,582 p=809108 u=digitd n=ansible INFO| TASK [Debug] *************************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:22,982 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:417
2025-03-02 17:17:24,532 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-02 17:17:27,933 p=809108 u=digitd n=ansible INFO| TASK [Change password] ***************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:28,073 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:421
2025-03-02 17:17:28,616 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["sudo", "-u", "postgres", "psql", "--port=5050", "--username=postgres", "-c", "alter user cluster with password '12345678';"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:17:28,618 p=809108 u=digitd n=ansible INFO| TASK [Debug] *************************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:28,657 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:426
2025-03-02 17:17:28,699 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-02 17:17:28,782 p=809108 u=digitd n=ansible INFO| TASK [Create database] ***************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:28,823 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:430
2025-03-02 17:17:29,240 p=809108 u=digitd n=ansible INFO| skipping: [db.master.lan] => {"changed": false, "cmd": ["sudo", "-u", "postgres", "createdb", "testdb", "--port=5050"], "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}
2025-03-02 17:17:29,241 p=809108 u=digitd n=ansible INFO| TASK [Debug] *************************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:29,331 p=809108 u=digitd n=ansible INFO| task path: /run/media/digitd/NFS/git/travelata_test/ansible/cluster_main/start_services.yml:435
2025-03-02 17:17:29,383 p=809108 u=digitd n=ansible INFO| ok: [db.master.lan] => {
    "msg": []
}
2025-03-02 17:17:29,415 p=809108 u=digitd n=ansible INFO| PLAY RECAP ***************************************************************************************************************************************************************************************************************************************
2025-03-02 17:17:29,448 p=809108 u=digitd n=ansible INFO| db.etcd.lan                : ok=7    changed=3    unreachable=0    failed=0    skipped=4    rescued=0    ignored=0   
2025-03-02 17:17:29,531 p=809108 u=digitd n=ansible INFO| db.master.lan              : ok=24   changed=6    unreachable=0    failed=0    skipped=8    rescued=0    ignored=0   
2025-03-02 17:17:29,565 p=809108 u=digitd n=ansible INFO| db.slave.lan               : ok=18   changed=6    unreachable=0    failed=0    skipped=5    rescued=0    ignored=0   
2025-03-02 17:17:29,606 p=809108 u=digitd n=ansible INFO| db.test.lan                : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-03-02 17:17:29,648 p=809108 u=digitd n=ansible INFO| db.test1.lan               : ok=6    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
